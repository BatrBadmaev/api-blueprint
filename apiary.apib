FORMAT: 1A
HOST: http://api.yclients.com/api/v1

[email]:  support@yclients.com
[api_host]: http://api.yclients.com/api/v1

# YCLIENTS API v2.0

Это официальный документ, описывающий взаимодействие с сервисом онлайн-бронирования YCLIENTS.

При проектировании методов, мы старались придерживаться архитектуры [REST](https://ru.wikipedia.org/wiki/REST)

Все обращения к протоколу осуществляются с использованием SSL-шифрования.

**Лимиты**
200 запросов в минуту, или 5 запросов в секунду на один IP-адрес.

**URL API:**
https://api.yclients.com

_Вопросы, пожелания, сообщения об ошибках можно направлять по адресу support@yclients.com_

API позволяет сторонним разработчикам выполнять
большинство операций с платформой YCLIENTS.

**Внимание! Большинство обращений в техническую поддержку связаны
с тем, что разработчики не читают документацию.
Обязательно прочтите раздел INTRODUCTION полностью и внимательно ознакомьтесь с информацией
на других ресурсах, на которые мы ссылаемся. Для тестирования запросов мы рекомендуем использовать сервис [Postman](https://www.getpostman.com/),
при обращении в службу поддержки используйте скриншоты из Postman.**

[![Run in Postman](https://run.pstmn.io/button.svg)](https://app.getpostman.com/run-collection/ece1299c18ac7d3eea09)



## SDK

Ниже приведены ссылки на SDK сторонних разработчиков. В ближайшее время мы планируем подключится к их улучшению и развитию. И всегда привествуюм Opensource инициативы, если у вас есть возможности и желание развивать одну из предложенных библиотек это принесет общую пользу. Если решите создать свою - сообщите нам о ней, мы примем участие в развитии и разместим ссылку на нее здесь.

**PHP:**
https://github.com/SlowProg/yclients-api

**PHP LARAVEL:**
https://github.com/robotNIXX/yclients-laravel

## Кейсы интеграции с YCLIENTS

1. Обмен данными с программи для автоматизации и учета.
2. Интеграция онлайн-записи в стронние сайты и мобильные приложения (каталоги компаний, приложения компаний и т.п.)

## Общее описание обмена данными с YCLIENTS

API для интеграции с YCLEINTS содержит две группы методов:
1. _Методы требующие авторизацию пользователя и авторизацию партнера_
2. _Методы не требующие авторизации пользователя, но требующие авторизацию партнера_

### Авторизация запросов API

Для обращений и к первой и ко второй группе методов
требуется *авторизация партнера*. Т.е. передача
уникального hash-ключа партнера.

Авторизация запросов к API производится в соответствии с [RFC 6749 "Resource Owner Password Credentials Grant"](http://tools.ietf.org/html/rfc6749#section-4.3).
При запросах к API в HTTP заголовок Authorization должен быть включен ключ доступа в следущем формате:

```
Authorization: Bearer <partner token>
```

Для того, чтобы
получить этот ключ, свяжитесь с нами по адресу
support@yclients.com и опишите, для каких целей вы планируете использовать API.

Для получения API-ключа пользователя используйте метод **auth**. Передавать сам ключ нужно также в заголовке запроса (после ключа партнера через запятую):

```
Authorization: Bearer <partner token>, User <user token>
```

Нужна ли авторизация пользователя для работы с теми или иными сущностями нужно смотреть в описаниях формата данных и примерах запросов.

### Дата и время
Все даты в API представлены в виде строк в формате ISO 8601:

```
"2014-09-21T23:00:00.000+03:00"
```

Длительности услуг и других сущностей передаются в **секундах**. Например, если услуга длиться 15 минут, то формат данных следующий:

```
{ "length": 900 }
```

## Концепты YCLIENTS API

API позволяет работать с основными сущностями платформы:

* **Компания**
* **Пользователь**
    Пользователи могут управлять компаниями,
    они имеют права доступа к определенным настройкам компании.
    Не все пользователи имеют доступ ко всем настройкам.
    Для того, чтобы изменять те или иные настройки нужно сначала
    получить API-ключ пользователя с соответсвующими правами.
* **Категория услуг**
    Все услуги компании группируются в рамках категории услуг .
* **Услуга**
    Как правило, запись производится на определенную услугу,
    которую оказывает определенный сотрудник в определенной компании.
    Услуга имеет диапазон стоимости и некоторые другие параметры.
* **Сотрудник**
    Как правило, запись производится, к определенному сотруднику
    или _ресурсу_ (например, подъемник или квест-комната).
* **Расписание сотрудника**
    У каждого сотрудника есть график работы - итервалы времени, в которое
    сотрудник работает с клиентами.
* **Свободное время сотрудника**
    Время на которое можно записаться
    к сотруднику, т.е. интервалы времени, в которые он свободен.
* **Запись**
    Интервал времени, в которое конкретный сотрудник оказывает
    конкретному клиенту услуги. Во время записи сотрудник занят.
* **Клиент**
    Человек, который записывался на услугу в компанию.

### Модель данных YCLIENTS API

Для работы с данными используется четыре основных структуры:

1. **Сущность**
    Одна из перечисленных выше сущностей,
    обладающая своими уникальными свойствами и параметрами.
    Сущности можно получать, изменять и удалять

2. **Коллекция сущностей**
    Набор сущностей. Например, список компаний
    или список услуг, оказываемых компаний.
    В коллекции сущностей можно *добавлять*
    сущности.

3. **Связь сущностей**
    Например, связь сотрудника и услуги
    определяет, что конкретный сотрудник
    оказывает конкретную услугу.
    У связи могут быть свои свойства,
    например, индивидуальная цена услуги
    для конкретного сотрудника

4. **Коллекция связей сущностей**
    Например, список услуг, оказываемых
    сотрудником и их свойсва. В коллекции
    можно *добавлять связи*

# Group Авторизация
Для вызова многих методов требуется получить API-ключ пользователя, который будет использоваться для доступа к закрытым данным.

## Авторизовать пользователя [/auth]
При смене пароля польователем его API-ключ изменится и потребуется новая авторизация

| Атрибут  | Тип | Описание |
| ------------- | ------------- | ------------- |
| login  | string  | В качестве логина может быть использован номер телефона пользователя в формате 79161234567 или его Email |
| password  | string  | Пароль пользователя |


### Авторизовать пользователя [POST]

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

    + Attributes
        + login: `testuser@yclients.com` (required, string) - Номер телефона или Email
        + password: `testpass` (required, string) - Пароль

+ Response 201 (application/json)

    + Attributes (object)
        + user_token: `wec23fh8cDfFV4432fc352456` (string) - User Access Token


# Data Structures

## Seance (object)

+ time: '17:00' (required, string) - Время сеанса
+ length: 9600 (required, number) - Длительность сеанса
+ datetime: '2015-10-01T17:00:00Z' (required, string) - Дата и время сеанса

## Seances (array[Seance])

## Appointment

+ id:1 (required, number) - ID записи по которому будет возвращаться ее хеш в ответет
+ services: [320, 230] (required, array[number]) - Список ID услуг для записи
+ staff_id: 20201 (required, number) - ID сотрудника
+ datetime: '2015-10-01T17:00:00Z' (required, string) - Дата и время сеанса
+ custom_fields (optional, object) - Дополнительные поля записи

## Staff

+ id:1 (required, number) - ID сотрудника
+ name: 'Витя' (required, string) - Имя сотрудника
+ specialization: 'Крематолог' (required, string) - Специализация сотрудника
+ show_rating: true (required, boolean) - Показывать ли рейтинг сотрудника
+ rating: 5 (required, number) - Рейтинг сотрудника (от 0 до 5)
+ votes_count: 24 (required, number) - Кол-во голосов, поставивших сотруднику оценку
+ comments_count: 24 (required, number) - Кол-во комментариев сотруднику
+ avatar: 'https://yclients.com/uploads/logo.png' (required, string) - Путь к аватарке сотрудника

## ServiceStaff

+ id:1 (required, number) - ID сотрудника
+ seance_length: 1800 (required, number) - Длительность оказания услуги (кратно 15 минутам)

## Company

+ id:1 (required, number) - ID копаниии
+ title: 'ООО Кранты' (required, string) - Название организации
+ country: 'Росссия' (required, string) - Название страны, в которой расположена организация
+ country_id: 5 (required, number) - ID страны
+ city: 'Москва' (required, string) - Название города, в котором расположена организация
+ city_id: 5 (required, number) - ID города
+ phone: '74958008080' (required, string) - Телефон компании
+ timezone: 'Europe/Moscow' (required, string) - Временная зона компании
+ address: 'Ялтинская 3, 190' (required, string) - Адрес компании
+ coordinate_lat: 35.5665 (required, number) - Широта
+ coordinate_lng: 35.5665 (required, number) - Долгота

## Client

+ phone: '79169999999' (optional, string) - телефон клиента
+ name: 'Петр' (optional, string) - Имя клиента
+ email: 'petr@thefirst.com' (optional, string) - email клиента

## ServiceArray

+ id: 141 (optional, number) - id услуги
+ first_cost: 1000 (optional, number) - Начальная стоимость услуги
+ discount: 10 (optional, number) - Скидка на услугу
+ cost: 10 (optional, number) - Итоговая стоимость услуги

## GoodsTransactionsArray

+ id (required, number) - id складской транзакции
+ good_id (required, number) - ID товара
+ storage_id (required, number) - ID склада
+ amount (required, number) - сумма
+ type (required, number) - 1 - Продажа товара, 2 - Списание расходников, 3 - Приход товара, 4 - Списание товара
+ master_id (required, number) - ID сотрудника
+ discount (required, number) - Скидка
+ price (required, number) - Стоимость
+ cost (required, number) - Цена продажи

## newTransactionsArray

+ id (required, number) - id финансовой транзакции
+ amount (required, number) - сумма
+ account_id (required, number) - ID кассы

## ImageGroup

+ id: 141 (required, number) - id группы изображений
+ entity: "master" (optional, string) - Название сущности, к которой привязана группа
+ entity_id: 10 (optional, number) - Id сущности
+ images (required, Image) - Список изображений

## Image

+ id: 141 (required, number) - id изображения
+ path: 'http://yclients.com/uploads/masters/norm/4/41/41574b90f81d8d7_20170327194249.jpeg' (required, string) - Путь к изображению
+ width: 10 (required, number) - Ширина изображения
+ height: 20 (required, number) - Высота изображения
+ type: 'jpeg' (required, string) - Тип изображения
+ image_group_id: 20 (required, number) - Id группы изображений
+ version: 'basic' (required, string) - Версия изображения

## UsersGroupsAccess

+ settings_access: 1 (required, number) - доступ к редактированию сети
+ users_access: 0 (required, number) - доступ к редактированию пользователей
+ clients_access: 1 (required, number) - доступ к просмотру клиентской базы
+ loyalty_access: 1 (required, number) - доступ к лояльности
+ loyalty_cards_manual_transactions_access: 1 (required, number) - ручное пополнение/списание с карт лояльности
+ network_services_access: 0 (required, number) - доступ к управлению сетевыми услугами

## LicenseOption

+ id: 2 (required, number) - id опции
+ title: "KKM" (required, string) - Название опции

## Document

+ id: 2 (required, number) - id опции
+ type_id: 7 (required, number) - id типа документа
+ type_title: "Визит" (required, string) - название типа документа
+ storage_id: 4 (required, number) - id склада
+ user_id: 2452 (required, number) - id пользователя
+ company_id: 4545 (required, number) - id компании
+ number: 543 (required, number) - номер документа в компании
+ comment: "" (required, string) - комментарий
+ date_created: "2018-07-03 11:00:00" (required, string) - дата создания
+ category_id: 1 (required, number) - id категории
+ visit_id: 234234 (required, number) - id визита
+ record_id: 5445 (required, number) - id записи

# Group Онлайн-запись

Для реализации клиентской части онлайн-записи используется следующий набор методов. Они адаптированы для пользовательских сценариев онлайн-записи, в отличии от других REST-методов, которые лучше использовать для интеграциионных целей.

## Настройки формы бронирования/записи [/bookform/{id}]

Каждый клиент сервиса YCLIENTS, может создать неограниченное количество форм онлайн-записи с разным дизайном и для разных сценариев записи.

Обычно, id формы бровнирования хранится в поддомене, например: https://w123.yclients.com, где 123 - id формы записи. С помощью этого парметра можно получить все остальные необходимые для реализации онлайн-записи параметры, понять, будет происходить запись в конкретную компанию или в сеть компаний.

Для сетевого виджета необходимо будет дополнительно обратится к методу [GET] /companies с фильтром company_id и получить список копаний, в которые будет производится запись.


Объект содержащий настройки формы бронирование имеет следующие поля:

| Поле | Тип | Описание |
| ------------- | ------------- | ------------- |
| steps  | Массив объектов  | Шаги формы бронирования со своими настройками  |
| style  | Object  | Настройки дизайна формы бронирования  |
| group_id  | number  | Идентификатор сети компаний (0 - если форма записи для несетевой компании)  |
| company_id  | number  | Идентификатор компании (возвращается всегда, используется для получения дополнительных настроек) |
| phone_confirmation  | boolean  | Нужно ли подтверждать телефон по смс (если groupid = 0 (не групповая форма), иначе смотреть в настройки каждой компании отдельно)
| lang  | string  | Язык формы бронирования (код из массива langs)  |
| langs  | array of object  | Список языков виджета
| comment_required  | boolean | Является ли поле с комментарием к записи обязательным для заполнения
| metrika_counter_id  | string  | Идентификатор Яндекс.Метрики
| google_analytics_id  | string  | Идентификатор Google Analytics
| facebook_pixel_id  | string  | Идентификатор Facebook Pixel
| vkontakte_pixel_id  | string  | Идентификатор Вконтакте пиксель
| app_metrika_id  | string  | Идентификатор Yandex AppMetrika
| sms_enabled  | boolean  | Доступна ли отправка смс
| comment_input_name  | string (optional)  | Заголовок для поля с вводом комментария к записи (если не залдано то используется по умолчанию значение)
| booking_notify_text  | string (optional)  | Текст уведомления, которое выводится (если задано) на шаге ввода контактных данных


Массив steps состоит из объектов которые имеют следующие поля:

| Поле  | Тип | Описание |  Для каких шагов указан |
| ------------- | ------------- | ------------- | ------------- |
| step  | string | Шаг city/company/service/master/datetime/contact/confirm |  Для всех  |
| title  | string  | Название шага для вывода в интерфейсе |  Для всех  |
| num  | number  | Каким по счету должен выводиться данный шаг (начиная с 1) |  Для всех  |
| default  | string или number  | Значение по умолчанию для данного шага, если задано | Для всех, кроме datetime |
| hidden  | boolean  | Скрыть данный шаг при бронировании или нет |  Для всех |
| date_hidden  | boolean  | Скрыть данный шаг при бронировании или нет |  Для datetime |
| time_hidden  | boolean  | Скрыть данный шаг при бронировании или нет |  Для datetime |
| date_default  | string  | Значение по умолчанию для данного шага, если задано |  Для datetime |
| time_default  | number  | Значение по умолчанию для данного шага, если задано |  Для datetime |

Объект style имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
| show_header  | boolean | Выводить шапку и меню или нет |
| logo  | string  | Путь до картинки логотипа  |
| header_background  | string  | Путь до картинки фона подзаголовка |
| menu_background  | string  | Путь до картинки фона меню  |
| primaryPalette  | string  | Главный цвет формы (все цвета из списка: red, pink, purple, deep-purple, indigo, blue, light-blue, cyan, teal, green, light-green, lime, yellow, amber, orange, deep-orange, brown, grey, blue-grey, white, black) |
| accentPalette  | string  | Второстепенный цвет формы (полупрозрачный cover подзаголовка) |
| warnPalette  | string  | Цвет кнопок формы записи |
| backgroundPalette  | string  | Цвет фона формы записи |

+ Parameters
    + id: `1` (required, number) - id формы бронирования

### Получить настройки формы бронирования [GET]

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token


+ Response 200 (application/json)

        {
            "steps": [
                {
                    "step": "master",
                    "title": "Выберите спеца",
                    "num": 2,
                    "hidden": "0",
                    "default": "-1"
                },
                {
                    "step": "service",
                    "title": "Выберите услугу",
                    "num": 1,
                    "hidden": "1",
                    "default": "196"
                },
                {
                    "step": "datetime",
                    "title": "Выберите дату и время сеанса",
                    "num": 3,
                    "hidden": false,
                    "date_hidden": "0",
                    "time_hidden": "0",
                    "date_default": "2015-07-23",
                    "time_default": "27900"
                },
                {
                    "step": "contact",
                    "title": "",
                    "num": 3,
                    "hidden": false,
                    "default": 0
                },
                {
                    "step": "comfirm",
                    "title": "",
                    "num": 4,
                    "hidden": false,
                    "default": 0
                }
            ],
            "style": {
                "show_header": true,
                "logo": "https://yclients.com/uploads/logo.png",
                "header_background": "https://yclients.com/uploads/header.png",
                "menu_background": "https://yclients.com/uploads/menu.png",
                "main_color": "666",
                "secondary_color": "999",
                "buttons_color": "FFF",
            },
            "group_id": 1,
            "company_id": 1,
            "phone_confirmation": false,
            "lang": "ru-RU",
            "langs": [
                {
                    "id": 1,
                    "code": "ru-RU",
                    "title": "Русский"
                },
                {
                    "id": 2,
                    "code": "en-US",
                    "title": "English"
                },
                {
                    "id": 4,
                    "code": "lv-LV",
                    "title": "Latviešu valoda"
                },
                {
                    "id": 5,
                    "code": "et-EE",
                    "title": "Eesti keel"
                },
                {
                    "id": 6,
                    "code": "lt-LT",
                    "title": "Летува́"
                },
                {
                    "id": 7,
                    "code": "uk-UK",
                    "title": "Українська"
                },
                {
                    "id": 8,
                    "code": "fr-FR",
                    "title": "Français"
                },
                {
                    "id": 9,
                    "code": "it-IT",
                    "title": "Italiano"
                },
                {
                    "id": 10,
                    "code": "es-ES",
                    "title": "Español"
                },
                {
                    "id": 13,
                    "code": "ka-KA",
                    "title": "ქართული"
                },
                {
                    "id": 14,
                    "code": "hy-AM",
                    "title": "Հայերեն"
                },
                {
                    "id": 15,
                    "code": "kk-KK",
                    "title": "қазақ тілі"
                },
                {
                    "id": 16,
                    "code": "hr-HR",
                    "title": "Hrvatski jezik"
                },
                {
                    "id": 17,
                    "code": "cs-CS",
                    "title": "český jazyk"
                },
                {
                    "id": 18,
                    "code": "ro-RO",
                    "title": "Limba Română"
                },
                {
                    "id": 19,
                    "code": "cn-CN",
                    "title": "中文"
                },
                {
                    "id": 20,
                    "code": "ar-AR",
                    "title": "العَرَبِيَّة"
                },
                {
                    "id": 21,
                    "code": "bg-BG",
                    "title": "Български"
                },
                {
                    "id": 22,
                    "code": "he-IL",
                    "title": "עברית"
                },
                {
                    "id": 23,
                    "code": "hu-HU",
                    "title": "Magyar nyelv"
                },
                {
                    "id": 24,
                    "code": "Lt-sr-SP",
                    "title": "Srpski jezik"
                },
                {
                    "id": 25,
                    "code": "sk-SK",
                    "title": "Slovenský jazyk"
                },
                {
                    "id": 26,
                    "code": "mn-MN",
                    "title": "Монгол хэл"
                },
                {
                    "id": 27,
                    "code": "az-AZ",
                    "title": "Azərbaycan dili"
                },
                {
                    "id": 28,
                    "code": "pl-PL",
                    "title": "Polszczyzna"
                },
                {
                    "id": 30,
                    "code": "sl-SL",
                    "title": "Slòvēnskī"
                }
            ],
            "comment_required": false,
            "metrika_counter_id": "50217133",
            "google_analytics_id": "UA-125358345-1",
            "facebook_pixel_id": "2218788388343154",
            "vkontakte_pixel_id": "VK-RTRG-96471-KZ24cpR",
            "app_metrika_id": "46ab3b93-1bc6-457d-82f0-c1b51f39b01e",
            "sms_enabled": true
        }


## Интернационализация формы бронирования [/i18n/{langCode}]

Перевод доступен на один из языков:
- Русский - 'ru-RU'
- Латвийский - 'lv-LV'
- Английский - 'en-US'
- Эстонский - 'ee-EE'
- Литовский - 'lt-LT'
- Немецкий - 'de-DE'
- Украинский - 'uk-UK'

+ Parameters
    + langCode: `ru-RU` (required, string) - Код языка. Один из набора 'ru-RU', 'lv-LV', 'en-US', 'ee-EE', 'lt-LT', 'de-DE', 'uk-UK'


### Получить параметры интернационализации [GET]

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)



## Коллекция услуг доступных для бронирования [/book_services/{company_id}{?staff_id,datetime,service_ids}]

Объект услуг, доступных для бронирования имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  categories  | массив объектов  | Массив категорий услуг (забронировать категорию нельзя)  |
|  services  | массив объектов  | Услуги, доступные для бронирования, с указанием категории  |

Объект из массива categories, имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор категории  |
|  title  | string  |  Название категории  |
|  sex  | number  |  Принадлежность категории к полу (1 - мужской, 2 - женский, 0 - не задано)  |
|  weight  | number  |  Вес категории. При выводе категории сортируются по весу, сначала более тяжелые  |
|  api_id  | string  |  Внешний идентификатор категории  |

Объект из массива services, имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор услуги  |
|  title  | string  |  Название услуги  |
|  category_id  | number  |  Идентификатор категории, которой принадлежит услуга  |
|  weight  | number  |  Вес категории. При выводе услуги сортируются по весу, сначала более тяжелые  |
|  price_min  | number  |  Минимальная стоимость услуги  |
|  price_max  | number  |  Максимальная стоимость услуги  |
|  discount  | number  |  Скидка по услуге  |
|  comment  | string  |  Комментарий к услуге  |
|  active  | number  |  Активная ли услуга  |
|  length  | number  |  Длительность оказания услуги(только если задан фильтр по сотруднику)  |
|  image  | string  |  Изображение услуги |

+ Parameters
    + company_id: `4564` (required, number) - ID компании

### Получить список услуг доступных для бронирования [GET]

Если необходимо получить услуги, которые оказывает конкретный специалист, то нужно воспользоваться фильтром по специалисту

Доступны следующие фильтры:

    + staff_id: ID сотрудника. Если нужны услуги, которые оказывает только выбранный сотрудник
    + datetime: дата (в формате iso8601). Если нужны услуги, которые можно забронировать у мастера на определенное время
    + service_ids: Массив ID услуг. Если уже выбран мастер, время и услуга(и) в рамках этой записи, и необходимо выбрать еще услугу.

+ Parameters

    + company_id (required, number) - ID компании
    + staff_id: `0` (optional, number) - ID сотрудника. Фильтр по идентификатору сотрудника
        Default: 0
    + datetime: `` (optional, string) - дата (в формате iso8601). Фильтр по дате бронирования услуги (например '2005-09-09T18:30')
        Default: ''
    + service_ids (optional, array of number) - ID услуг.
        Фильтр по списку идентификаторов уже выбранных (в рамках одной записи) услуг. Имеет смысл если задан фильтр по мастеру и дате.

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)

        {
            "services": [
                {
                    "id":"21487",
                    "title":"Стрижка кота",
                    "category_id":89207,
                    "price_min":"0.00",
                    "price_max":"0.00",
                    "discount":"0",
                    "comment":"",
                    "weight":"23",
                    "active":1,
                    "image":"http:\/\/yclients.com\/images\/test_img2.png",
                    }
            ],
            "categories": [
                {
                    "id":"89207",
                    "title":"Стрижки",
                    "sex":0,
                    "api_id":"",
                    "weight":1
                }
            ]
        }

## Коллекция сотрудников доступных для бронирования [/book_staff/{company_id}{?service_ids,datetime,without_seances}]

Каждый объект из массива сотрудников, доступных для бронирования имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор сотрудника  |
|  name  | string  |  Имя сотрудника  |
|  specialization  | string  |  Специализация сотрудника  |
|  bookable  | boolean  |  Есть ли у сотрудника сеансы, доступные для бронирования  |
|  weight  | number  |  Вес сотрудника. При выводе сотрудники сортируются по весу, сначала более тяжелые  |
|  show_rating  | number  |  Показывать ли рейтинг сотрудника (1 - показывать, 0 - не показывать)  |
|  rating  | number  |  Ретинг сотрудника  |
|  votes_count  | number  |  Кол-во голос, оценивших сотрудника  |
|  comments_count  | number  |  Кол-во комментариев к сотрунику  |
|  avatar  | string  |  Путь к файлу аватарки сотрудника  |
|  information  | string  |  Дополнительная информация о сотруднике (HTML формат)  |
|  seance_date  | string  |  Дата ближайшего дня, на который есть доступные сеансы (только для bookable = true) |
|  seances  | array of book_times  |  ближайшие доступные сеансы на дату seance_date (только для bookable = true)  |

+ Parameters
    + company_id: `4564` (required, number) - ID компании

### Получить список сотрудников доступных для бронирования [GET]

Доступны следующие фильтры:

    + service_ids: Массив ID услуг. Если нужны сотрудники, которые оказывают только выбранную услугу
    + datetime: дата (в формате iso8601). Если нужны сотрудники, у которых есть сеансы на указанную услугу в указанное время
    + without_seances (optional, bool) - Отключает выдачу ближайших свободных сеансов, ускоряет получение данных.

+ Parameters

    + company_id (required, number) - ID компании
    + service_ids (optional, array of number) - ID услуг.
        Фильтр по списку идентификаторов услуг
    + datetime (optional, string) - дата в формате iso8601.
        Фильтр по дате бронирования услуги (например '2005-09-09T18:30')
    + without_seances (optional, bool) - Отключает выдачу ближайших свободных сеансов,
    ускоряет получение данных.


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)

        [
            {
                "id":"16",
                "name":"Вася",
                "bookable": true,
                "specialization":"Старта-пожарный",
                "show_rating":"1",
                "rating":"3",
                "votes_count":"1",
                "avatar":"http:\/\/salonpicker.ru\/images\/no-master.png",
                "comments_count":"0",
                "weight":"11",
                "information":"<span><\/span>",
                "seance_date": "2015-09-25",
                "seances": [
                  {
                    "time": "12:00",
                    "seance_length": 3600,
                    "datetime": "2015-09-29T12:00:00+04:00"
                  },
                  {
                    "time": "13:00",
                    "seance_length": 3600,
                    "datetime": "2015-09-29T13:00:00+04:00"
                  },
                  {
                    "time": "14:00",
                    "seance_length": 3600,
                    "datetime": "2015-09-29T14:00:00+04:00"
                  },
                  {
                    "time": "15:00",
                    "seance_length": 3600,
                    "datetime": "2015-09-29T15:00:00+04:00"
                  },
                  {
                    "time": "16:00",
                    "seance_length": 3600,
                    "datetime": "2015-09-29T16:00:00+04:00"
                  }
                ]
            },
            {
                "id":"32",
                "name":"Петя",
                "bookable": false,
                "specialization":"Стартап-проктолог",
                "show_rating":"1",
                "rating":"4",
                "votes_count":"1",
                "avatar":"http:\/\/salonpicker.ru\/images\/no-master.png",
                "comments_count":"0",
                "weight":"8",
                "information":"<span><\/span>"
            }
        ]

## Даты доступные для бронирования [/book_dates/{company_id}{?service_ids,staff_id,date}]


Объект даты, доступные для бронирования имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  working_days  |  массив рабочих дней сгруппированных по месяцам   | Рабочие дни сотрудника/организации  |
|  working_dates  | array of dates  | Массив дат, когда работает сотрудник/организация  |
|  booking_days  |  массив дней, когда есть свободные сеансы  | Массив дней, которые доступны для бронирования на указанные услуги   |
|  booking_dates  | array of dates  | Массив дат, когда есть свободные сеансы на услугу к выбранному сотрунику/организации   |

working days и booking_days имеют одинаковый формат:
месяц:[массив дней в этом месяце]

Например такой booking_days:
        "9": [
              "4",
              "5"]
        "10": [
              "14",
              "25"]
Означает что на 4 и 5 сентября, и на 14 и 25 октября есть свободные сеансы для бронирования

### Получить список дат доступных для бронирования [GET]

Доступны следующие фильтры:

    + service_ids: Массив ID услуг. Если нужны даты, когда можно забронировать указанные услуги
    + staff_id: ID сотрудника. Если нужны даты, когда можно забронировать указанного специалиста
    + date: Дата в рамках месяца, если нужны даты по конкретному месяцу

+ Parameters

    + company_id (required, number) - ID компании
    + service_ids (optional, array of number) - ID услуг.
        Фильтр по списку идентификаторов услуг
    + staff_id: `0` (optional, number) - ID сотрудника. Фильтр по идентификатору сотрудника
        Default: 0
    + date (optional, string) - дата в формате iso8601.
        Фильтр по месяцу бронирования (например '2015-09-01')


+ Request (application/json)

     + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)

        {
          "booking_days": {
            "9": [
              "4",
              "5",
              "8",
              "9",
              "12",
              "13",
              "16",
              "17",
              "20",
              "21",
              "24",
              "25",
              "28",
              "29",
              "30"
            ],
            "10": [
              "1",
              "4",
              "5",
              "8",
              "9",
              "12",
              "13",
              "16",
              "17",
              "20",
              "21",
              "24",
              "25"
            ]
          },
          "booking_dates": [
            "2015-09-04",
            "2015-09-05",
            "2015-09-08",
            "2015-09-09",
            "2015-09-12",
            "2015-09-13",
            "2015-09-16",
            "2015-09-17",
            "2015-09-20",
            "2015-09-21",
            "2015-09-24",
            "2015-09-25",
            "2015-09-28",
            "2015-09-29",
            "2015-09-30",
            "2015-10-01",
            "2015-10-04",
            "2015-10-05",
            "2015-10-08",
            "2015-10-09",
            "2015-10-12",
            "2015-10-13",
            "2015-10-16",
            "2015-10-17",
            "2015-10-20",
            "2015-10-21",
            "2015-10-24",
            "2015-10-25"
          ],
          "working_days": {
            "9": [
              "4",
              "5",
              "8",
              "9",
              "12",
              "13",
              "16",
              "17",
              "20",
              "21",
              "24",
              "25",
              "28",
              "29",
              "30"
            ],
            "10": [
              "1",
              "4",
              "5",
              "8",
              "9",
              "12",
              "13",
              "16",
              "17",
              "20",
              "21",
              "24",
              "25"
            ]
          },
          "working_dates": [
            "2015-09-04",
            "2015-09-05",
            "2015-09-08",
            "2015-09-09",
            "2015-09-12",
            "2015-09-13",
            "2015-09-16",
            "2015-09-17",
            "2015-09-20",
            "2015-09-21",
            "2015-09-24",
            "2015-09-25",
            "2015-09-28",
            "2015-09-29",
            "2015-09-30",
            "2015-10-01",
            "2015-10-04",
            "2015-10-05",
            "2015-10-08",
            "2015-10-09",
            "2015-10-12",
            "2015-10-13",
            "2015-10-16",
            "2015-10-17",
            "2015-10-20",
            "2015-10-21",
            "2015-10-24",
            "2015-10-25"
          ]
        }

## Сеансы доступные для бронирования [/book_times/{company_id}/{staff_id}/{date}{?service_ids}]

Объект сеансы, доступные для бронирования имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  time  |  string   | Время сеанса (17:30 например)   |
|  seance_length  | number  | Длительность сеанса в секундах  |
|  datetime  |  datetime  | Дата и время сеанса в формате ISO8601 (нужно передавать при создании записи)   |


### Получить список сеансов доступных для бронирования [GET]


Доступны следующие фильтры:

    + service_ids: Массив ID услуг. Если нужны сеансы, когда можно забронировать указанные услуги

+ Parameters

    + company_id (required, number) - ID компании
    + service_ids (optional, array of number) - ID услуг.
        Фильтр по списку идентификаторов услуг
    + date (required, string) - дата в формате iso8601.
        Фильтр по дате бронирования (например '2015-09-30')
    + staff_id: `0` (optional, number) - ID сотрудника. Фильтр по идентификатору сотрудника
        Default: 0

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)


    + Attributes (Seance)


    + Body

            [
              {
                "time": "12:00",
                "seance_length": 3600,
                "datetime": "2015-09-29T12:00:00+04:00"
              },
              {
                "time": "13:00",
                "seance_length": 3600,
                "datetime": "2015-09-29T13:00:00+04:00"
              },
              {
                "time": "14:00",
                "seance_length": 3600,
                "datetime": "2015-09-29T14:00:00+04:00"
              },
              {
                "time": "15:00",
                "seance_length": 3600,
                "datetime": "2015-09-29T15:00:00+04:00"
              },
              {
                "time": "16:00",
                "seance_length": 3600,
                "datetime": "2015-09-29T16:00:00+04:00"
              }
            ]

## Список ближайших сеансов сотрудника [/book_staff_seances/{company_id}/{staff_id}/{?service_ids,datetime}]

Объект ближайших сеансов сотрудника имеет следующие поля:

| Поле | Тип | Описание |
| ------------- | ------------- | ------------- |
|  seance_date  |  string   | Ближайшая дата с доступными сеансами   |
|  seances  | Array  | Список доступных сеансов  |

### Получить список ближайших доступных сеансов [GET]

Доступны следующие фильтры:

+ service_ids: Массив ID услуг. Если нужны сеансы, когда можно забронировать указанные услуги
+ datetime: дата (в формате iso8601), за которую необходимо получить ближайшие сеансы

+ Parameters

    + company_id (required, number) - ID компании
    + staff_id (required, number) - ID сотрудника
    + service_ids (optional, array of number) - ID услуг.
        Фильтр по списку идентификаторов услуг
    + datetime (optional, string) - дата в формате iso8601.
        Фильтр по дате


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)


    + Attributes (Seance)
        + seance_date (string)
        + seances (array[Seance])


    + Body

            {
              "seance_date": "2017-04-13",
              "seances": [
                {
                  "time": "10:00",
                  "seance_length": 3600,
                  "datetime": "2017-04-13T10:00:00+04:00"
                },
                {
                  "time": "10:15",
                  "seance_length": 3600,
                  "datetime": "2017-04-13T10:15:00+04:00"
                },
                {
                  "time": "10:30",
                  "seance_length": 3600,
                  "datetime": "2017-04-13T10:30:00+04:00"
                },
                {
                  "time": "10:45",
                  "seance_length": 3600,
                  "datetime": "2017-04-13T10:45:00+04:00"
                },
                {
                  "time": "11:00",
                  "seance_length": 3600,
                  "datetime": "2017-04-13T11:00:00+04:00"
                }
              ]
            }

## СМС код подтверждения номера телефона [/book_code/{company_id}]

+ Тело запроса
    + phone (required, string, '79991234567') - телефон, на который будет отправлен код
    + fullname (option, sring, `Вася`) - Имя клиента

### Отправить СМС код подтверждения номера телефона [POST]

+ Parameters

    + company_id: 4564 (required, number) - ID компании


+ Request (application/json)

    + Attributes
        + phone: '79161001010' (required, string) - Телефон, на который будет отправлен код (например '79161005050')
        + fullname: 'Василиса' (string) - Имя клиента

     + Headers

            Authorization: Bearer partner_token

    + Body

               {
                    "phone": "79991234567",
                    "fulname": "Вася"
                }

+ Response 201 (application/json)

## Проверка параметров записи на сеанс [/book_check/{company_id}]

После формирования параметров записи(ей) можно проверить их на возможность создание записей.

JSON-Объект содержащий параметры онлайн записи имеет следующие поля:

| Поле | Тип | Обязательный | Описание |
| ------------- | ------------- | ------------- | ------------- |
| appointments  | Массив объктов  |  ДА  | Параметры записи (услуги, специалисты...) |

Массив appointments состоит из объектов,которые имюет следующие поля:

| Поле | Тип | Обязательный | Описание |
| ------------- | ------------- | ------------- | ------------- |
| id  | number  |  Да  | Идентификатор записи для обратной связи после сохранения (смотри ответ на запрос).
| services  | array of numbers  | НЕТ  |  Массив идентификторов услуг, на которые клиент хочет записаться |
| staff_id  | number  |  ДА  | Идентификатор специалиста, к которому клиент хочет записаться (0 если выбран любой мастер)  |
| datetime  | datetime  |  ДА  | Дата и время сеанса в формате ISO8601 (передается для кадого сеанса в ресурсе book_times)|


В ответ на запрос проверки параметров придет пустой ответ с кодом 201 если параметры записи в порядке и записи могут быть созданы:

Если в ответ придет JSON с HTTP кодом отличным от 201, значит параметры записи не в порядке, а записи не могут быть созданы.

Ошибки, которые может вернуть сервер:

1. Выбранное время одной из записей уже занято.
В этом случае приходит ответ с http-кодом 422 и кодом ошибки 433,
а так же в поле id передается идентификатор записи из массива appointments

2. Нет сотрудников доступных для записи (если был выбран мастер по умолчанию).
В этом случае приходит ответ с http-кодом 422 и кодом ошибки 436

3. Выбранное время одной из записей пересекается с временем записи, создаваемой этим же запросом.
В этом случае приходит ответ с http-кодом 422 и кодом ошибки 437,
а так же в поле id передается идентификатор записи из массива appointments

4. Нет записи на указанную услуги. (Компания уже удалили выбранные услуги)
В этом случае приходит ответ с http-кодом 422 и кодом ошибки 438


### Проверить параметры записи [POST]

+ Parameters

    + company_id (required, number) - ID компании

+ Request (application/json)

    + Attributes

        + appointments (required, Appointment) - Параметры записей (сеанс, услуги, мастер)


    + Headers

            Authorization: Bearer partner_token

    + Body

               {
                    "appointments": [
                        {
                            "id":1,
                            "services":[331],
                            "staff_id": 6544,
                            "datetime": "2015-09-30T15:30:00+04:00"
                        },
                        {
                            "id":2,
                            "services":[99055],
                            "staff_id": 6544,
                            "datetime": "2015-09-30T16:00:00+04:00"
                        }
                    ]
                }

+ Response 201 (application/json)

    + Body

            {
              "errors": {
                "code": 437,
                "id": 2,
                "message": "К сотруднику Ирина Александровна(6544) нельзя записаться на 30 сентября 2015 в 16:00. Пересечение с предыдущим визитом."
              }
            }



## Запись на сеанс [/book_record/{company_id}/{record_id}]


JSON-Объект содержащий параметры онлайн записи имеет следующие поля:

| Поле | Тип | Обязательный | Описание |
| ------------- | ------------- | ------------- | ------------- |
| phone  | string  | ДА  |  Телефон клиента (например 79161502239)  |
| fullname  | string  |  ДА  | Имя клиента  |
| email  | string  |  ДА  | Почтовый адрес клиента  |
| appointments  | Массив объктов  |  ДА  | Параметры записи (услуги, специалисты...) |
| code  | string  |  НЕТ  |  Код подтверждения номера телефона,высланный по СМС (нужен только в случае необходимости подтверждения номера)  |
| notify_by_sms  | number  |  НЕТ  |  За какое кол-во часов отправить смс напоминание о записи (0 если не нужно напоминать)  |
| notify_by_email  | number  |  НЕТ  |  За какое кол-во часов отправить email напоминание о записи (0 если не нужно напоминать)  |
| comment  | string  |  НЕТ  | Комментарий к записи  |
| api_id  | string  |  НЕТ  | Внешний идентификатор записи  |

Массив appointments состоит из объектов,которые имюет следующие поля:

| Поле | Тип | Обязательный | Описание |
| ------------- | ------------- | ------------- | ------------- |
| id  | number  |  Да  | Идентификатор записи для обратной связи после сохранения (смотри ответ на запрос).
| services  | array of numbers  | НЕТ  |  Массив идентификторов услуг, на которые клиент хочет записаться |
| staff_id  | number  |  ДА  | Идентификатор специалиста, к которому клиент хочет записаться (0 если выбран любой мастер)  |
| datetime  | datetime  |  ДА  | Дата и время сеанса в формате ISO8601 (передается для кадого сеанса в ресурсе book_times)|
| custom_fields | key-value object | НЕТ | Значения дополнительных полей записи которые возвращаются вместе с записью |

Дополнительные поля в массиве appointments

При создании дополнительных полей записи(см. раздел "Дополнительные поля") становится возможным передавать собственные значения для полей.
Дополнительные поля уникальны для каждой компании. После создания дополнительных полей, их значения для конкретной записи могут
передаваться в необязательном поле custom_fields в виде пар ключ-значение где ключ это поле "code" дополнительного поля. Пример:

* Создали дополнительное поле записи с code="my_custom_field" type="number", и второе поле code="some_another_field" type="list"

* Передали при создании записи в элементе массива appointments еще один атрибут:
appointments: [{
    ...
}, {
    ...
    custom_fields: {
        "my_custom_field": 123,
        "some_another_field": ["first value", "second value"]
    }
}]

* При получении данной записи методом GET впоследствии, это же значение дополнительных полей вернется в ответе


В ответ на запрос создания записи придет массив объектов (кол-во объектов равно кол-ву объектов в массиве appointments) со следующими полями:

| Поле | Тип | Описание |
| ------------- | ------------- | ------------- |
| id  | number  |  Идентификатор записи переданный в массиве appointments  |
| record_id  | number  |  Идентификатор созданной в системе записи  |
| record_hash  | string  |  Идентификатор записи, для ее удаления непосредственно сразу после создания  |

Ошибки, которые необходимо обрабатывать:
1. Введенный код подтверждения номера из SMS неправильный.
В этом случае приходит ответ с http-кодом 422 и кодом ошибки 432

2. Выбранное время одной из записей уже занято.
В этом случае приходит ответ с http-кодом 422 и кодом ошибки 433,
а так же в поле id передается идентификатор записи из массива appointments

3. Пользователь с указанным телефоном в черном списке и не может записываться.
В этом случае приходит ответ с http-кодом 403 и кодом ошибки 434

4. Номер телефона пользователя в неправильном формате.
В этом случае приходит ответ с http-кодом 422 и кодом ошибки 431

5. Не указано имя клиента.
В этом случае приходит ответ с http-кодом 422 и кодом ошибки 435

6. Нет сотрудников доступных для записи (если был выбран мастер по умолчанию).
В этом случае приходит ответ с http-кодом 422 и кодом ошибки 436

7. Выбранное время одной из записей пересекается с временем записи, создаваемой этим же запросом.
В этом случае приходит ответ с http-кодом 422 и кодом ошибки 437,
а так же в поле id передается идентификатор записи из массива appointments

### Создать запись на сеанс [POST /book_record/{company_id}]

+ Parameters

    + company_id (required, number) - ID компании

+ Request (application/json)

    + Attributes
        + phone: '79161001010' (required, string) - Телефон клиента
        + fullname: 'Василиса' (required, string) - Имя клиент
        + email: 'client@yclients.com' (optional, string) - Имя клиента
        + code: 20145 (optional, number) - Код подтверждения телефона, высланный по смс (обязателен если у компании выставлен phone_conformation = true)
        + comment: 'убрать усы' (optional, string) - Комментарий к записи
        + type: 'mobile' (optional, string) - Источник записи
        + notify_by_sms: 2 (optional, number) - За сколько часов до визита следует выслать смс напоминание клиенту (0 - если не нужно)
        + notify_by_email: 2 (optional, number) - За сколько часов до визита следует выслать email напоминание клиенту (0 - если не нужно)
        + api_id: 2 (optional, number) - ID записи из внешней системы
        + appointments (required, Appointment) - Параметры записей (сеанс, услуги, мастер)

    + Headers

            Authorization: Bearer partner_token

    + Body

               {
                    "phone": "79000000000",
                    "fullname": "ДИМА",
                    "email": "d@yclients.com",
                    "code": "38829",
                    "comment": "тестовая запись!",
                    "type": "mobile",
                    "notify_by_sms": 6,
                    "notify_by_email": 24,
                    "api_id": "777",
                    "appointments": [
                        {
                            "id":1,
                            "services":[331],
                            "staff_id": 6544,
                            "datetime": "2015-09-29T13:00:00+04:00",
                            "custom_fields": {
                                "my_custom_field": 123,
                                "some_another_field": ["first value", "next value"]
                            }
                        },
                        {
                            "id":2,
                            "services":[99055],
                            "staff_id": 6544,
                            "datetime": "2015-09-30T16:00:00+04:00",
                            "custom_fields": {
                                "my_custom_field": 456,
                                "some_another_field": ["next value", "last value"]
                            }
                        }
                    ]
                }

+ Response 201 (application/json)

    + Attributes
        + id: 1 (required, number) - ID записи переанный в запросе в appontments
        + record_id: 23521 (required, number) - ID записи в системе yclients. Используется для удаления записи
        + record_hash: '4мcli3ent2yclientsщщ0com' (required, string) - HASH записи в системе yclients. Используется для удаления записи неавторизованным пользователем сразу после бронирования

    + Body

            [
                {
                    "id": 1,
                    "record_id": 2820023,
                    "record_hash": "567df655304da9b98487769426d4e76e"
                },
                {
                    "id": 2,
                    "record_id": 2820024,
                    "record_hash": "34a45ddabdd446d5d33bdd27fbf855b2"
                }
            ]


### Перенести запись на сеанс [PUT]

+ Parameters

    + company_id (required, number) - ID компании
    + record_id (required, number) - ID записи которую необходимо перенести

+ Request (application/json)

    + Attributes
        + datetime: '79161001010' (required, string) - Дата и время на которое мы хотим перенести запись
        + comment: 'убрать усы' (optional, string) - Комментарий к записи


    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

               {
                  "datetime": "2016-05-20T14:30:00",
                  "comment" : "DODO!"
                }

+ Response 200 (application/json)

    + Attributes
        + id: 12655 (required, number) - ID записи
        + services: [141, 330] (required, array[number]) - Список ID услуг
        + company (required, Company) - Параметры компани
        + staff (required, Staff) - Параметры сотрудника
        + comment: 'убрать усы' (required, string) - Комментарий к записи
        + date: '2012-04-02T12:00:00Z' (required, string) - Дата сеанса
        + create_date: '2012-04-02T12:00:00Z' (required, string) - Дата создания записи
        + length: 3600 (required, number) - Длительность сеанса
        + deleted: false (required, boolean) - Уделана ли запись (true если удалена)
        + online: false (required, boolean) - Запись онлайновая или нет (false если запись внес администратор)
        + master_requested: false (required, boolean) - Был ли указан определенный специалист при записи (false если был указан "не имеет значения")
        + notify_by_sms: 2 (optional, number) - За сколько часов до визита следует выслать смс напоминание клиенту (0 - если не нужно)
        + notify_by_email: 2 (optional, number) - За сколько часов до визита следует выслать email напоминание клиенту (0 - если не нужно)
        + api_id: 2 (optional, number) - ID записи из внешней системы

    + Body

            {
                "id": 30358,
                "services": [
                  {
                    "id": 2838,
                    "title": "Массаж ног",
                    "cost": 0,
                    "discount": 0
                  }
                ],
                "company": {
                  "id": 4564,
                  "title": "",
                  "country_id": "0",
                  "country": "",
                  "city_id": "0",
                  "city": "Москва",
                  "phone": "+7 916 684-41-22",
                  "timezone": "0",
                  "address": "",
                  "coordinate_lat": "0",
                  "coordinate_lon": "0"
                },
                "staff": {
                  "id": 924,
                  "name": "Евгения",
                  "spec": "о ес",
                  "show_rating": "1",
                  "rating": "5",
                  "votes_count": "1",
                  "avatar": "http://salonpicker.ru/images/no-master.png",
                  "comments_count": "0"
                },
                "date": "2016-05-20T14:30:00",
                "create_date": "2016-05-19T14:30:10",
                "comment": "",
                "deleted": true,
                "length": 3600,
                "notify_by_sms": 0,
                "notify_by_email": 0,
                "master_requested": false,
                "online": true,
                "api_id": "0"
            }

### Создать запись в групповом событии [POST /activity/{company_id}/{activity_id}/book]

+ Parameters
    + company_id (required, number) - ID компании
    + activity_id (required, number) - ID группового события

+ Attributes
    + fullname: 'Василиса' (required, string) - Имя клиент
    + phone: '79161001010' (required, string) - Телефон клиента
    + email: 'client@yclients.com' (optional, string) - Имя клиента
    + code: 20145 (optional, number) - Код подтверждения телефона, высланный по смс (обязателен если у компании выставлен phone_conformation = true)
    + comment: 'убрать усы' (optional, string) - Комментарий к записи
    + type: 'mobile' (optional, string) - Источник записи
    + notify_by_sms: 2 (optional, number) - За сколько часов до визита следует выслать смс напоминание клиенту (0 - если не нужно)
    + notify_by_email: 2 (optional, number) - За сколько часов до визита следует выслать email напоминание клиенту (0 - если не нужно)
    + api_id: 2 (optional, number) - ID записи из внешней системы

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                "fullname": "Test user",
                "phone": "71110000011",
                "email": "testemail@yclients.com",
                "code": "",
                "comment": "",
                "notify_by_sms": 0,
                "notify_by_email": 0,
                "type": "mobile"
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 28417878,
                    "hash": "9e6a54a1a9b118b65cc39ab6f3c3b5b4"
                },
                "meta": []
            }


# Group Записи пользователя

Для управлениями записями пользователя используются следующие методы

## Авторизация пользователя по номеру телефона и коду смс [/user/auth]

Для доступа к своим онлайн и оффлайн (сделанным по телефону) записям пользователь должен авторизоваться подтвердив свой номер телефона.
Для этого ему нужно выслать на свой номер телефона код подтверждения с помощью ресурса "СМС код подтверждения номера телефона"

### Авторизоваться по номеру телефона и коду [POST]

+ Request (application/json)

    + Attributes
        + phone: '79161001010' (required, string) - Телефон, на который будет отправлен код (например '79161005050')
        + code: 20123 (required, string) - Код подтверждения номера телефона, высланный по смс

    + Headers

            Authorization: Bearer partner_token

    + Body

                {
                    "phone": "79991234567",
                    "code": 30254
                }

+ Response 201 (application/json)

    + Attributes (object)
        + user_token: `wec23fh8cDfFV4432fc352456` (required, string) - User Access Token


## Записи пользователя [/user/records/{record_id}/{record_hash}]

JSON-Объект содержащий параметры записи пользователя имеет следующие поля:

| Поле | Тип | Обязательный | Описание |
| ------------- | ------------- | ------------- | ------------- |
| id  | number  | ДА  |  ID записи  |
| services  | array of numbers  |  ДА  | Список ID услуг записи  |
| company  | object  |  ДА  | Параметры компании  |
| staff  | object  |  ДА  | Параметры специалиста, которые был забронирован |
| date  | string  |  ДА  |  Дата сеанса  |
| create_date  | string  |  ДА  |  Дата создания записи  |
| length  | number  |  ДА  | Длительность сеанса  |
| deleted  | boolean  |  ДА  | Уделана ли запись (true если удалена)  |
| notify_by_sms  | number  |  НЕТ  |  За какое кол-во часов отправить смс напоминание о записи (0 если не нужно напоминать)  |
| notify_by_email  | number  |  НЕТ  |  За какое кол-во часов отправить email напоминание о записи (0 если не нужно напоминать)  |
| comment  | string  |  ДА  | Комментарий к записи  |
| master_requested  | boolean  |  ДА  | Был ли указан определенный специалист при записи (false если был указан "не имеет значения")  |
| online  | boolean  |  ДА  | Запись онлайновая или нет (false если запись внес администратор)  |
| visit_attendance  | number  |  ДА  | 1 - Пользователь пришел, услуги оказаны, 0 - ожидание пользователя, -1 - пользователь не пришел на визит  |
| api_id  | string  |  НЕТ  | Внешний идентификатор записи  |

Объект company имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор компании  |
|  title  | string  |  Название компании  |
|  country_id  | number  |  Идентификатор страны, в которой расположена компания  |
|  country  | string  |  Название старны компании  |
|  city_id  | number  |  Идентификатор города, в котором расположена компания)  |
|  city  | string  |  Название города компании  |
|  timezone  | string  |  Timezone компании  |
|  address  | string  |  Адрес, по которому расположена компания  |
|  phone  | string  | Номер телефона компании  |
|  coordinate_lat  | float  |  Широта, на которой расположена компания  |
|  coordinate_lng  | float  |  Долгота  |

Объект staff имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор сотрудника  |
|  name  | string  |  Имя сотрудника  |
|  specialization  | string  |  Специализация сотрудника  |
|  show_rating  | number  |  Показывать ли рейтинг сотрудника (1 - показывать, 0 - не показывать)  |
|  rating  | number  |  Ретинг сотрудника  |
|  votes_count  | number  |  Кол-во голос, оценивших сотрудника  |
|  comments_count  | number  |  Кол-во комментариев к сотрунику  |
|  avatar  | string  |  Путь к файлу аватарки сотрудника  |


### Получить записи пользователя [GET]

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 201 (application/json)

    + Attributes
        + id: 12655 (required, number) - ID записи
        + services: [141, 330] (required, array[number]) - Список ID услуг
        + company (required, Company) - Параметры компани
        + staff (required, Staff) - Параметры сотрудника
        + comment: 'убрать усы' (required, string) - Комментарий к записи
        + date: '2012-04-02T12:00:00Z' (required, string) - Дата сеанса
        + create_date: '2012-04-02T12:00:00Z' (required, string) - Дата создания записи
        + length: 3600 (required, number) - Длительность сеанса
        + deleted: false (required, boolean) - Уделана ли запись (true если удалена)
        + online: false (required, boolean) - Запись онлайновая или нет (false если запись внес администратор)
        + master_requested: false (required, boolean) - Был ли указан определенный специалист при записи (false если был указан "не имеет значения")
        + notify_by_sms: 2 (optional, number) - За сколько часов до визита следует выслать смс напоминание клиенту (0 - если не нужно)
        + notify_by_email: 2 (optional, number) - За сколько часов до визита следует выслать email напоминание клиенту (0 - если не нужно)
        + api_id: 2 (optional, number) - ID записи из внешней системы


    + Body

            [
                  {
                        "id": 30358,
                        "services": [
                          {
                            "id": 2838,
                            "title": "Массаж ног",
                            "cost": 0,
                            "discount": 0
                          }
                        ],
                        "company": {
                          "id": 4564,
                          "title": "",
                          "country_id": "0",
                          "country": "",
                          "city_id": "0",
                          "city": "Москва",
                          "phone": "+7 916 684-41-22",
                          "timezone": "0",
                          "address": "",
                          "coordinate_lat": "0",
                          "coordinate_lon": "0"
                        },
                        "staff": {
                          "id": 924,
                          "name": "Евгения",
                          "spec": "о ес",
                          "show_rating": "1",
                          "rating": "5",
                          "votes_count": "1",
                          "avatar": "http://salonpicker.ru/images/no-master.png",
                          "comments_count": "0"
                        },
                        "date": "2012-04-02 12:00:00",
                        "create_date": "0000-00-00 00:00:00",
                        "comment": "",
                        "deleted": true,
                        "length": 3600,
                        "notify_by_sms": 0,
                        "notify_by_email": 0,
                        "master_requested": false,
                        "online": true,
                        "api_id": "0"
                    },
                    {
                        "id": 34805,
                        "services": [
                          {
                            "id": 154,
                            "title": "Укладка волос",
                            "cost": 0,
                            "discount": 0
                          }
                        ],
                        "company": {
                          "id": 11696,
                          "title": "Найс",
                          "country_id": "1",
                          "country": "Россия",
                          "city_id": "1",
                          "city": "Санкт-Петербург",
                          "phone": "+7 953 177-34-85",
                          "timezone": "4",
                          "address": "Ленинский пр-кт, д. 75, к. 1",
                          "coordinate_lat": "59.8584084119386",
                          "coordinate_lon": "30.189927443862"
                        },
                        "staff": {
                          "id": 1142,
                          "name": "Альфия",
                          "spec": "парикмахер",
                          "show_rating": "1",
                          "rating": "0",
                          "votes_count": "0",
                          "avatar": "http://salonpicker.ru/images/no-master.png",
                          "comments_count": "0"
                        },
                        "date": "2012-04-21 19:45:00",
                        "create_date": "0000-00-00 00:00:00",
                        "comment": "",
                        "deleted": true,
                        "length": 1800,
                        "notify_by_sms": 0,
                        "notify_by_email": 0,
                        "master_requested": false,
                        "online": true,
                        "api_id": "0"
                    }
            ]


### Удалить запись пользователя [DELETE]


+ Parameters

    + record_id: 22123 (required, number) - ID записи (достаточно для удаления записи если пользователь авторизован)
    + record_hash: 'dawd4fs09rhf0s9fafef0' (optional, string) - HASH записи (обязательно для удаления записи если пользователь не авторизован)

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)



# Group Компании
Для работы с компаниями используются следующие методы

## Коллекция компаний [/companies{?group_id,my,forBooking,active,moderated,coordinate_lat,coordinate_lon,distance,title,show_groups}]

Объект компании имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор компании  |
|  title  | string  |  Название компании (Обязательное поле для создание компании) |
|  logo  | string  |  Адрес изображения логотипа компании  |
|  short_descr  | string  |  Категория компании  |
|  country_id  | number  |  Идентификатор страны, в которой расположена компания  |
|  country  | string  |  Название старны компании  |
|  city_id  | number  |  Идентификатор города, в котором расположена компания)  |
|  city  | string  |  Название города компании  |
|  timezone  | string  |  Timezone компании  |
|  schedule  | string  |  Расписание работы компании  |
|  address  | string  |  Адрес, по которому расположена компания  |
|  phone  | string  | Номер телефона компании  |
|  coordinate_lat  | float  |  Широта, на которой расположена компания  |
|  coordinate_lon  | float  |  Долгота  |
|  app_ios  | string  |  Ссылка на приложение под ios  |
|  app_android  | string  |  Ссылка на приложение под android  |
|  phone_confirmation  | boolean  | Нужно ли подтверждать телефон по смс  |
|  active_staff_count  | number  | Кол-во сотрудников доступных для бронирования  |
|  next_slot  | datetime  | Дата и время ближайшего свободного сеанса в компании(ISO8601). Поле будет присутствовать только если передан GET параметр forBooking=1
|  booking_comment_required  | boolean | Является ли поле с комментарием к записи обязательным для заполнения
|  booking_email_required  | boolean | Является ли поле Email к записи обязательным для заполнения
|  booking_comment_input_name  | string (optional)  | Заголовок для поля с вводом комментария к записи (если не залдано то используется по умолчанию значение)
|  booking_notify_text  | string (optional)  | Текст уведомления, которое выводится (если задано) на шаге ввода контактных данных
|  reminds_sms_disabled  | boolean  | True - если у компании выключен сервис SMS напоминаний клиентам.
|  group_priority  | number  | Чем больше приоритет, тем выше компания при выводе в списке филиалов сети
|  allow_change_record  | boolean  | Изменение записи  |
|  allow_change_record_delay_step  | number  | Запретить изменять записи за период. (В секундах)
|  allow_delete_record  | boolean  | Удаление записи  |
|  allow_delete_record_delay_step  | number  | Запретить удалять записи за период. (В секундах)


### Получить список список компаний [GET]

#### Фильтрация компаний
+ group_id: ID сети компаний. Если нужны компании входящие в конкретную сеть
+ my: Только для авторизованного пользователя. Если нужно компании, на управление которыми пользователь имеет права
+ active: Если нужно получить только активные для онлайн-записи компании
+ moderated: Если нужно получить только прошедшие модерацию компании. Т.е. чей контент проверен для публикации
+ forBooking: Если нужно получить поле next_slot по каждой компании
+ coordinate_lat: Широта центра поиска по координатам
+ coordinate_lon: Долгота центра поиска по координатам
+ distance: Радиус поиска
+ title: Поиск по вхождению подстроки в название компании
+ show_groups: Включить в обьект компании список сетей в которые входит эта компания


+ Parameters

    + group_id: 83 (optional, number) - ID сети компаний.
        Фильтр по идентификатору сети компаний
        Default: 83
    + my: 1 (optional, number) - Только для авторизованного пользователя. Если нужно компании, на управление которыми пользователь имеет права
    + active: 1 (optional, number) - Если нужно получить только активные для онлайн-записи компании
    + moderated: 1 (optional, number) - Если нужно получить только прошедшие модерацию компании. Т.е. чей контент проверен для публикации
    + forBooking: 1 (optional, number) - Если нужно получить поле next_slot по каждой компании
    + show_groups: 1 (optional, number) - Включить в обьект компании список сетей в которые входит эта компания

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)

        [
            {
                "id": "1050",
                "title": "Ля Визаж",
                "short_descr": "Салон красоты",
                "logo": "http://salonpicker.ru/images/icon.png",
                "active": "1",
                "phone": "+7 495 509-24-46",
                "country_id": 1,
                "schedule": "",
                "country": "Россия",
                "city_id": 1,
                "city": "Москва",
                "timezone": "Europe/Moscow",
                "address": "Талалихина, д. 1, к. 2",
                "coordinate_lat": "55.735662",
                "coordinate_lon": "37.678218",
                "phone_confirmation": true,
                "active_staff_count": 2,
                "next_slot": "2015-09-29T12:00:00+04:00",
                "app_ios": "",
                "app_android": "",
                "currency_short_title": "р",
                "group_priority": 900,
            },
            {
                "id": "1051",
                "title": "Ля Визаж 2",
                "short_descr": "Салон красоты",
                "logo": "http://salonpicker.ru/images/icon.png",
                "active": "1",
                "phone": "+7 495 509-24-46",
                "country_id": 1,
                "country": "Россия",
                "city_id": 1,
                "city": "Москва",
                "timezone": "Europe/Moscow",
                "address": "Талалихина, д. 1, к. 2",
                "coordinate_lat": "55.835662",
                "coordinate_lon": "37.778218",
                "phone_confirmation": false,
                "active_staff_count": 3,
                "next_slot": "2015-09-29T11:00:00+04:00",
                "app_ios": "",
                "app_android": "",
                "currency_short_title": "р",
                "group_priority": 901,
            }
        ]

### Создать компанию [POST]

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token
    + Body

               {
                    "title": "Новая компания",
                    "country_id": 1,
                    "city_id": 2,
                    "timezone": "Europe/Moscow",
                    "address": "Талалихина, д. 1, к. 2",
                    "coordinate_lat": "55.835662",
                    "coordinate_lon": "37.778218"
                }

+ Response 201 (application/json)

            {
                "id": "1050",
                "title": "Новая компания",
                "short_descr": "Салон красоты",
                "logo": "http://salonpicker.ru/images/icon.png",
                "active": "1",
                "phone": "",
                "country_id": 1,
                "schedule": "",
                "country": "Россия",
                "city_id": 2,
                "city": "Москва",
                "timezone": "Europe/Moscow",
                "address": "Талалихина, д. 1, к. 2",
                "coordinate_lat": "55.735662",
                "coordinate_lon": "37.678218",
                "phone_confirmation": true,
                "active_staff_count": 2,
                "app_ios": "",
                "app_android": "",
                "currency_short_title": "р",
            }

## Компания [/company/{id}/{?forBooking,show_groups}]

+ Параметр
    + id (required, number, `1`) ...
    + forBooking: 1 (optional, number) - Дата и время ближайшего свободного сеанса в компании(ISO8601).
    + show_groups: 1 (optional, number) - Включить в обьект компании список сетей в которые входит эта компания

### Получить компанию [GET]
+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)

        {
            "id": 37532,
            "title": "Новая компания",
            "country_id": 1,
            "country": "Россия",
            "city_id": 1,
            "city": "Москва",
            "timezone" : "Europe/Moscow",
            "address": "Большой Саввинский пер., д. 3,
            "coordinate_lat": "55.735662",
            "coordinate_lon": "37.678218",
            "phone_confirmation": true,
            "active_staff_count": 2,
            "next_slot": "2015-09-22 10:00:00",
            "group_priority": 900,
            "push_notification_phone_confirm": 1
        }

### Изменить компанию [PUT]

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token
  + Body

            {
                "title": "Новая компания",
                "country" : "Россия",
                "city" : "Москва",
                "timezone" : "Europe/Moscow",
                "address": "Большой Саввинский пер., д. 4"
            }

+ Response 200 (application/json)

        { "id": 37532 }


### Удалить компанию [DELETE]

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token


+ Response 204

# Group Категория услуг
Для работы с категориями услуг используются следующие методы

Объект категории услуг имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор категории  |
|  title  | string  |  Название категории  |
|  api_id  | string  |  Внешний идентификатор категории  |
|  weight  | number  |  Вес категории (используется для сортировки категорий при отображении)  |
|  staff  | array  |  Список ID сотрудников, оказывающих услугу |

#### Фильтрация категорий услуг
+ staff_id: ID сотрудника. Если нужны услуги, которые оказывает конкретный мастер

## Коллекция категорий услуг [/service_categories/{company_id}/{id}{?staff_id}]

+ Параметр
    + company_id (required, number) - ID компании
    + id (optional, number) - ID категории услуг (для работы с конкретной категорией)
    + staff_id (optional, number) - ID сотрудника (для получения категорий, привязанных к сотруднику)


+ Parameters

    + company_id: 1 (required, number) - ID компании
    + id: 1 (optional, number) - ID категории услуг
    + staff_id: 1 (optional, number) - ID сотрудника (для получения категорий, привязанных к сотруднику)

### Получить список категорий услуг [GET]

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)

        [{
            "id": 345,
            "title": "Стрижки мужские",
            "api_id" : "adw322",
            "weight": 10,
            "staff": [
              5006,
              8901,
              26514,
              26516,
              26519,
              26520
            ]
        },
        {
            "id": 3456,
            "title": "Стрижки женские",
            "api_id" : "adw323",
            "weight": 9,
            "staff": [
              5006,
              8901
            ]
        }]

### Создать категорию услугу [POST /service_categories/{company_id}]

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token
  + Body

            {
                "title": "Стрижка очень женская",
                "api_id" : "adw322",
                "weight": 111,
                "staff": [
                  5006,
                  8901
                ]
            }

+ Response 201 (application/json)

        {
            "id": 3,
            "title": "Стрижка очень женская",
            "api_id" : "adw322",
            "weight": 111,
            "staff": [
              5006,
              8901
            ]
        }


## Категория услуг [/service_category/{company_id}/{id}]

+ Параметры
    + company_id (required, number, `1`) - ID компании
    + id (required, number, `1`) - ID категории услуг

### Получить категорию услуг [GET]

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)

        {
            "id": 3
            "title": "Стрижки женские",
            "weight": 12,
            "staff": [
              5006,
              8901
            ]
        }


### Изменить категорию услуг [PUT]

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token
  + Body

            {
                "title": "Стрижки женские",
                "weight": 15,
                "staff": [
                  5006,access
                  8901
                ]
            }

+ Response 200 (application/json)

        {
            "id": 3,
            "title": "Стрижки женские",
            "weight": 15,
            "staff": [
              5006,
              8901
            ]
        }


### Удалить категорию услуг [DELETE]

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token

+ Response 204



# Group Услуги

Для работы с услугами используются следующие методы

Объект услуги имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор услуги  |
|  category_id  |  number  |  Идентификатор категории, в которой состоит услуга  |
|  title  | string  |  Название категории  |
|  price_min  | number  |  Минимальная цена на услугу  |
|  price_max  | number  |  Максимальная цена на услугу |
|  active  | number  |  1 - доступна для онлайн записи, 0 - не доступна |
|  comment  | string  |  комментарий у услуге |
|  api_id  | string  |  Внешний идентификатор услуги  |
|  weight  | number  |  Вес категории (используется для сортировки категорий при отображении)  |
|  staff  | array  |  Список сотрудников, оказывающих услугу и длительность сеанса |
|  image_group | object | Группа изображений услуги |

Массив со списком сотрудников, оказывающих услугу состоит из объектов со следующими полями

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор сотрудника  |
|  seance_length  |  number  |  Длительность оказания услуги мастером. (В секундах)  |


#### Фильтрация услуг
+ staff_id: ID сотрудника. Если нужны услуги, которые оказывает конкретный мастер
+ category_id: ID категории. Если нужны услуги, из конкретной категории

## Коллекция услуг [/services/{company_id}/{service_id}{?staff_id,category_id}]

+ Параметр
    + company_id (required, number, `1`) - ID компании
    + service_id (optional, number, `1`) - ID услуги

### Получить список услуг / конкретную услугу [GET]

+ Parameters

    + company_id (required, number) - ID компании
    + service_id (optional, number) - ID услуги, если нужно работать с конкретной услугой.
    + staff_id (optional, number) - ID сотрудника, если нужно отфильтровать по сотруднику
    + category_id (optional, number) - ID категории, если нужно отфильтровать по категории

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token


+ Response 200 (application/json)

        [{
            "id": "79067",
            "title": "Бритье головы",
            "category_id": "4",
            "price_min": "1000.00",
            "price_max": "1000.00",
            "discount": "0",
            "comment": "",
            "weight": "2",
            "active": "1",
            "api_id": "",
            "staff": []
          },
          {
            "id": "83169",
            "title": "Мужская стрижка",
            "category_id": "83167",
            "price_min": "1300.00",
            "price_max": "1300.00",
            "discount": "0",
            "comment": "",
            "weight": "6",
            "active": "1",
            "api_id": "00000000042",
            "staff": [
              {
                "id": "5905",
                "seance_length": "2700"
              },
              {
                "id": "5907",
                "seance_length": "3600"
              },
              {
                "id": "8973",
                "seance_length": "3600"
              },
              {
                "id": "13616",
                "seance_length": "3600"
              },
              {
                "id": "16681",
                "seance_length": "3600"
              },
              {
                "id": "17969",
                "seance_length": "3600"
              },
              {
                "id": "34006",
                "seance_length": "3600"
              }
            ],
            "image_group": {
                "id": 72234,
                "entity": "settings_service",
                "entity_id": 389927,
                "images": {
                  "basic": {
                    "id": "186791",
                    "path": "http://yclients.com/uploads/setting_service_image/b/be/be09e5eb621d364_20170323150015.jpeg",
                    "width": "372",
                    "height": "280",
                    "type": "jpeg",
                    "image_group_id": 72234,
                    "version": "basic"
                  }
                }
              }
          }
        ]


### Создать услугу [POST /services/{company_id}]

+ Parameters

    + company_id (required, number) - ID компании


+ Request (application/json)

  + Attributes

        + title: 'Стрижка женская' (required, string) - Название услуги
        + category_id: 2 (required, number) - ID категории услуг
        + active: 0 (optional, number) - Доступна ли для онлайн записи услуга. 1 - доступна, 0 не доступна.
        + api_id: '' (optional, string) - Внешний идентификатор услуги
        + weight (optional, number) -  Вес услуги (используется для сортировки услуг при отображении)
        + comment: '' (optional, string) - Комментарий к услуге
        + price_min: 0 (optional, number) - Минимальная стоимость услуги
        + price_max: 0 (optional, number) - Максимальная стоимость услуги
        + discount: 0 (optional, number) - Скидка при оказании услуги
        + staff (optional, ServiceStaff) - Сотрудники, оказываюшие услугу и длительность оказания услуги каждым из них
        + image_group_id (optional, number) - Id группы изображений



  + Headers

            Authorization: Bearer partner_token, User user_token

  + Body

            {
                "title": "Мужская стрижка",
                "category_id": 83167,
                "price_min": 1300.00,
                "price_max": 1300.00,
                "discount": 0,
                "comment": "",
                "weight": 6,
                "active": 1,
                "api_id": "00000000042",
                "staff": [
                  {
                    "id": 5905,
                    "seance_length": 2700
                  },
                  {
                    "id": 5907,
                    "seance_length": 3600
                  },
                  {
                    "id": 8973,
                    "seance_length": 3600
                  },
                  {
                    "id": 13616,
                    "seance_length": 3600
                  },
                  {
                    "id": 16681,
                    "seance_length": 3600
                  },
                  {
                    "id": 1796",
                    "seance_length": 3600
                  },
                  {
                    "id": 34006,
                    "seance_length": 3600
                  }
                ]
            }


+ Response 201 (application/json)

        {
            "id": 83169,
            "title": "Мужская стрижка",
            "category_id": 83167,
            "price_min": 1300.00,
            "price_max": 1300.00,
            "discount": 0,
            "comment": "",
            "weight": 6,
            "active": 1,
            "api_id": "00000000042",
            "staff": [
              {
                "id": 5905,
                "seance_length": 2700
              },
              {
                "id": 5907,
                "seance_length": 3600
              },
              {
                "id": 8973,
                "seance_length": 3600
              },
              {
                "id": 13616,
                "seance_length": 3600
              },
              {
                "id": 16681,
                "seance_length": 3600
              },
              {
                "id": 1796,
                "seance_length": 3600
              },
              {
                "id": 34006,
                "seance_length": 3600
              }
            ]
          }


### Изменить услугу [PUT]

+ Parameters

    + company_id (required, number) - ID компании
    + service_id (required, number) - ID услуги


+ Request (application/json)

  + Attributes

        + title: 'Стрижка женская' (required, string) - Название услуги
        + category_id: 2 (required, number) - ID категории услуг
        + active: 0 (optional, number) - Доступна ли для онлайн записи услуга. 1 - доступна, 0 не доступна.
        + api_id: '' (optional, string) - Внешний идентификатор услуги
        + weight (optional, number) -  Вес услуги (используется для сортировки услуг при отображении)
        + comment: '' (optional, string) - Комментарий к услуге
        + price_min: 0 (optional, number) - Минимальная стоимость услуги
        + price_max: 0 (optional, number) - Максимальная стоимость услуги
        + discount: 0 (optional, number) - Скидка при оказании услуги
        + staff (optional, ServiceStaff) - Сотрудники, оказываюшие услугу и длительность оказания услуги каждым из них
        + image_group_id (optional, number) - Id группы изображений


  + Headers

            Authorization: Bearer partner_token, User user_token

  + Body

            {
                "title": "Мужская стрижка",
                "category_id": 83167,
                "price_min": 1300.00,
                "price_max": 1300.00,
                "discount": 0,
                "comment": "",
                "weight": 6,
                "active": 1,
                "api_id": "00000000042",
                "staff": [
                  {
                    "id": 5905,
                    "seance_length": 2700
                  },
                  {
                    "id": 5907,
                    "seance_length": 3600
                  },
                  {
                    "id": 8973,
                    "seance_length": 3600
                  },
                  {
                    "id": 13616,
                    "seance_length": 3600
                  },
                  {
                    "id": 16681,
                    "seance_length": 3600
                  },
                  {
                    "id": 1796",
                    "seance_length": 3600
                  },
                  {
                    "id": 34006,
                    "seance_length": 3600
                  }
                ]
            }


+ Response 201 (application/json)

        {
            "id": 83169,
            "title": "Мужская стрижка",
            "category_id": 83167,
            "price_min": 1300.00,
            "price_max": 1300.00,
            "discount": 0,
            "comment": "",
            "weight": 6,
            "active": 1,
            "api_id": "00000000042",
            "staff": [
              {
                "id": 5905,
                "seance_length": 2700
              },
              {
                "id": 5907,
                "seance_length": 3600
              },
              {
                "id": 8973,
                "seance_length": 3600
              },
              {
                "id": 13616,
                "seance_length": 3600
              },
              {
                "id": 16681,
                "seance_length": 3600
              },
              {
                "id": 1796,
                "seance_length": 3600
              },
              {
                "id": 34006,
                "seance_length": 3600
              }
            ]
          }


### Удалить услугу [DELETE]

+ Parameters

    + company_id (required, number) - ID компании
    + service_id (required, number) - ID услуги


+ Request (application/json)


  + Headers

            Authorization: Bearer partner_token, User user_token


+ Response 204 (application/json)


# Group Сотрудники

Для работы с сотрудниками используются следующие методы

Объект сотрудника имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор сотрудника  |
|  api_id  |  string\|null  |  Внешний идентификатор сотрудника  |
|  name  | string  |  Имя сотрудника  |
|  specialization  | string  |  Специализация сотрудника  |
|  weight  | number  |  Вес сотрудника. При выводе сотрудники сортируются по весу, сначала более тяжелые  |
|  show_rating  | number  |  Показывать ли рейтинг сотрудника (1 - показывать, 0 - не показывать)  |
|  rating  | number  |  Ретинг сотрудника  |
|  votes_count  | number  |  Кол-во голос, оценивших сотрудника  |
|  comments_count  | number  |  Кол-во комментариев к сотрунику  |
|  avatar  | string  |  Путь к файлу аватарки сотрудника  |
|  avatar_big  | string  |  Путь к файлу аватарки сотрудника в более высоком разрешении |
|  information  | string  |  Дополнительная информация о сотруднике (HTML формат)  |
|  hidden  | number  |  1 - скрыт от онлайн записей, 0 - не скрыт  |
|  fired  | number  |  1 - уволен, 0 - не уволен  |
|  status  | number  |  .......... |
|  image_group | object | Группа изображений сотрудника |



## Коллекция сотрудников [/staff/{company_id}/{staff_id}]

+ Параметр
    + company_id (required, number, `1`) - ID компании
    + staff_id (optional, number, `1`) - ID сотрудника

### Получить список сотрудников / конкретного сотрудника [GET]

+ Parameters

    + company_id (required, number) - ID компании
    + staff_id (optional, number) - ID сотрудника, если нужно работать с конкретным сотрудником.


+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token


+ Response 200 (application/json)

        [[
          {
            "id": "17969",
            "api_id": null,
            "name": "Василий",
            "specialization": "парикмахер",
            "show_rating": "0",
            "rating": "0",
            "votes_count": "0",
            "avatar": "https://yclients.com/uploads/masters/sm/20151018220924_4963.jpg",
            "avatar_big": "https://yclients.com/uploads/masters/norm/20151018220924_4963.jpg",
            "comments_count": "0",
            "weight": "10",
            "information": "<span><span><span>&nbsp;</span></span></span>",
            "hidden": "0",
            "fired": "0",
            "status": "0",
            "image_group": {
                "id": 72250,
                "entity": "master",
                "entity_id": 26427,
                "images": {
                  "sm": {
                    "id": "186817",
                    "path": "http://yclients.com/uploads/masters/sm/9/90/9041171cfdabe4c_20170327201442.jpeg",
                    "width": "100",
                    "height": "100",
                    "type": "jpeg",
                    "image_group_id": 72250,
                    "version": "sm"
                  },
                  "norm": {
                    "id": "186818",
                    "path": "http://yclients.com/uploads/masters/norm/a/aa/aa37b29b7eb322d_20170327201442.jpeg",
                    "width": "180",
                    "height": "220",
                    "type": "jpeg",
                    "image_group_id": 72250,
                    "version": "norm"
                  },
                  "origin": {
                    "id": "186819",
                    "path": "http://yclients.com/uploads/masters/origin/6/65/654dbeb4ea0bbc3_20170327201442.jpeg",
                    "width": "800",
                    "height": "600",
                    "type": "jpeg",
                    "image_group_id": 72250,
                    "version": "origin"
                  }
                }
          },
          {
            "id": "34006",
            "api_id": "42",
            "name": "Денис",
            "specialization": "парикмахер",
            "show_rating": "0",
            "rating": "0",
            "votes_count": "0",
            "avatar": "https://yclients.com/uploads/masters/sm/20151116091208_4369.jpg",
            "avatar_big": "https://yclients.com/uploads/masters/norm/20151116091208_4369.jpg",
            "comments_count": "0",
            "weight": "9",
            "information": "<span><span>&nbsp;</span></span>",
            "hidden": "0",
            "fired": "0",
            "status": "0",
            "image_group" : []
          },
          {
            "id": "13616",
            "api_id": null,
            "name": "Александр",
            "specialization": "парикмахер",
            "show_rating": "0",
            "rating": "4.76921",
            "votes_count": "0",
            "avatar": "https://yclients.com/uploads/masters/sm/20141112123913_5162.jpg",
            "avatar_big": "https://yclients.com/uploads/masters/norm/20141112123913_5162.jpg",
            "comments_count": "26",
            "weight": "8",
            "information": "<span><span><span>&nbsp;</span></span></span>",
            "hidden": "0",
            "fired": "0",
            "status": "0",
            "image_group" : []
          }
        ]


### Добавить нового сотрудника [POST /staff/{company_id}]

+ Parameters

    + company_id (required, number) - ID компании


+ Request (application/json)

  + Attributes

        + name: 'Лена Зубрович' (required, string) - Имя сотрудника
        + specialization: '' (required, string) - Специализация сотрудника
        + weight (optional, number) -  Вес сотрудника (используется для сортировки сотрудников при отображении)
        + information: '' (optional, string) - Информация о сотруднике
        + api_id: '' (optional, string) - Внешний идентификатор сотрудника
        + hidden: 0 (optional, number) - Показывать ли сотрудника при онлайн записи. 1 - показывать, 0 - не показывать.
        + fired: 0 (optional, number) - Уволен ли сотрудник. 1 - уволен, 0 - не уволен.
        + image_group_id (optional, number) - Id группы изображений


  + Headers

            Authorization: Bearer partner_token, User user_token

  + Body

            {
                "name": "Василий",
                "specialization": "парикмахер",
                "weight": 10,
                "information": "Стрижет методом трех рук",
                "api_id": "42",
                "hidden": 0,
                "fired": 0
            }


+ Response 201 (application/json)


          {
            "id": 17969,
            "api_id": "42",
            "name": "Василий",
            "specialization": "парикмахер",
            "show_rating": 0,
            "rating": 0,
            "votes_count": 0,
            "avatar": "https://yclients.com/uploads/masters/sm/20151018220924_4963.jpg",
            "avatar_big": "https://yclients.com/uploads/masters/norm/20151018220924_4963.jpg",
            "comments_count": 0,
            "weight": 10,
            "information": "<span><span><span>&nbsp;</span></span></span>",
            "hidden": 0,
            "fired": 0,
            "status": 0
          }


### Изменить сотрудника [PUT]

+ Parameters

    + company_id (required, number) - ID компании
    + staff_id (required, number) - ID сотрудника


+ Request (application/json)

  + Attributes

        + name: 'Лена Зубрович' (required, string) - Имя сотрудника
        + specialization: '' (optional, string) - Специализация сотрудника
        + weight (optional, number) -  Вес сотрудника (используется для сортировки сотрудников при отображении)
        + information: '' (optional, string) - Информация о сотруднике
        + api_id: '' (optional, string) - Внешний идентификатор сотрудника
        + hidden: 0 (optional, number) - Показывать ли сотрудника при онлайн записи. 1 - показывать, 0 - не показывать.
        + fired: 0 (optional, number) - Уволен ли сотрудник. 1 - уволен, 0 - не уволен.
        + image_group_id (optional, number) - Id группы изображений


  + Headers

            Authorization: Bearer partner_token, User user_token

  + Body

            {
                "name": "Василий",
                "specialization": "парикмахер",
                "weight": 10,
                "information": "Стрижет методом трех рук",
                "api_id": "42",
                "hidden": 0,
                "fired": 0
            }


+ Response 200 (application/json)


          {
            "id": 17969,
            "api_id": "42",
            "name": "Василий",
            "specialization": "парикмахер",
            "show_rating": 0,
            "rating": 0,
            "votes_count": 0,
            "avatar": "https://yclients.com/uploads/masters/sm/20151018220924_4963.jpg",
            "avatar_big": "https://yclients.com/uploads/masters/norm/20151018220924_4963.jpg",
            "comments_count": 0,
            "weight": 10,
            "information": "<span><span><span>&nbsp;</span></span></span>",
            "hidden": 0,
            "fired": 0,
            "status": 0
          }


### Удалить сотрудника [DELETE]

+ Parameters

    + company_id (required, number) - ID компании
    + staff_id (required, number) - ID сотрудника


+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token


+ Response 204 (application/json)



# Group Клиенты
Для работы с клиентами

## Коллекция клиентов [/clients/{company_id}{?fullname,phone,email,card,page,count,paid_min,paid_max}]

+ Параметр
    + company_id (required, number, `1`) - ID компании
    + page (number, `1`) - Номер страницы
    + count (number, `20`) - Количество клиентов на странице


#### Фильтрация клиентов
+ fullname:'Joh' (optional, string) - Имя (часть имени) для фильтрации клиентов
+ phone:'7916' (optional, string) - Телефон (часть номера) для фильтрации клиентов
+ email:'test@' (optional, string) - Email (часть) для фильтрации клиентов
+ card:'5663rt' (optional, string) - Card (часть) для фильтрации клиентов по номеру карты лояльности
+ paid_min:100 (optional, number) - Минимально оплачено в кассу, для фильтрации клиентов по сумме оплат
+ paid_max:0 (optional, number) - Максимально оплачено в кассу, для фильтрации клиентов по сумме оплат

### Получить список клиентов [GET]


+ Parameters

    + company_id (required, number) - ID компании
    + fullname:'Joh' (optional, string) - Имя (часть имени) для фильтрации клиентов
    + phone:'7916' (optional, string) - Телефон (часть номера) для фильтрации клиентов
    + email:'test@' (optional, string) - Email (часть) для фильтрации клиентов
    + paid_min:1 (optional, number) - Минимально оплачено в кассу, для фильтрации клиентов по сумме оплат
    + paid_max:1 (optional, number) - Максимально оплачено в кассу, для фильтрации клиентов по сумме оплат
    + page:1 (optional, number) - Номер страницы
    + count:20 (optional, number) - Количество клиентов на странице


+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token


+ Response 200 (application/json)

        {
            "count":8,
            "data":[
                {
                    "id":66,
                    "name":"Клиент",
                    "phone":"+79112345678",
                    "email":"asdfgh@g.com",
                    "categories":[
                    {
                        "id":3,
                        "title":"Черный список",
                        "color":"#0f0f0f"
                    },
                    {
                        "id":4,
                        "title":"VIP",
                        "color":"#e8d313"
                    }
                    ],
                    "sex_id":0,
                    "sex":"Неизвестно",
                    "discount":10,
                    "importance_id":3,
                    "importance":"Золото",
                    "card":"123456789",
                    "birth_date":"2011-08-12",
                    "comment":"тест",
                    "sms_check":1,
                    "sms_not":0,
                    "spent":71842,
                    "balance":0,
                    "visits":34
                },
                {
                    "id":16,
                    "name":"Юрий",
                    "phone":"+79112345679",
                    "email":"",
                    "categories":[],
                    "sex_id":0,
                    "sex":"Неизвестно",
                    "discount":0,
                    "importance_id":0,
                    "importance":"Без класса важности",
                    "card":"",
                    "birth_date":"1970-01-01",
                    "comment":"",
                    "sms_check":0,
                    "sms_not":0,
                    "spent":0,
                    "balance":0,
                    "visits":3
                }
            ]
        }

### Добавить клиента [POST]


+ Parameters

    + company_id (required, number) - ID компании


+ Request (application/json)

    + Attributes
        + name (required, string) - Имя клиента
        + phone (required, string) - Телефон клиента
        + email (optional, string) - Email клиента
        + sex_id: 1 (optional, number) - Пол клиента (1 - мужской, 2 - женский, 0 - не известен)
        + importance_id: 1 (optional, number) - Класс важности клиента (0 - нет, 1 - бронза, 2 - серебро, 3 - золото)
        + discount: 10 (optional, number) - Скидка клиента
        + card: '45681444' (optional, string) - Номер карты клиента
        + birth_date:'07-01-2000' (optional, string) - Дата рождения клиента (важен месяц и день)
        + comment:'капризный' (optional, string) - Комментарий
        + spent: 200 (optional, number) - Сколько потратил средств в компании на момент добавления
        + balance: 200 (optional, number) - Баланс клиента
        + sms_check (optional, number) - 1 - Поздравлять с Днем Рождения по SMS, 0 - не поздравлять
        + sms_not (optional, number) - 1 - Исключить клиента из SMS рассылок, 0 - не исключать
        + labels (optional, array) - Массив идентификаторов категорий клиента


    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
              "name": "Василий СОНов",
              "phone": "+79211234567",
              "email": "123456789@gmail.com",
              "sex_id": 1,
              "discount": 15,
              "importance_id": 1,
              "card": "555888666",
              "birth_date": "03-03-2000",
              "comment": "кидает понты",
              "sms_check": 0,
              "sms_not": 0,
              "spent": 1000,
              "balance": -200,
              "labels": [101,102]
            }

+ Response 201 (application/json)

        {
          "id": 1121412,
          "name": "Василий СОНов",
          "phone": "+79211234567",
          "email": "123456789@gmail.com",
          "categories": [],
          "sex": "Мужской",
          "sex_id": 1,
          "discount": 15,
          "importance_id": 1,
          "importance": "Бронза",
          "card": "555888666",
          "birth_date": "2000-03-03",
          "comment": "кидает понты",
          "sms_check": 0,
          "sms_not": 0,
          "spent": 1000,
          "balance": -1200,
          "visits": 0
        }

## Клиент [/client/{company_id}/{id}]

+ Параметры
    + company_id (required, number) - ID компании
    + id (required, number) - ID клиента

+ Parameters

    + company_id (required, number) - ID компании
    + id (required, number) - ID клиента

### Получить клиента [GET]

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

        {
            "id":16,
            "name":"Юрий",
            "phone":"+79112345679",
            "email":"",
            "categories":[],
            "sex":"Неизвестно",
            "discount":0,
            "importance":"Без класса важности",
            "card":"",
            "birth_date":"1970-01-01",
            "comment":"",
            "sms_check":0,
            "sms_not":0,
            "spent":0,
            "balance":0,
            "visits":3
        }

### Редактировать клиента [PUT]

+ Request (application/json)

  + Attributes
        + name (required, string) - Имя клиента
        + phone (required, string) - Телефон клиента
        + email (optional, string) - Email клиента
        + sex_id: 1 (optional, number) - Пол клиента (1 - мужской, 2 - женский, 0 - не известен)
        + importance_id: 1 (optional, number) - Класс важности клиента (0 - нет, 1 - бронза, 2 - серебро, 3 - золото)
        + discount: 10 (optional, number) - Скидка клиента
        + card: '45681444' (optional, string) - Номер карты клиента
        + birth_date:'07-01-2000' (optional, string) - Дата рождения клиента (важен месяц и день)
        + comment:'капризный' (optional, string) - Комментарий
        + spent: 200 (optional, number) - Сколько потратил средств в компании на момент добавления
        + balance: 200 (optional, number) - Баланс клиента
        + sms_check (optional, number) - 1 - Поздравлять с Днем Рождения по SMS, 0 - не поздравлять
        + sms_not (optional, number) - 1 - Исключить клиента из SMS рассылок, 0 - не исключать
        + labels (optional, array) - Массив идентификаторов категорий клиента

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
              "name": "Василий СОНов",
              "phone": "+79211234567",
              "email": "123456789@gmail.com",
              "sex_id": 1,
              "discount": 15,
              "importance_id": 1,
              "card": "555888666",
              "birth_date": "03-03-2000",
              "comment": "кидает понты",
              "sms_check": 0,
              "sms_not": 0,
              "spent": 1000,
              "balance": -200,
              "labels": [101,102]
            }

+ Response 200 (application/json)

        {
          "id": 1121412,
          "name": "Василий СОНов",
          "phone": "+79211234567",
          "email": "123456789@gmail.com",
          "categories": [],
          "sex": "Мужской",
          "sex_id": 1,
          "discount": 15,
          "importance_id": 1,
          "importance": "Бронза",
          "card": "555888666",
          "birth_date": "2000-03-03",
          "comment": "кидает понты",
          "sms_check": 0,
          "sms_not": 0,
          "spent": 1000,
          "balance": -1200,
          "visits": 0
        }

### Удалить клиента [DELETE]

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 204 (application/json)



# Group Сетевые клиенты
Для работы с клиентами

## Коллекция клиентов [/group/{group_id}/clients/{?phone}]

+ Параметр
    + group_id (required, number, `43877`) - Id сети салонов


#### Фильтрация клиентов
+ phone:'79997906882' (optional, string) - Телефон для фильтрации клиентов

### Получить сетевого клиента по номеру телефона. [GET]


+ Parameters

    + group_id (required, number) - ID сети салонов
    + phone:'79264037640' (required, string) - Телефон для фильтрации клиентов, обязательный параметр


+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token


+ Response 200 (application/json)

        {
            "success": true,
            "data": {
                "salon_group_id": 312,
                "phone": "79997906882",

                "clients": [
                    {
                        "id": 4240880,
                        "company_id": 4564,
                        "name": "lx",
                        "email": "portnov21@gmail.com"
                    },
                    {
                        "id": 4243272,
                        "company_id": 24697,
                        "name": "lx",
                        "email": "portnov21@gmail.com"
                    }
                ]
            },
            "meta": []
        }


# Group Записи
Для работы с записями

JSON-Объект записи содержит следующие поля:

| Поле | Тип | Обязательный | Описание |
| ------------- | ------------- | ------------- | ------------- |
| id  | number  | ДА  |  ID записи  |
| staff_id  | number  |  ДА  | (при сохранении записи) Id специалиста, которые был забронирован |
| services  | array  |  ДА  | Список параметров услуг записи (может быть пустой массив) |
| client  | object  |  ДА  |  Данные клиента (может быть пустой объект) |
| datetime  | string  |  ДА  |  Дата сеанса  |
| seance_length  | number  |  ДА  | Длительность сеанса  |
| save_if_busy  | boolean  |  ДА  | (Только для сохранения) Сохранять запись даже в случае наложения записей или нерабочего времени сотрудника  |
| send_sms  | boolean  |  ДА  |  (Только для создания) Отправить ли клиенту смс с деталями записи (если клиент указан)  |
| sms_remain_hours  | number  |  НЕТ  |  За сколько часов до визита клиенту отправить смс напоминание (0 - если не отправлять)  |
| email_remain_hours  | number  |  НЕТ  |  За сколько часов до визита клиенту отправить email напоминание (0 - если не отправлять)  |
| comment  | string  |  НЕТ  | Комментарий к записи  |
| master_requested  | boolean  |  НЕТ  | Был ли указан определенный специалист при записи (false если был указан "не имеет значения")  |
| attendance  | number  |  НЕТ  | 1 - Пользователь пришел, услуги оказаны, 0 - ожидание пользователя, -1 - пользователь не пришел на визит  |
| api_id  | string  |  НЕТ  | Внешний идентификатор записи  |
| deleted  | boolean  |  НЕТ  | (Только при чтении) Удалена ли запись (true если удалена)  |
| online  | boolean  |  НЕТ  | (Только при чтении) Запись онлайновая или нет (false если запись внес администратор)  |
| create_date  | string  |  ДА  | (Только при чтении) Дата создания записи  |
| custom_color  | string  |  НЕТ  |  Цвет записи в журнале  |
| custom_font_color  | string  |  НЕТ  | (Только при чтении) Цвет шрифта записи |
| record_labels  | array  |  НЕТ  |  Категории записи  |
| activity_id  | number  |  НЕТ  |  ID группового события  |

Массив services состоит из объектов, которые имеют следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор услуги  |
|  title  | string  |  (только при чтении) Название услуги  |
|  first_cost  | float  |  Начальная стоимость услуги (без учета скидок)  |
|  discount  | float  |  Скидка на услугу  |
|  cost  | float  |  Итоговая стоимость услуги |

Объект сlient имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  | (передается только при чтении) Идентификатор клиента  |
|  phone  | string  |  Телефон клиента  |
|  name  | string  |  Имя клиента  |
|  email  | string  |  Email клиента  |

Объект staff передается тольки при чтении записей/записи, и имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор сотрудника  |
|  name  | string  |  Имя сотрудника  |
|  specialization  | string  |  Специализация сотрудника  |
|  avatar  | string  |  Путь к файлу аватарки сотрудника  |

Массив record_labels состоит из объектов, которые имеют следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number  |  Идентификатор категории  |
|  title  | string  |   Название категории  |
|  color  | string  |  Цвет категории |
|  icon  | string  |  Иконка  |
|  font_color  | string  |  Цвет шрифта категории |

## Коллекция записей [/records/{company_id}{?page,count,staff_id,client_id,start_date,end_date,c_start_date,c_end_date,changed_after,changed_before,created_user_id}]

+ Параметр
    + company_id (required, number) - ID компании
    + page (number, `1`) - Номер страницы
    + count (number, `300`) - Количество записей на странице

### Получить список записей [GET]
#### Фильтрация записей
+ staff_id: ID сотрудника. Если нужны записи к конкретному сотруднику
+ client_id: ID клиента. Если нужны записи к конкретному клиенту
+ created_user_id: ID пользователя создавшего запись. Если нужны записи созданные конкретным пользователем
+ start_date: Дата сеанса начина с (фильтр по дате сеанса). Если нужны записи на сеанс начиная с конкретной даты
+ end_date: Дата сеанса по. Если нужны записи на сеанс до конкретной даты
+ c_start_date: Дата создания записи начиная с(фильтр по дате создания записи). Если нужны записи созданные начиная с конкретной даты
+ c_end_date: Дата создания записи по(фильтр по дате создания записи).
+ changed_after: Дата изменения/создания записи. Если нужны записи созданные/измененные начиная с конкретной даты и времени
+ changed_before: Дата изменения/создания записи. Если нужны записи созданные/измененные до конкретной даты и времени

+ Parameters

    + company_id (required, number) - ID компании
    + page:1 (optional, number) - Номер страницы
    + count:50 (optional, number) - Количество записей на странице
    + staff_id:7572 (optional, number) - ID сотрудника, если нужно только записи к конкретному сотруднику
    + client_id:572 (optional, number) - ID клиента. Если нужны записи к конкретному клиенту
    + created_user_id:7572 (optional, number) - ID пользователя создавшего запись. Если нужны записи созданные конкретным пользователем
    + start_date:`2016-02-23` (optional, string) - Дата сеанса начина с (фильтр по дате сеанса). Если нужны записи на сеанс начиная с конкретной даты
    + end_date:`2016-02-23` (optional, string) -  Дата сеанса по. Если нужны записи на сеанс до конкретной даты
    + c_start_date:`2016-02-23` (optional, string)  - Дата создания записи начиная с(фильтр по дате создания записи). Если нужны записи созданные начиная с конкретной даты
    + c_end_date:`2016-02-23` (optional, string) - Дата создания записи по(фильтр по дате создания записи).
    + changed_after:`2016-02-23T12:00:00` (optional, string)  - Дата изменения/создания записи. Если нужны записи созданные/измененные начиная с конкретной даты и времени
    + changed_before:`2016-02-23T12:00:00` (optional, string)  - Дата изменения/создания записи. Если нужны записи созданные/измененные до конкретной даты и времени

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token


+ Response 200 (application/json)

        {
            "count":10,
            "data":[
                {
                    "id":2,
                    "services":[],
                    "master":{
                        "id":9,
                        "name":"Оксана",
                        "spec":"наращивание волос"
                    },
                    "client": null,
                    "date":"2015-08-19 19:00:00",
                    "create_date":"2015-07-30 11:09:35",
                    "comment":"не записывать",
                    "visit_attendance":0,
                    "confirmed":1,
                    "length":3600,
                    "cost":0,
                    "sms_before":0,
                    "sms_now":0,
                    "sms_now_text":"",
                    "email_now":0,
                    "notified":0,
                    "partner_id":0,
                    "partner_record_id":"",
                    "coupon_id":0,
                    "sklad_number":0,
                    "master_request":0,
                    "api_id":"",
                    "ya_type":"",
                    "from_url":"",
                    "review_requested":0,
                    "GCal_id":"",
                    "documents": [
                        {
                          "id": 8172893,
                          "type_id": 7,
                          "storage_id": 0,
                          "user_id": 746310,
                          "company_id": 4564,
                          "number": 4163,
                          "comment": "",
                          "date_created": "2018-07-03 11:00:00",
                          "category_id": 0,
                          "visit_id": 3,
                          "record_id": 2,
                          "type_title": "Визит"
                        }
                    ]
                },
                {
                    "id":9,
                    "services":[
                        {
                            "id":84,
                            "title":"Плетение кос",
                            "cost":400
                        },
                        {
                            "id":86,
                            "title":"Детская стрижка (до 6 лет)",
                            "cost":700
                        }
                    ],
                    "master":{
                        "id":49,
                        "name":"Сергей",
                        "spec":"стилист"
                    },
                    "client":{
                        "id":700,
                        "name":"елена",
                        "phone":"+79170005555",
                        "email":""
                    },
                    "date":"2015-08-02 11:45:00",
                    "create_date":"2015-07-30 10:49:10",
                    "comment":"",
                    "visit_attendance":1,
                    "confirmed":1,
                    "length":10800,
                    "cost":0,
                    "sms_before":0,
                    "sms_now":0,
                    "sms_now_text":"",
                    "email_now":0,
                    "notified":0,
                    "partner_id":0,
                    "partner_record_id":"",
                    "coupon_id":0,
                    "sklad_number":0,
                    "master_request":1,
                    "api_id":"",
                    "ya_type":"",
                    "from_url":"",
                    "review_requested":0,
                    "GCal_id":"",
                    "deleted": 0,
                    "last_change_date": "2017-01-09T20:45:30+0900",
                    "custom_color": "f44336",
                    "custom_font_color": "#ffffff",
                    "record_labels": [
                        {
                          "id": "67345",
                          "title": "Сотрудник не важен",
                          "color": "#009800",
                          "icon": "unlock",
                          "font_color": "#ffffff"
                        },
                        {
                          "id": "104474",
                          "title": "важная категория",
                          "color": "#3b2c54",
                          "icon": "odnoklassniki",
                          "font_color": "#ffffff"
                        }
                    ],
                    "activity_id": 0,
                    "documents": [
                        {
                          "id": 8172893,
                          "type_id": 7,
                          "storage_id": 0,
                          "user_id": 746310,
                          "company_id": 4564,
                          "number": 4163,
                          "comment": "",
                          "date_created": "2018-07-03 11:00:00",
                          "category_id": 0,
                          "visit_id": 3,
                          "record_id": 2,
                          "type_title": "Визит"
                        }
                    ]
                }
            ]
        }

### Создать новую запись [POST]

Для групповых событий
При создании записи в групповом событии параметр activity_id становится обязательным,
параметры staff_id, services, datetime, seance_length становятся необязательными.

Дополнительные поля
При создании дополнительных полей записи(см. раздел "Дополнительные поля") становится возможным передавать собственные значения для полей.
Дополнительные поля уникальны для каждой компании. После создания дополнительных полей, их значения для конкретной записи могут
передаваться в необязательном поле custom_fields в виде пар ключ-значение где ключ это поле "code" дополнительного поля. Пример:

* Создали дополнительное поле записи с code="my_custom_field" type="number", и второе поле code="some_another_field" type="list"

* Передали при создании записи еще один атрибут:
custom_fields: {
    "my_custom_field": 123,
    "some_another_field": ["first value", "second value"]
}

* При получении данной записи методом GET впоследствии, это же значение дополнительных полей вернется в ответе



+ Parameters

    + company_id: 24699 (required, number) - ID компании

+ Request (application/json)

    + Attributes
        + staff_id (required, number) - ID сотрудника
        + services (required, ServiceArray) - Параметры услуг (id, стоимость, скидка)
        + client (required, Client) - Параметры клиента (телефон, имя, email)
        + datetime: `2015-12-12T12:00:00+04:00` (required, string) - Дата и время записи
        + seance_length: 3600 (required, number) - Длительность записи в секундах
        + save_if_busy: true (required, boolean) - Сохранять ли запись если время занято или нерабочее, или выдать ошибку
        + send_sms: true (required, boolean) - Отправлять ли смс с деталями записи клиенту
        + comment: 'убрать усы' (optional, string) - Комментарий к записи
        + sms_remain_hours: 2 (optional, number) - За сколько часов до визита следует выслать смс напоминание клиенту (0 - если не нужно)
        + email_remain_hours: 2 (optional, number) - За сколько часов до визита следует выслать email напоминание клиенту (0 - если не нужно)
        + api_id: 2 (optional, number) - ID записи из внешней системы
        + attendance (optional, number) - 1 - Пользователь пришел, услуги оказаны, 0 - ожидание пользователя, -1 - пользователь не пришел на визит
        + custom_color (optional, string) - Цвет записи
        + record_labels (optional, array) - Массив идентификаторов категорий записи
        + activity_id (optional, number) - ID группового события
        + custom_fields (optional, object) - Дополнительные поля записи

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

                {
                    "staff_id": 8886,
                    "services": [
                        {
                            "id":331,
                            "first_cost": 9000,
                            "discount": 50
                            "cost": 4500
                        },
                        {
                            "id":333,
                            "first_cost": 2000,
                            "discount": 10
                            "cost": 1800
                        }
                    ],
                    "client": {
                        "phone": "79169999900",
                        "name": "Дмитрий",
                        "email": "d@yclients.com",
                    },
                    "save_if_busy": false,
                    "datetime": "2015-12-12T12:00:00+04:00",
                    "seance_length": 3600,
                    "send_sms": true,
                    "comment": "тестовая запись!",
                    "sms_remain_hours": 6,
                    "email_remain_hours": 24,
                    "attendance": 1,
                    "api_id": "777",
                    "custom_color": "f44336",
                    "record_labels": [
                        "67345", "104474"
                    ],
                    "custom_fields": {
                        "my_custom_field": 123,
                        "some_another_field": ["first value", "second value"]
                    }
                }


+ Response 201 (application/json)

    + Attributes
        + id: 1 (required, number) - ID записи
        + staff (required, Staff) - Параметры сотрудника
        + services (required, ServiceArray) - Параметры услуг (id, стоимость, скидка)
        + client (required, Client) - Параметры клиента (телефон, имя, email)
        + datetime: `2015-12-12T12:00:00+04:00` (required, string) - Дата и время записи
        + seance_length: 3600 (required, number) - Длительность записи в секундах
        + comment: 'убрать усы' (optional, string) - Комментарий к записи
        + sms_remain_hours: 2 (optional, number) - За сколько часов до визита следует выслать смс напоминание клиенту (0 - если не нужно)
        + email_remain_hours: 2 (optional, number) - За сколько часов до визита следует выслать email напоминание клиенту (0 - если не нужно)
        + api_id: 2 (optional, number) - ID записи из внешней системы
        + attendance (optional, number) - 1 - Пользователь пришел, услуги оказаны, 0 - ожидание пользователя, -1 - пользователь не пришел на визит
        + custom_color (optional, string) - Цвет записи
        + record_labels (optional, array) - Массив идентификаторов категорий записи
        + documents (required, array[Document]) - Массив документов по записи

    + Body

                {
                    "id":999,
                    "services": [
                        {
                            "id":331,
                            "first_cost": 9000,
                            "discount": 50
                            "cost": 4500
                        },
                        {
                            "id":333,
                            "first_cost": 2000,
                            "discount": 10
                            "cost": 1800
                        }
                    ],
                    "client": {
                        "phone": "79169999900",
                        "name": "Дмитрий",
                        "email": "d@yclients.com",
                    },
                    "staff":{
                        "id":8886,
                        "name":"Сергей",
                        "spec":"стилист"
                    },
                    "datetime": "2015-12-12T12:00:00+04:00",
                    "seance_length": 3600,
                    "create_date":"2015-07-30 10:49:10",
                    "comment":"тестовая запись!",
                    "visit_attendance":1,
                    "confirmed":1,
                    "sms_before":6,
                    "sms_now":1,
                    "sms_now_text":"",
                    "email_now":1,
                    "notified":0,
                    "master_request":1,
                    "api_id":"",
                    "from_url":"",
                    "review_requested":0,
                    "custom_color": "f44336",
                    "custom_font_color": "#ffffff",
                    "record_labels": [
                    {
                      "id": "67345",
                      "title": "Сотрудник не важен",
                      "color": "#009800",
                      "icon": "unlock",
                      "font_color": "#ffffff"
                    },
                    {
                      "id": "104474",
                      "title": "интересная категория",
                      "color": "#3b2c54",
                      "icon": "odnoklassniki",
                      "font_color": "#ffffff"
                    }
                    ],
                    "documents": [
                        {
                          "id": 8172893,
                          "type_id": 7,
                          "storage_id": 0,
                          "user_id": 746310,
                          "company_id": 4564,
                          "number": 4163,
                          "comment": "",
                          "date_created": "2018-07-03 11:00:00",
                          "category_id": 0,
                          "visit_id": 3,
                          "record_id": 2,
                          "type_title": "Визит"
                        }
                    ]
                }

## Запись [/record/{company_id}/{record_id}]

+ Parameters
    + company_id (required, number) - ID компании
    + record_id (required, number) - ID записи


### Получить запись [GET]

+ Request (application/json)

  + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

        {
            "id":2,
            "services":[],
            "master":{
                "id":9,
                "name":"Оксана",
                "spec":"наращивание волос"
            },
            "client": null,
            "date":"2015-08-19 19:00:00",
            "create_date":"2015-07-30 11:09:35",
            "comment":"не записывать",
            "visit_attendance":0,
            "confirmed":1,
            "length":3600,
            "cost":0,
            "sms_before":0,
            "sms_now":0,
            "sms_now_text":"",
            "email_now":0,
            "notified":0,
            "partner_id":0,
            "partner_record_id":"",
            "coupon_id":0,
            "sklad_number":0,
            "master_request":0,
            "api_id":"",
            "ya_type":"",
            "from_url":"",
            "review_requested":0,
            "GCal_id":"",
            "last_change_date": "2017-01-09T20:45:30+0900",
            "custom_color": "f44336",
            "custom_font_color": "#ffffff",
            "record_labels": [
                {
                  "id": "67345",
                  "title": "Сотрудник не важен",
                  "color": "#009800",
                  "icon": "unlock",
                  "font_color": "#ffffff"
                },
                {
                  "id": "104474",
                  "title": "интересная категория",
                  "color": "#3b2c54",
                  "icon": "odnoklassniki",
                  "font_color": "#ffffff"
                }
            ],
            "activity_id": 0,
            "documents": [
                {
                  "id": 8172893,
                  "type_id": 7,
                  "storage_id": 0,
                  "user_id": 746310,
                  "company_id": 4564,
                  "number": 4163,
                  "comment": "",
                  "date_created": "2018-07-03 11:00:00",
                  "category_id": 0,
                  "visit_id": 3,
                  "record_id": 2,
                  "type_title": "Визит"
                }
            ]
        }

### Изменить запись [PUT]

При изменении записи в групповом событии параметр activity_id становится обязательным,
параметры staff_id, services, datetime, seance_length становятся необязательными

+ Request (application/json)

    + Attributes
        + staff_id (required, number) - ID сотрудника
        + services (required, ServiceArray) - Параметры услуг (id, стоимость, скидка)
        + client (required, Client) - Параметры клиента (телефон, имя, email)
        + datetime: `2015-12-12T12:00:00+04:00` (required, string) - Дата и время записи
        + seance_length: 3600 (required, number) - Длительность записи в секундах
        + save_if_busy: true (required, boolean) - Сохранять ли запись если время занято или нерабочее, или выдать ошибку
        + send_sms: true (required, boolean) - Отправлять ли смс с деталями записи клиенту
        + comment: 'убрать усы' (optional, string) - Комментарий к записи
        + sms_remain_hours: 2 (optional, number) - За сколько часов до визита следует выслать смс напоминание клиенту (0 - если не нужно)
        + email_remain_hours: 2 (optional, number) - За сколько часов до визита следует выслать email напоминание клиенту (0 - если не нужно)
        + api_id: 2 (optional, number) - ID записи из внешней системы
        + attendance (optional, number) - 1 - Пользователь пришел, услуги оказаны, 0 - ожидание пользователя, -1 - пользователь не пришел на визит
        + activity_id (optional, number) - ID группового события
        + fast_payment (optional, number) - Быстрая оплата 1 - наличными, 2 - безналичными, 129 - наличными и распечатать, 130 - безналичными и распечатать

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

                {
                    "staff_id": 8886,
                    "services": [
                        {
                            "id":331,
                            "first_cost": 9000,
                            "discount": 50
                            "cost": 4500
                        },
                        {
                            "id":333,
                            "first_cost": 2000,
                            "discount": 10
                            "cost": 1800
                        }
                    ],
                    "client": {
                        "phone": "79169999900",
                        "name": "Дмитрий",
                        "email": "d@yclients.com",
                    },
                    "save_if_busy": false,
                    "datetime": "2015-12-12T12:00:00+04:00",
                    "seance_length": 3600,
                    "send_sms": true,
                    "comment": "тестовая запись!",
                    "sms_remain_hours": 6,
                    "email_remain_hours": 24,
                    "attendance": 1,
                    "api_id": "777"
                }


+ Response 201 (application/json)

    + Attributes
        + id: 1 (required, number) - ID записи
        + staff (required, Staff) - Параметры сотрудника
        + services (required, ServiceArray) - Параметры услуг (id, стоимость, скидка)
        + client (required, Client) - Параметры клиента (телефон, имя, email)
        + datetime: `2015-12-12T12:00:00+04:00` (required, string) - Дата и время записи
        + seance_length: 3600 (required, number) - Длительность записи в секундах
        + comment: 'убрать усы' (optional, string) - Комментарий к записи
        + sms_remain_hours: 2 (optional, number) - За сколько часов до визита следует выслать смс напоминание клиенту (0 - если не нужно)
        + email_remain_hours: 2 (optional, number) - За сколько часов до визита следует выслать email напоминание клиенту (0 - если не нужно)
        + api_id: 2 (optional, number) - ID записи из внешней системы
        + attendance (optional, number) - 1 - Пользователь пришел, услуги оказаны, 0 - ожидание пользователя, -1 - пользователь не пришел на визит
        + documents (required, array[Document]) - Массив документов по записи

    + Body

                {
                    "id":999,
                    "services": [
                        {
                            "id":331,
                            "first_cost": 9000,
                            "discount": 50
                            "cost": 4500
                        },
                        {
                            "id":333,
                            "first_cost": 2000,
                            "discount": 10
                            "cost": 1800
                        }
                    ],
                    "client": {
                        "phone": "79169999900",
                        "name": "Дмитрий",
                        "email": "d@yclients.com",
                    },
                    "staff":{
                        "id":8886,
                        "name":"Сергей",
                        "spec":"стилист"
                    },
                    "datetime": "2015-12-12T12:00:00+04:00",
                    "seance_length": 3600,
                    "create_date":"2015-07-30 10:49:10",
                    "comment":"тестовая запись!",
                    "visit_attendance":1,
                    "confirmed":1,
                    "sms_before":6,
                    "sms_now":1,
                    "sms_now_text":"",
                    "email_now":1,
                    "notified":0,
                    "master_request":1,
                    "api_id":"",
                    "from_url":"",
                    "review_requested":0,
                    "activity_id": 0,
                    "documents": [
                        {
                          "id": 8172893,
                          "type_id": 7,
                          "storage_id": 0,
                          "user_id": 746310,
                          "company_id": 4564,
                          "number": 4163,
                          "comment": "",
                          "date_created": "2018-07-03 11:00:00",
                          "category_id": 0,
                          "visit_id": 3,
                          "record_id": 2,
                          "type_title": "Визит"
                        }
                    ]
                }

### Удалить запись [DELETE]


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

+ Response 204 (application/json)


# Group Визиты

Для работы с визитами

## Получить визит [GET /visits/{visit_id}]

+ Parameters
    + visit_id: ID визита (number)

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "attendance": 1,
                "datetime": "2018-03-25T15:00:00+04:00",
                "comment": 0,
                "records": [
                    {
                        "id": 37955315,
                        "company_id": 4564,
                        "staff_id": 55436,
                        "services": [],
                        "events": [],
                        "goods_transactions": [],
                        "staff": {
                            "id": 55436,
                            "name": "Кевин Спейси",
                            "specialization": "Мастер маникюра и педикюраf",
                            "avatar": "http://dev9.dev.salonpicker.ru/uploads/masters/sm/b/bb/bb59d4cc17d9b16_20171215174158.png",
                            "avatar_big": "http://dev9.dev.salonpicker.ru/uploads/masters/origin/c/cf/cfb8c5cee58000b_20171215174158.png",
                            "rating": 4.89,
                            "votes_count": 0
                        },
                        "client": {
                            "id": 4240788,
                            "name": "dev1",
                            "phone": "+71000000001",
                            "card": "000000415",
                            "email": "",
                            "success_visits_count": 58,
                            "fail_visits_count": 9
                        },
                        "date": "2018-03-25 15:00:00",
                        "datetime": "2018-03-25T15:00:00+03:00",
                        "create_date": "2018-03-22T17:55:14+0300",
                        "comment": "",
                        "online": false,
                        "visit_attendance": 1,
                        "attendance": 1,
                        "confirmed": 1,
                        "seance_length": 3600,
                        "length": 3600,
                        "sms_before": 1,
                        "sms_now": 1,
                        "sms_now_text": "",
                        "email_now": 1,
                        "notified": 0,
                        "master_request": 0,
                        "api_id": "0",
                        "from_url": "",
                        "review_requested": 0,
                        "visit_id": 8260852,
                        "created_user_id": 999290,
                        "deleted": 0,
                        "paid_full": 0,
                        "prepaid": 0,
                        "prepaid_confirmed": 0,
                        "last_change_date": "2018-03-28T17:46:48+0300",
                        "custom_color": "",
                        "custom_font_color": "",
                        "record_labels": [],
                        "activity_id": 0,
                        "custom_fields": [],
                        "documents": [
                            {
                              "id": 8172893,
                              "type_id": 7,
                              "storage_id": 0,
                              "user_id": 746310,
                              "company_id": 4564,
                              "number": 4163,
                              "comment": "",
                              "date_created": "2018-07-03 11:00:00",
                              "category_id": 0,
                              "visit_id": 3,
                              "record_id": 2,
                              "type_title": "Визит"
                            }
                        ]
                    }
                ]
            }


## Получить детали визита [GET /visit/details/{salon_id}/{record_id}/{visit_id}]

**Блок "kkm_transaction_details_container"**

Флаг  "last_operation_type"

| Значение  | Описание |
| ------------- | ------------- |
|  0  | Распечатать чек возврата |
|  1  | Распечатать чек продажи |

Типы всех операций c ККМ

| Значение  | Описание |
| ------------- | ------------- |
|  0  | Операция продажи  (активна для документа с типом "Визит") |
|  1  | Операция возврата продажи (активна для документа с типом "Визит") |
|  2  | Операция коррекции |
|  4  | Операция открытия смены |
|  5  | Операция закрытия смены |
|  9  | Операция получения статуса ККМ  |
|  11  | Операция получения статуса команды ККМ |
|  12  | Операция коррекции |
|  13  | Печать X-отчёта |
|  6  | Внесение наличных |
|  7  | Изъятие наличных |

Статусы всех операций с ККМ

| Значение  | Описание |
| ------------- | ------------- |
|  0  | Ошибка соединения с KKM |
|  1  | Успешно |
|  2  | Отправлен на печать |
|  3  | Ошибка выполнения |
|  4  | Ошибка проверки статуса |
|  5  | Ожидание готовности KKM  |

Типы документов

| Значение  | Описание |
| ------------- | ------------- |
|  1  | Продажа товара |
|  2  | Оказание услуг |
|  3  | Приход товара |
|  4  | Списание товара |
|  5  | Движение товара |
|  6  | Инвентаризация  |
|  7  | Визит |
|  8  | Списание расходников |

+ Parameters
    + salon_id: ID филиала (number)
    + record_id: ID записи (number)
    + visit_id: ID визита (number)

+ Request (application/json)

    + Headers

            Authorization: Bearer access_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "payment_transactions": [
                    {
                        "id": 6023813,
                        "document_id": 8172806,
                        "date": "2018-06-21 17:15:00",
                        "type_id": 5,
                        "expense_id": 5,
                        "account_id": 32299,
                        "amount": 10,
                        "client_id": 4241492,
                        "master_id": 0,
                        "supplier_id": 0,
                        "comment": "",
                        "item_id": 1162679,
                        "target_type_id": 1,
                        "record_id": 13136569,
                        "goods_transaction_id": 0,
                        "expense": {
                            "id": 5,
                            "title": "Оказание услуг"
                        },
                        "account": {
                            "id": 32299,
                            "title": "Депозиты (оплата наличными)"
                        },
                        "client": {
                            "id": "4241492",
                            "name": "ModulKassaClient",
                            "phone": "71001001011"
                        },
                        "master": [],
                        "supplier": []
                    }
                ],
                "loyalty_transactions": [
                    {
                        "id": 10614,
                        "status_id": 1,
                        "amount": 0.5,
                        "type_id": 2,
                        "program_id": 145,
                        "card_id": 20013,
                        "salon_group_id": 646,
                        "item_id": 0,
                        "item_type_id": 0,
                        "item_record_id": 0,
                        "goods_transaction_id": 0,
                        "is_discount": false,
                        "is_loyalty_withdraw": false,
                        "type": {
                            "id": 2,
                            "title": "Начисление по программам лояльности"
                        }
                    }
                ],
                "kkm_transaction_details_container": {
                    "last_operation_type": 0,
                    "transactions": [
                        {
                            "id": 1047,
                            "print_date": "2018-06-25 00:45:31",
                            "printed_count": 1,
                            "sum": 13,
                            "type": {
                                "id": 0,
                                "title": "Операция продажи"
                            },
                            "status": {
                                "id": 1,
                                "title": "Успешно"
                            },
                            "document": {
                                "id": 2045,
                                "type": 7,
                                "type_title": "Визит"
                            },
                            "cashier": {
                                "id": 746310,
                                "name": "Андрей Панов"
                            }
                        }
                    ]
                },
                "items": [
                    {
                        "id": 0,
                        "item_id": 1162679,
                        "item_type_id": 1,
                        "record_id": 13136569,
                        "item_title": "Стрижка у ТОП-мастера",
                        "amount": 2,
                        "first_cost": 20,
                        "manual_cost": 10,
                        "discount": 50,
                        "cost": 10,
                        "master_id": 13136569,
                        "good_id": 0,
                        "service_id": 1162679,
                        "event_id": 0,
                        "is_service": true,
                        "is_event": false,
                        "is_good": false
                    }
                ]
            }

## Изменить визит [PUT /visits/{visit_id}/{record_id}]

+ Parameters
    + visit_id: ID визита (number)
    + record_id: ID запись (number)

+ Attributes
    + comment (required, string) - Коментарий
    + attendance (required, number) - 1 - Пользователь пришел, услуги оказаны, 0 - ожидание пользователя, -1 - пользователь не пришел на визит
    + services (optional, ServiceArray) - Параметры услуг (id, стоимость, скидка)
    + goods_transactions (optional, GoodsTransactionsArray) - Параметры транзакции
    + new_transactions (optional, newTransactionsArray) - Параметры транзакции
    + deleted_transaction_ids (optional, number) - Массив id экземпляров
    + fast_payment (optional, number) - Быстрая оплата 1 - наличными, 2 - безналичными, 129 - наличными и распечатать, 130 - безналичными и распечатать

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
              "attendance": 1,
              "comment": "",
              "new_transactions": [
                {
                  "id": 1482145166353,
                  "amount": 100,
                  "account_id": 23322
                }
              ],
              "deleted_transaction_ids": [],
              "goods_transactions": [
                {
                  "id": "2168657",
                  "title": "Vital Creme Shampoo Plus",
                  "barcode": "123",
                  "article": "120277",
                  "amount": "-1.000000000",
                  "cost_per_unit": "15.00",
                  "price": "15.00",
                  "cost": "12.00",
                  "operation_unit_type": 2,
                  "master_id": "55436",
                  "storage_id": "91303",
                  "good_id": "232658",
                  "discount": "20.0"
                }
              ],
              "services": [
                {
                  "id": 389045,
                  "title": "Массаж рук (10 мин)",
                  "cost": 255,
                  "cost_per_unit": 300,
                  "discount": 15,
                  "first_cost": 300,
                  "record_id": 10403702
                }
              ]
            }


+ Response 200 (application/json)


## Чек PDF по визиту [GET /attendance/receipt_print/{visit_id}]

+ Parameters
    + visit_id: ID визита (number)

+ Request
    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/pdf)


# Group Групповые события

Для управлениями групповыми событиями используются следующие методы

## Групповые события [/activity/{company_id}]
### Создание группового события [POST /activity/{company_id}]

+ Parameters
    + company_id (required, number) - ID компании

+ Attributes
    + date (required, string) - дата и время
    + service_id (required, number) - ID услуги
    + staff_id (required, number) - ID мастера
    + resource_instance_ids (optional) - массив id экземпляров ресурсов
    + length (optional, number) - длительность события в секундах
    + force (required, boolean) - игнорировать ошибки (занятость мастера/ресурсов и тп)

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                "date": "2017-10-10 15:30",
                "service_id": 1185299,
                "staff_id": 26427,
                "capacity": 9,
                "resource_instance_ids": [3127],
                "force": false
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 108,
                    "salon_id": 4564,
                    "service_id": 1185299,
                    "staff_id": 26427,
                    "date": "2017-10-10 15:30:00",
                    "length": 3600,
                    "capacity": 9,
                    "records_count": 0,
                    "color": "",
                    "font_color": "",
                    "service": {
                        "id": 1185299,
                        "title": "Групповой маникюр",
                        "category_id": 754917
                    },
                    "staff": {
                        "id": 26427,
                        "name": "Моника Белуччи",
                        "company_id": 4564
                    },
                    "resource_instances": [
                        {
                            "id": 3127,
                            "title": "Машинка для маникюра #1",
                            "resource_id": 1364
                        }
                    ]
                },
                "meta": []
            }


### Обновление группового события [PUT /activity/{company_id}/{activity_id}]

+ Parameters
    + company_id (required, number) - ID компании
    + activity_id (required, number) - ID группового события

+ Attributes
    + date (required, string) - дата и время
    + service_id (required, number) - ID услуги
    + staff_id (required, number) - ID мастера
    + resource_instance_ids (optional) - массив id экземпляров ресурсов
    + length (optional, number) - длительность события в секундах
    + force (required, boolean) - игнорировать ошибки (занятость мастера/ресурсов и тд)

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                "date": "2017-10-10 15:30",
                "service_id": 1185299,
                "staff_id": 26427,
                "capacity": 9,
                "resource_instance_ids": [3127],
                "force": false
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 108,
                    "salon_id": 4564,
                    "service_id": 1185299,
                    "staff_id": 26427,
                    "date": "2017-10-10 15:30:00",
                    "length": 3600,
                    "capacity": 9,
                    "records_count": 0,
                    "color": "",
                    "font_color": "",
                    "service": {
                        "id": 1185299,
                        "title": "Групповой маникюр",
                        "category_id": 754917
                    },
                    "staff": {
                        "id": 26427,
                        "name": "Моника Белуччи",
                        "company_id": 4564
                    },
                    "resource_instances": [
                        {
                            "id": 3127,
                            "title": "Машинка для маникюра #1",
                            "resource_id": 1364
                        }
                    ]
                },
                "meta": []
            }

### Удаление групповой записи [DELETE /activity/{company_id}/{activity_id}]

+ Parameters
    + company_id (required, number) - ID компании
    + activity_id (required, number) - ID групповой записи

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 202 (application/json)

    + Body

            {
                "success": true,
                "data": null,
                "meta": {
                    "message": "Accepted"
                }
            }


### Чтение групповой записи [GET /activity/{company_id}/{activity_id}]

+ Parameters
    + company_id (required, number) - ID компании
    + activity_id (required, number) - ID групповой записи

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 108,
                    "salon_id": 4564,
                    "service_id": 1185299,
                    "staff_id": 26427,
                    "date": "2017-10-10 15:30:00",
                    "length": 3600,
                    "capacity": 9,
                    "records_count": 0,
                    "color": "",
                    "font_color": "",
                    "service": {
                        "id": 1185299,
                        "title": "Групповой маникюр",
                        "category_id": 754917
                    },
                    "staff": {
                        "id": 26427,
                        "name": "Моника Белуччи",
                        "company_id": 4564
                    },
                    "resource_instances": [
                        {
                            "id": 3127,
                            "title": "Машинка для маникюра #1",
                            "resource_id": 1364
                        }
                    ]
                },
                "meta": []
            }

### Поиск групповых записей [GET /activity/{company_id}/search/{?from,till}]

+ Parameters
    + company_id (required, number) - ID компании
    + from (required, string) - дата начала поиска (формат ГГГГ-ММ-ДД)
    + till (required, string) - дата окончания поиска (формат ГГГГ-ММ-ДД)

+ Attributes
    + staff_id (optional, number) - ID мастера
    + service_id (optional, number) - ID услуги
    + count (optional, number) - количество событий на страницу результата (default 25, max 300)
    + page (optional, number) - страница выдачи результата (начиная с 1)

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": [
                    {
                        "id": 108,
                        "salon_id": 4564,
                        "service_id": 1185299,
                        "staff_id": 26427,
                        "date": "2017-10-10 15:30:00",
                        "timestamp": 1507635000,
                        "length": 3600,
                        "capacity": 9,
                        "records_count": 0,
                        "color": "",
                        "font_color": "",
                        "service": {
                            "id": 1185299,
                            "title": "Групповой маникюр",
                            "category_id": 754917
                        },
                        "staff": {
                            "id": 26427,
                            "name": "Моника Белуччи",
                            "company_id": 4564
                        },
                        "resource_instances": [
                            {
                                "id": 3127,
                                "title": "Машинка для маникюра #1",
                                "resource_id": 1364
                            }
                        ]
                    }
                ],
                "meta": [
                    "count": 1
                ]
            }

### Поиск дат групповых записей [GET /activity/{company_id}/search_dates/{?from,till}]

+ Parameters
    + company_id (required, number) - ID компании
    + from (required, string) - дата начала поиска (формат ГГГГ-ММ-ДД)
    + till (required, string) - дата окончания поиска (формат ГГГГ-ММ-ДД)

+ Attributes
    + staff_id (optional, number) - ID мастера
    + service_id (optional, number) - ID услуги

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": [
                    "2017-09-15",
                    "2017-09-18",
                    "2017-09-20",
                    "2017-09-24",
                    "2017-09-25",
                    "2017-09-27",
                    "2017-09-21",
                    "2017-09-23",
                    "2017-09-29",
                    "2017-09-22",
                    "2017-10-09",
                    "2017-10-10"
                ],
                "meta": []
            }



# Group Расписание работы сотрудника
график работы сотрудника

Расписание сотрудника передается в виде массива объектов, каждый из которых имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  date  |  string  |  Дата, на которую необходимо установить расписание  |
|  is_working  | boolean  |  true, если сотрудник работает в этот день. false, если не работает и существующие расписание нужно удалить  |
|  slots  | array  |  Массив содержащий промежутки рабочего времени сотрудника. (Может быть пустым если is_working = false)   |

Массив slots состоит из объектов, содержащих следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  from  |  string  |  Время начала рабочего промежутка сотрудника. Например "11:00" или "10:30"  |
|  to  | string  |  Время окончания рабочего промежутка сотрудника. Например "18:00" или "19:45"  |


## Коллекция расписание сотрудника [/schedule/{company_id}/{staff_id}]

+ Parameters
    + company_id (required, number) - ID компании
    + staff_id (required, number) - ID сотрудника


### Изменить расписание работы сотрудника [PUT]


+ Request (application/json)

    + Attributes
        + date (required, string) - Дата
        + is_working (required, boolean) - Рабочая дата или нет
        + slots (required, array) - Массив (from, to) промежутков рабочего времени

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

               [
                    {
                        "date": "2016-02-05",
                        "is_working": true,
                        "slots" : [
                            {
                                "from" : "10:00",
                                "to" : "14:30"
                            },
                            {
                                "from" : "15:00",
                                "to" : "22:00"
                            }
                            ]
                    },
                    {
                        "date": "2016-02-04",
                        "is_working": true,
                        "slots" : [
                            {
                                "from" : "10:00",
                                "to" : "14:00"
                            },
                            {
                                "from" : "15:00",
                                "to" : "23:15"
                            }
                            ]
                    }
                ]


+ Response 201 (application/json)

### Получить расписание сотрудника [GET]

+ Parameters

    + company_id (required, number) - ID компании
    + staff_id (required, number) - ID сотрудника.
    + start_date:'' (required, number) -  Дата начала периода
    + end_date:'' (required, number) - Дата окончания периода

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Attributes
        + date (required, string) - дата в формате iso8601.
        + is_working (required, boolean) - Свободно время или нет.
        + slots (array) - Массив (from, to) промежутков рабочего времени.
        
    + Body

               [
                    {
                        "date": "2016-02-04",
                        "is_working": 1,
                        "slots" : [
                            {
                                "from" : "10:00",
                                "to" : "14:00"
                            },
                            {
                                "from" : "15:00",
                                "to" : "23:15"
                            }
                            ]
                    },
                    {
                        "date": "2016-02-05",
                        "is_working": 1,
                        "slots" : [
                            {
                                "from" : "10:00",
                                "to" : "14:30"
                            },
                            {
                                "from" : "15:00",
                                "to" : "22:10"
                            }
                            ]
                    },
                    {
                        "date": "2016-02-06",
                        "is_working": 0,
                        "slots": []
                    },
                    {
                        "date": "2016-02-07",
                        "is_working": 1,
                        "slots" : [
                            {
                                "from" : "10:00",
                                "to" : "14:00"
                            },
                            {
                                "from" : "15:00",
                                "to" : "22:00"
                            }
                            ]
                    }
                ]
                
                
                
# Group Даты для журнала
Для выбора дат в журнале записи

## Коллекция дат для журнала [/timetable/dates/{company_id}/{date}{?staff_id}]

Даты для журнала представляют из себя массив с датами. (например ["2015-10-26", "2015-10-30"]).

Для получения дат нужно передать дату, относительно которой будут получен список рабочих дат салона/сотрудника.


### Получить список дат для журнала [GET]


+ Parameters

    + company_id (required, number) - ID компании
    + date (required, string) - дата в формате iso8601.
        Фильтр по дате бронирования (например '2015-09-30')
    + staff_id (optional, number) - ID сотрудника.

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)


    + Body

            [
              "2015-10-26",
              "2015-10-30",
              "2015-10-31",
              "2015-11-01",
              "2015-11-02",
              "2015-11-13",
              "2015-11-20"
            ]



# Group Сеансы для журнала
Для выбора сеансов в журнале записи

## Коллекция сеансов для журнала [/timetable/seances/{company_id}/{staff_id}/{date}]
Объект сеансы для журнала имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  time  |  string   | Время сеанса (17:30 например)   |
|  free  | boolean  | Свободно время или занято  |


### Получить список сеансов для журнала [GET]


+ Parameters

    + company_id (required, number) - ID компании
    + date (required, string) - дата в формате iso8601.
        Фильтр по дате бронирования (например '2015-09-30')
    + staff_id (required, number) - ID сотрудника.

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)


    + Attributes
        + time (required, string) - Время сеанса
        + free (required, boolean) - Свободно время или нет


    + Body

            [
              {
                "time": "10:00",
                "is_free": true
              },
              {
                "time": "10:15",
                "is_free": true
              },
              {
                "time": "10:30",
                "is_free": true
              },
              {
                "time": "10:45",
                "is_free": true
              },
              {
                "time": "11:00",
                "is_free": false
              },
              {
                "time": "11:15",
                "is_free": false
              },
              {
                "time": "11:30",
                "is_free": false
              },
              {
                "time": "11:45",
                "is_free": false
              },
              {
                "time": "12:00",
                "is_free": false
              },
              {
                "time": "12:15",
                "is_free": false
              },
              {
                "time": "12:30",
                "is_free": false
              },
              {
                "time": "12:45",
                "is_free": false
              },
              {
                "time": "13:00",
                "is_free": true
              },
              {
                "time": "13:15",
                "is_free": true
              },
              {
                "time": "13:30",
                "is_free": true
              },
              {
                "time": "13:45",
                "is_free": true
              },
              {
                "time": "14:00",
                "is_free": true
              },
              {
                "time": "14:15",
                "is_free": true
              },
              {
                "time": "14:30",
                "is_free": true
              },
              {
                "time": "14:45",
                "is_free": true
              },
              {
                "time": "15:00",
                "is_free": true
              },
              {
                "time": "15:15",
                "is_free": true
              },
              {
                "time": "15:30",
                "is_free": true
              },
              {
                "time": "15:45",
                "is_free": true
              },
              {
                "time": "16:00",
                "is_free": true
              },
              {
                "time": "16:15",
                "is_free": true
              },
              {
                "time": "16:30",
                "is_free": false
              },
              {
                "time": "16:45",
                "is_free": false
              },
              {
                "time": "17:00",
                "is_free": false
              }
            ]


# Group Комментарии
Комментарии пользователей к компаниии и сотрудникам

## Коллекция комментариев [/comments/{company_id}/{staff_id}/{comment_id}{?staff,start_date,end_date,rating}]

Объект комментарии имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number   | Id комментария   |
|  type  | number  | 1 - комментарий к мастеру, 0 - к салону  |
|  master_id  | number  | ID мастера, если type = 1  |
|  text  | string  | Текст комментария |
|  date  | string  | Дата, когда был оставлен комментарий |
|  rating  | number  | Оценка ( от 1 до 5) |
|  user_id  | number  | Id пользователя, оставившего комментарий |
|  user_name  | string  | Имя пользователя, оставившего комментарий |
|  user_avatar  | string  | Аватар пользователя, оставившего комментарий |


### Получить комментарии [GET]


+ Parameters

    + company_id (required, number) - ID компании
    + start_date (optional, string) - дата в формате iso8601.
        Фильтр по дате с (например '2015-09-30')
    + end_date (optional, string) - дата в формате iso8601.
        Фильтр по дате по (например '2015-09-30')
    + staff (optional, number) - ID сотрудника
    + rating (optional, number) - Оценка в рейтинге. Фильтр по отзывам с конкретной оценкой.

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)


    + Body

            [
              {
                "type": "1",
                "master_id": "8864",
                "id": "18437",
                "text": "Отлично!",
                "date": "2015-08-03 20:31:05",
                "rating": "4",
                "user_id": "157169",
                "user_name": "Виктор Ситников",
                "user_avatar": "/images/no-master.png"
              },
              {
                "type": "0",
                "master_id": "0",
                "id": "20314",
                "text": "COOL",
                "date": "2015-07-24 11:00:00",
                "rating": "5",
                "user_id": "81846",
                "user_name": null,
                "user_avatar": "/images/no-master.png"
              }
            ]

### Оставить комментарии [POST /comments/{company_id}/{staff_id}]


+ Parameters

    + company_id (required, number) - ID компании
    + staff_id (optional, number) - ID сотрудника, указывать при создании отзыва к сотруднику

+ Request (application/json)

    + Attributes
        + mark (required, number) - Оценка от 1 до 5
        + text (required, string) - Текст отзыва
        + name (required, string) - Имя пользователя, которое будет отображено на странице с отзывами


    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                 "mark" : "4",
                 "text" : "Все очень плохо!",
                 "name" : "Виктор"
            }

+ Response 201 (application/json)

    + Body

            {
                "type": "1",
                "master_id": "8864",
                "id": "18437",
                "text": "Все очень плохо!",
                "date": "2016-05-23 20:31:05",
                "rating": "4",
                "user_id": "157169",
                "user_name": "Виктор",
                "user_avatar": "/images/no-master.png"
            }


### Редактировать комментарии [PUT]


+ Parameters

    + company_id (required, number) - ID компании
    + staff_id (optional, number) - ID сотрудника, указывать при создании отзыва к сотруднику
    + comment_id (required, number) - ID отзыва/комментария

+ Request (application/json)

    + Attributes
        + mark (required, number) - Оценка от 1 до 5
        + text (required, string) - Текст отзыва
        + name (required, string) - Имя пользователя, которое будет отображено на странице с отзывами


    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                 "mark" : "5",
                 "text" : "Все очень не плохо!",
                 "name" : "Виктор"
            }

+ Response 200 (application/json)

    + Body

            {
                "type": "1",
                "master_id": "8864",
                "id": "18437",
                "text": "Все очень не плохо!",
                "date": "2016-05-23 20:31:05",
                "rating": "5",
                "user_id": "157169",
                "user_name": "Виктор",
                "user_avatar": "/images/no-master.png"
            }

### Удалить комментарии [DELETE]


+ Parameters

    + company_id (required, number) - ID компании
    + staff_id (optional, number) - ID сотрудника, указывать при создании отзыва к сотруднику
    + comment_id (required, number) - ID отзыва/комментария

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 204 (application/json)




# Group Пользователи компании
Пользователи, имеющие доступ к управлению определенной компанией

## Коллекция пользователей [/company_users/{company_id}]

Объект пользователь компании имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number   | Id пользователя   |
|  firstname  | string  | Имя пользователя  |
|  login  | string  | login пользователя для авторизации в системе (для авторизации так же можно в качестве логина поля phone и email) |
|  email  | string  | Почтовый адрес пользователя |
|  phone  | string  | Телефон пользоватя |
|  access  | object  | Объект прав доступа пользоватей к модулям системы |

Объект access имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  stat_access  |  number   | 1 - есть доступ к просмотру статистики, 0 - нет доступа   |
|  schedule_edit_access  | number  | 1 - есть доступ к редактированию расписания сотрудника, 0 - нет доступа |
|  client_phones_access  | number  |  1 - есть доступ к просмотру телефонов клиентов, 0 - нет доступа |
|  clients_access  | number  |  1 - есть доступ к клиентской базе, 0 - нет доступа |
|  settings_access  | number  |  1 - есть доступ к настройкам, 0 - нет доступа |
|  create_records_access  | number  |  1 - есть доступ к созданию записей, 0 - нет доступа |
|  edit_records_access  | number  |  1 - есть доступ к редактированию записей, 0 - нет доступа |
|  timetable_access  |  number   |  1 - есть доступ к журналу записи, 0 - нет доступа  |
|  timetable_phones_access  |  number   |  1 - есть доступ к номеру телефона в журнале записи, 0 - нет доступа  |
|  last_days_count  |  number   |  -1 - есть доступ ко всей истории расписания и записей в журнале записи, >= 0 - доступ к истории расписания и записей за указанное количество дней прошлое |
|  finances_edit_last_days_count  |  number   |  -1 - есть доступ к редактированию транзакций записей за все время, >= 0 - доступ к редактированию транзакций записей за указанное количество дней дней прошлое |
|  records_finances_last_days_count  |  number   |  -1 - есть доступ к проведению оплаты в записях за все время, >= 0 - доступ к проведению оплаты в записях за указанное количество дней дней прошлое |
|  dash_records_last_days_count  |  number   |  -1 - есть доступ к просмотру списка записей за все время, >= 0 - доступ к просмотру списка записей за указанное количество дней дней прошлое |
|  services_edit  | number  |  1 - есть доступ к редактированию услуг, 0 - нет доступа |
|  services_delete  | number  |  1 - есть доступ к удалению услуг, 0 - нет доступа |
|  master_edit  | number  |  1 - есть доступ к редактированию персонала, 0 - нет доступа |
|  master_delete  | number  |  1 - есть доступ к удалению персонала, 0 - нет доступа |
|  schedule_edit  | number  |  1 - есть доступ к редактированию графика работы, 0 - нет доступа |
|  records_services_cost_access  | number  |  1 - есть доступ к редактированию стоимости услуг в окне записи, 0 - нет доступа |
|  records_services_discount_access  | number  |  1 - есть доступ к редактированию скидки на услуги в окне записи, 0 - нет доступа |
|  records_goods_cost_access  | number  |  1 - есть доступ к редактированию стоимости товаров в окне записи, 0 - нет доступа |
|  records_goods_discount_access  | number  |  1 - есть доступ к редактированию скидки на товары в окне записи, 0 - нет доступа |
|  edit_records_attendance_access  | number  |  1 - есть доступ к редактированию записей со статусом визита "клиент пришел", 0 - нет доступа |
|  billing_access  | number  |  1 - есть доступ к билингу, 0 - нет доступа |
|  users_access  | number  |  1 - есть доступ к пользователям компании, 0 - нет доступа |
|  excel_access  | number  |   1 - есть доступ к выгрузкам в excel, 0 - нет доступа  |
|  finances_access  | number  |  1 - есть доступ к финансам, 0 - нет доступа |
|  storages_access  | number  |  1 - есть доступ к складу, 0 - нет доступа |
|  send_sms  | number  |  1 - есть доступ к отправке смс рассылок, 0 - нет доступа |
|  master_id  | number  | 0 - если пользователь может просматривать расписание и записи всех сотрудников, иначе только того сотрудника, ID которого задан |


### Получить пользователей компании [GET]


+ Parameters

    + company_id (required, number) - ID компании

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)


    + Body

            [
              {
                "id": 224348,
                "firstname": "прор",
                "login": "79284400000",
                "email": "aser@mail.ru",
                "phone": "79284400000",
                "access": {
                  "stat_access": true,
                  "schedule_edit_access": false,
                  "client_phones_access": false,
                  "clients_access": false,
                  "settings_access": false,
                  "edit_records_access": false,
                  "timetable_access": true,
                  "billing_access": false,
                  "users_access": false,
                  "excel_access": false,
                  "finances_access": false,
                  "storages_access": false,
                  "send_sms": true,
                  "master_id": 0
                }
              },
              {
                "id": 11,
                "firstname": "Test user",
                "login": "71112222221",
                "email": "moresalonov@yandex.ru",
                "phone": "71112222221",
                "access": {
                  "stat_access": true,
                  "schedule_edit_access": true,
                  "client_phones_access": true,
                  "clients_access": true,
                  "settings_access": true,
                  "edit_records_access": true,
                  "timetable_access": true,
                  "billing_access": true,
                  "users_access": false,
                  "excel_access": true,
                  "finances_access": true,
                  "storages_access": true,
                  "send_sms": true,
                  "master_id": 0
                }
              }
            ]



# Group Кассы


## Коллекция касс [/accounts/{company_id}]

Объект кассы компании имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number   | Id  кассы  |
|  title  | string  | Название  |
|  type  | number  | 1 - для безналичных платежей, 0 для наличных |
|  comment  | string  | Описание к кассе |


### Получить кассы компании [GET]


+ Parameters

    + company_id (required, number) - ID компании

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)


    + Body

            [
              {
                "id": 13881,
                "title": "Основная касса",
                "type": 0,
                "comment": "Стоит на ресепшене"
              },
              {
                "id": 13882,
                "title": "Расчетный счет",
                "type": 1,
                "comment": "Для безналичных расчетов"
              },
              {
                "id": 21961,
                "title": "Авансы",
                "type": 0,
                "comment": ""
              }
            ]



# Group Склады

## Коллекция склады [/storages/{company_id}]

Объект склада компании имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  |  number   | Id  кассы  |
|  title  | string  | Название  |
|  for_services  | number  | 1 - если используется для автоматического списания расходников |
|  for_sale  | number  | 1 - если склад по умолчанию для продажи товаров |
|  comment  | string  | Описание к кассе |


### Получить склады компании [GET]


+ Parameters

    + company_id (required, number) - ID компании

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)


    + Body

            [
              {
                "id": 1,
                "title": "Расходники",
                "for_service": 1,
                "for_sale": 0,
                "comment": "Для учета расходных материалов"
              },
              {
                "id": 2,
                "title": "Товары",
                "for_service": 0,
                "for_sale": 1,
                "comment": "Для учета продаж в магазине"
              },
              {
                "id": 23061,
                "title": "Орс",
                "for_service": 0,
                "for_sale": 1,
                "comment": "Нз"
              }
            ]


# Group SMS рассылка

## SMS рассылка по списку клиентов [/sms/clients/by_id/{company_id}]

Объект для создания SMS рассылки имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  client_ids  |  array of number   | Массив ID клиентов  |
|  text  | string  | Текст SMS сообщения  |


### Отправить SMS рассылку по списку клиентов [POST]


+ Parameters

    + company_id (required, number) - ID компании

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

              {
                "client_ids": [1, 2, 3, 4, 5],
                "text": "Уважаемые клиенты, поздравляем Вас с тем, что вы наши клиенты! Вам очень повезло!",
              }


+ Response 200 (application/json)


    + Body

            []


## SMS рассылка по клиентам, подходящим под фильтры [/sms/clients/by_filter/{company_id}{?fullname,phone,email,card}]

Объект для создания SMS рассылки имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  text  | string  | Текст SMS сообщения  |

#### Фильтрация клиентов
+ fullname:'Joh' (optional, string) - Имя (часть имени) для фильтрации клиентов
+ phone:'7916' (optional, string) - Телефон (часть номера) для фильтрации клиентов
+ email:'test@' (optional, string) - Email (часть) для фильтрации клиентов
+ card:'5663rt' (optional, string) - Card (часть) для фильтрации клиентов по номеру карты лояльности

Внимание: При отсутствии фильтров SMS рассылка уйдет по всей базе!

### Отправить SMS рассылку по клиентам, подходящим под фильтры [POST]

+ Parameters

    + company_id (required, number) - ID компании
    + fullname:'Joh' (optional, string) - Имя (часть имени) для фильтрации клиентов
    + phone:'7916' (optional, string) - Телефон (часть номера) для фильтрации клиентов
    + email:'test@' (optional, string) - Email (часть) для фильтрации клиентов

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

              {
                "text": "Уважаемые клиенты, поздравляем Вас с тем, что вы наши клиенты! Вам очень повезло!",
              }


+ Response 200 (application/json)


    + Body

            []


# Group Email рассылка

## Email рассылка по списку клиентов [/email/clients/by_id/{company_id}]

Объект для создания Email рассылки имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  client_ids  |  array of number   | Массив ID клиентов  |
|  text  | string  | Текст Email сообщения  |
|  subject  | string  | Тема Email сообщения  |


### Отправить Email рассылку по списку клиентов [POST]


+ Parameters

    + company_id (required, number) - ID компании

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

              {
                "client_ids": [1, 2, 3, 4, 5],
                "subject": "Важно!",
                "text": "Уважаемые клиенты, поздравляем Вас с тем, что вы наши клиенты! Вам очень повезло!",
              }


+ Response 200 (application/json)


    + Body

            []


## Email рассылка по клиентам, подходящим под фильтры [/email/clients/by_filter/{company_id}{?fullname,phone,email,card}]

Объект для создания Email рассылки имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  text  | string  | Текст Email сообщения  |
|  subject  | string  | Тема Email сообщения  |

#### Фильтрация клиентов
+ fullname:'Joh' (optional, string) - Имя (часть имени) для фильтрации клиентов
+ phone:'7916' (optional, string) - Телефон (часть номера) для фильтрации клиентов
+ email:'test@' (optional, string) - Email (часть) для фильтрации клиентов
+ card:'5663rt' (optional, string) - Card (часть) для фильтрации клиентов по номеру карты лояльности

Внимание: При отсутствии фильтров Email рассылка уйдет по всей базе!

### Отправить Email рассылку по клиентам, подходящим под фильтры [POST]

+ Parameters

    + company_id (required, number) - ID компании
    + fullname:'Joh' (optional, string) - Имя (часть имени) для фильтрации клиентов
    + phone:'7916' (optional, string) - Телефон (часть номера) для фильтрации клиентов
    + email:'test@' (optional, string) - Email (часть) для фильтрации клиентов

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

              {
                "subject": "Важно!",
                "text": "Уважаемые клиенты, поздравляем Вас с тем, что вы наши клиенты! Вам очень повезло!",
              }


+ Response 200 (application/json)


    + Body

            []

# Group ККМ транзакции

## Получение транзакций, подходящих под фильтры [/kkm_transactions/{salon_id}{?page,editable_length,type,status,start_date,end_date}]
### Получить транзакции [GET]

Фильтры

| Параметр  | Описание |
| ------------- | ------------- |
|  page  | Номер страницы |
|  editable_length  | Количество клиентов на странице |
|  type  | Тип операции |
|  status  | Статус операции |
|  start_date  | Дата начала периода |
|  end_date  | Дата окончания периода |

Типы всех операций c ККМ

| Значение  | Описание |
| ------------- | ------------- |
|  0  | Операция продажи  (активна для документа с типом "Визит") |
|  1  | Операция возврата продажи (активна для документа с типом "Визит") |
|  2  | Операция коррекции |
|  4  | Операция открытия смены |
|  5  | Операция закрытия смены |
|  9  | Операция получения статуса ККМ  |
|  11  | Операция получения статуса команды ККМ |
|  12  | Операция коррекции |
|  13  | Печать X-отчёта |
|  6  | Внесение наличных |
|  7  | Изъятие наличных |

Статусы всех операций с ККМ

| Значение  | Описание |
| ------------- | ------------- |
|  0  | Ошибка соединения с KKM |
|  1  | Успешно |
|  2  | Отправлен на печать |
|  3  | Ошибка выполнения |
|  4  | Ошибка проверки статуса |
|  5  | Ожидание готовности KKM  |

Типы документов

| Значение  | Описание |
| ------------- | ------------- |
|  1  | Продажа товара |
|  2  | Оказание услуг |
|  3  | Приход товара |
|  4  | Списание товара |
|  5  | Движение товара |
|  6  | Инвентаризация  |
|  7  | Визит |
|  8  | Списание расходников |

+ Parameters

    + salon_id (required, number) - ID филиала
    + page:1 (optional, number) - Номер страницы
    + editable_length:25 (optional, number) - Количество клиентов на странице
    + type:20 (optional, number) - Тип операции
    + status:6 (optional, number) - Статус операции
    + start_date:'' (optional, number) -  Дата начала периода
    + end_date:'' (optional, number) - Дата окончания периода

+ Request (application/json)

    + Headers

            Authorization: Bearer access_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": [
                    {
                        "id": 1059,
                        "print_date": "2018-06-26 01:10:19",
                        "printed_count": 1,
                        "sum": 10,
                        "type": {
                            "id": 1,
                            "title": "Операция возврата продажи"
                        },
                        "status": {
                            "id": 3,
                            "title": "Ошибка выполнения"
                        },
                        "document": {
                            "id": 2045,
                            "type": 7,
                            "type_title": "Визит"
                        },
                        "cashier": {
                            "id": 746310,
                            "name": "Андрей Панов"
                        }
                    }
                ],
                "meta": {
                    "count": 1
                }
            }

# Group Финансовые транзакции

Объект транзакции имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID транзакции  |
|  document_id | number | ID документа |
|  expense  | expense  | Тип платежа  |
|  date  | string  | Дата создания транзакции  |
|  amount  | float  | Сумма транзакции  |
|  comment  | string | Комментарий  |
|  master  | master  | Сотрудник |
|  supplier  | supplier  | Контрагент  |
|  account  | account  |  Касса  |
|  client  | client  | Клиент  |

Объекты expense, master, account, supplier имеют следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID  |
|  title  | string  | Описание  |

Объект client имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID  |
|  name  | string  | Имя  |
|  phone  | string  | Номер телефона  |

## Получение транзакций, подходящих под фильтры [/transactions/{company_id}{?page,count,account_id,supplier_id,user_id,client_id,master_id,type,real_money,deleted,start_date,client,end_date,balance_is,document_id}]
### Получить транзакции [GET]
#### Фильтрация транзакций
+ page: Номер страницы
+ count: Количество клиентов на странице
+ account_id: ID кассы
+ supplier_id: ID контрагента
+ client_id: ID клиента
+ user_id: ID пользователя
+ master_id: ID сотрудника
+ type: тип транзакции
+ real_money: транзакция реальными деньгами
+ deleted: была ли удалена транзакция
+ start_date:  дата начала периода
+ end_date: дата окончания периода
+ balance_is: 0 - любой баланс, 1 - положительный, 2 - оттрицательный
+ document_id: идентификатор документа

+ Parameters

    + company_id (required, number) - ID компании
    + page:1 (optional, number) - Номер страницы
    + count:50 (optional, number) - Количество клиентов на странице
    + account_id:0 (optional, number) - ID кассы
    + supplier_id:0 (optional, number) - ID контрагента
    + client_id:0 (optional, number) - ID клиента
    + user_id:0 (optional, number) - ID пользователя
    + master_id:0 (optional, number) - ID сотрудника
    + type:0 (optional, number) - тип транзакции
    + real_money:0 (optional, number) - транзакция реальными деньгами
    + deleted:0 (optional, number) - была ли удалена транзакция
    + start_date:'' (optional, number) -  дата начала периода
    + end_date:'' (optional, number) - дата окончания периода
    + balance_is:0 (optional, number) - 0 - любой баланс, 1 - положительный, 2 - оттрицательный
    + document_id:0 (optional, number) - идентификатор документа

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            [
              {
                "id": "4815162342",
                "document_id": 22256641,
                "expense": {
                  "id": "5",
                  "title": "Оказание услуг"
                },
                "date": "2016-04-13T15:34:31+0400",
                "amount": "1000.00",
                "comment": "Comment",
                "master": {
                  "id": "1926",
                  "title": "Суини Тодд"
                },
                "supplier": {
                  "id": "1968",
                  "title": "George"
                },
                "account": {
                  "id": "23182",
                  "title": "Карты"
                },
                "client": {
                  "id": "481516",
                  "name": "John Turk",
                  "phone": "+79876543210"
                }
              }
            ]


## Получение транзакций, по ID визита или записи [/timetable/transactions/{company_id}{?record_id,visit_id}]
### Получить транзакции [GET]
#### Фильтрация транзакций
+ record_id: ID записи
+ visit_id: ID визита

+ Parameters

    + company_id (required, number) - ID компании
    + record_id:0 (optional, number) - ID записи
    + visit_id:0 (optional, number) - ID визита

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token


+ Response 200 (application/json)

    + Body

            [
              {
                "id": "4815162342",
                "document_id": 22256641,
                "expense": {
                  "id": "5",
                  "title": "Оказание услуг"
                },
                "date": "2016-04-13T15:34:31+0400",
                "amount": "1000.00",
                "comment": "Comment",
                "master": {
                  "id": "1926",
                  "title": "Суини Тодд"
                },
                "supplier": {
                  "id": "1968",
                  "title": "George"
                },
                "account": {
                  "id": "23182",
                  "title": "Карты"
                },
                "client": {
                  "id": "481516",
                  "name": "John Turk",
                  "phone": "+79876543210"
                }
              }
            ]

## Создание финансовой транзакции [/finance_transactions/{company_id}]
### Создание финансовой транзакции  [POST]

+ Parameters
    + company_id (required, number) - ID компании

+ Attributes
    + expense_id (required, number) - ID типа транзакции, статья платежа
    + amount (required, number) - сумма
    + account_id (required, number) - ID кассы
    + client_id (optional, number) - ID клиента
    + master_id (optional, number) - ID мастера
    + supplier_id (optional, number) - ID контрагента
    + comment (optional, number) - комментарий
    + date (required, number) - дата проведения транзакции
    + document_id (optional, number) - ID документа

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                "expense_id": 2640,
                "amount": 100,
                "account_id": 39105,
                "client_id": 4240788,
                "supplier_id": 0,
                "master_id": 0,
                "comment": "Transaction comment",
                "date": "2017-04-04 20:00:00"
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 9053737,
                    "date": "2017-04-04 20:00:00",
                    "type_id": 2640,
                    "expense_id": 2640,
                    "account_id": 35501,
                    "amount": 434,
                    "client_id": 4240788,
                    "master_id": 0,
                    "supplier_id": 0,
                    "comment": "Transaction comment",
                    "item_id": 0,
                    "target_type_id": 0,
                    "record_id": 0,
                    "expense": {
                        "id": 2640,
                        "title": "Оказание корпоративных услуг"
                    },
                    "account": {
                        "id": 35501,
                        "title": "Касса",
                        "type_id": 0,
                        "type": 0,
                        "comment": "",
                        "company_id": 4564
                    },
                    "client": {
                        "id": "4240788",
                        "name": "Client",
                        "phone": "71000000001"
                    },
                    "master": [],
                    "supplier": []
                },
                "meta": []
            }

## Операции над финансовой транзакцией [/finance_transactions/{company_id}/{transaction_id}]
### Получение финансовой транзакции [GET]

+ Parameters
    + company_id (required, number) - ID компании
    + transaction_id (required, number)- ID транзакции


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 9053737,
                    "date": "2017-04-04 20:00:00",
                    "type_id": 2640,
                    "expense_id": 2640,
                    "account_id": 35501,
                    "amount": 434,
                    "client_id": 4240788,
                    "master_id": 0,
                    "supplier_id": 0,
                    "comment": "Transaction comment",
                    "item_id": 0,
                    "target_type_id": 0,
                    "record_id": 0,
                    "expense": {
                        "id": 2640,
                        "title": "Оказание корпоративных услуг"
                    },
                    "account": {
                        "id": 35501,
                        "title": "Касса",
                        "type_id": 0,
                        "type": 0,
                        "comment": "",
                        "company_id": 4564
                    },
                    "client": {
                        "id": "4240788",
                        "name": "Client",
                        "phone": "71000000001"
                    },
                    "master": [],
                    "supplier": []
                },
                "meta": []
            }

### Обновление финансовой транзакции [PUT]

+ Parameters

    + company_id (required, number) - ID компании
    + transaction_id (required, number) - ID транзакции

+ Attributes
    + type_id (required, number) - ID типа транзакции, статья платежа
    + amount (required, number) - сумма
    + account_id (required, number) - ID кассы
    + client_id (optional, number) - ID клиента
    + master_id (optional, number) - ID мастера
    + supplier_id (optional, number) - ID контрагента
    + comment (optional, string) - комментарий
    + date (required, string) - дата проведения транзакции

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                "type_id": 2640,
                "amount": 333,
                "account_id": 35501,
                "client_id": 4240788,
                "master_id": 0,
                "supplier_id": 0,
                "comment": "Updated comment",
                "date": "2017-03-22 20:50:01"
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 9053737,
                    "date": "2017-04-04 20:00:00",
                    "type_id": 2640,
                    "expense_id": 2640,
                    "account_id": 35501,
                    "amount": 434,
                    "client_id": 4240788,
                    "master_id": 0,
                    "supplier_id": 0,
                    "comment": "Transaction comment",
                    "item_id": 0,
                    "target_type_id": 0,
                    "record_id": 0,
                    "expense": {
                        "id": 2640,
                        "title": "Оказание корпоративных услуг"
                    },
                    "account": {
                        "id": 35501,
                        "title": "Касса",
                        "type_id": 0,
                        "type": 0,
                        "comment": "",
                        "company_id": 4564
                    },
                    "client": {
                        "id": "4240788",
                        "name": "Client",
                        "phone": "71000000001"
                    },
                    "master": [],
                    "supplier": []
                },
                "meta": []
            }

### Удаление транзакции [DELETE]
+ Parameters
    + company_id (required, integer) - ID компании
    + transaction_id (required, integer) - ID транзакции

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 202 (application/json)


#Group Интеграция с сетевой телефонией

## Подключение интеграции

Для использования api и активации доступа к настройкам в пользовательском интерфейсе необходимо активировать интеграцию, отправив запрос "Подключить интеграцию".
После успешного подключения, в сетевом интерфейсе пользователя будет открыт доступ в раздел с настройками маршрутизации.

### Подключить интеграцию [POST /voip/integration]
+ Attributes
    + crm_token (required, string) - токен интеграции
    + command (required, string) - slug операции 'setup'
    + type (required, string) - тип операции, в данном случае  'enable'

+ Request

    + Headers

            Authorization: Bearer partner_token
            Content-Type: application/json

    + Body

            {
                "command": "setup",
                "type": "enable",
                "crm_token": "7cf262d6-1656-43f9-86ac-2826bdc125d2"
            }

+ Response 202

    + Body

            {
                "success": true,
                "data": null,
                "meta": {
                    "message": "Accepted"
                }
            }

## Отключение интеграции

Для отключения интеграции можно воспользоваться методом "Отключить интеграцию".
После отключения интеграции закрывается доступ в раздел настроек пользовательского интерфейса, обработка запросов "Уведомление о звонке" и "Сохранение информации о звонке" не производится.

### Отключить интеграцию [POST /voip/integration]

+ Attributes
    + crm_token (required, string) - токен интеграции
    + command (required, string) - slug операции 'setup'
    + type (required, string) - тип операции, в данном случае 'disable'

+ Request

    + Headers

            Authorization: Bearer partner_token
            Content-Type: application/json

    + Body

            {
                "command": "setup",
                "type": "disable",
                "crm_token": "7cf262d6-1656-43f9-86ac-2826bdc125d2"
            }

+ Response 202

    + Body

            {
                "success": true,
                "data": null,
                "meta": {
                    "message": "Accepted"
                }
            }

## Уведомления о звонке

Для отображения уведомлений о входящем звонке используется метод "Уведомление о звонке", в параметрах указыватеся тип звонка ("incoming", "outgoing", "internal"), но на текущий момент уведомления отображаются только для значения "incoming".
Уведомления отображаются для пользователей, определенных на основе настроек маршрутизации.
При одновременном указании параметров "user" и "diversion" приоритетным при поиске маршрутов является "user".

### Уведомление о звонке [POST /voip/integration]

+ Attributes
    + crm_token (required, string) - токен интеграции
    + command (required, string) - slug операции 'event'
    + type (required, string) - тип операции, в данном случае "incoming"
    + phone (required, string) - номер звонящего абонента
    + user (optional, string) - идентификатор абонента телефонии, sip
    + diversion (required, string) - номер через который пришел звонок

+ Request

    + Headers

            Authorization: Bearer partner_token
            Content-Type: application/json

    + Body

            {
                "command": "event",
                "type": "incoming",
                "crm_token": "7cf262d6-1656-43f9-86ac-2826bdc125d2",
                "phone": "71010001100",
                "user": "external_user_id",
                "diversion": "71010001122"
            }

+ Response 202

    + Body

            {
                "success": true,
                "data": null,
                "meta": {
                    "message": "Accepted"
                }
            }

## Сохранение информации о звонке

Сохранение информации о звонке автоматически происходит в сетевую историю и в историю компаний сети в соответствии с настройками маршрутизации звонка.

### Сохранение информации о звонке [POST /voip/integration/]

+ Attributes
    + crm_token (required, string) - токен интеграции
    + command (required, string) - операции 'history'
    + type (required, string) - тип операции ("incoming", "outgoing", "internal")
    + phone (required, string) - номер звонившего абонента
    + user (optional, string) - идентификатор абонента телефонии, sip
    + diversion (required, string) - номер через который пришел звонок
    + duration (optional, number) - длительность звонка (в секундах)
    + link (optional, string) - ссылка на запись звонка
    + call_id (optional, string) - идентификатор звонка в системе voip
    + status (optional, string) - статус звонка 'success'|'missed'
    + date (optional, string) - дата и время звонка (ISO8601)

+ Request

    + Headers

            Authorization: Bearer partner_token
            Content-Type: application/json

    + Body

            {
                "command": "history",
                "type": "incoming",
                "crm_token": "7cf262d6-1656-43f9-86ac-2826bdc125d2",
                "phone": "71010001100",
                "user": "external_user_id",
                "diversion": "71010001122",
                "duraiton": 90,
                "link": "https://external.call.storage/call_record.mp3",
                "call_id": "external_call_id",
                "status": "success",
                "date": "2018-03-20T12:00:28+00:00"
            }

+ Response 202

    + Body

            {
                "success": true,
                "data": null,
                "meta": {
                    "message": "Accepted"
                }
            }

# Group Уведомления о событиях "webhooks"

Для организации двусторонней синхронизации с YCLIENTS можно использовать уведомления о событиях,
которые может отправлять YCLIENTS на указанный при настройке адрес.

YCLIENTS поддерживает уведомления о создании, изменении и удалении следующих сущностей:
- Компания
- Категория Услуг
- Услуга
- Сотрудник
- Клиент
- Запись
- Товар
- Операция продажи товара
- Операция прихода товара
- Операция списания товара
- Операция списания расходника
- Операция перемещения товара
- Финансовая операция

Каждое событие при отправке имеет следующий набор полей

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  company_id  | number  | ID компании в рамках которой происходит событие  |
|  resource  | string  | Имя сущности. Одно из: company, service_category, service, staff, client, record  |
|  resource_id  | number  | ID сущности в YCLIENTS  |
|  status  | string  | Событие. create, update или delete  |
|  data  | JSON | Параметры сущности. Используется тот же набор полей что и при обращении к сущности через API.  |


## Настройка уведомлении о событиях [/hooks_settings/{company_id}]


Для получения уведомлений о событиях нужно произвести их настройку, указав на какой адрес отправлять запросы и по каким сущностям.
Для настройки уведомлений необходимо быть авторизованным как пользователь с правами доступа к настройкам компании.

Объект настроек уведомлений содержит следующие поля

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  company_id  | number  | ID компании в рамках которой происходит событие  |
|  url  | string  | Адрес, на который отправлять уведомления  |
|  active  | number  | 1 - уведомления активны, 0 - не активны  |
|  salon  | number  | 1 - отправлять события по сущности компания, 0 - нет  отправлять  |
|  service_category  | number  | 1 - отправлять события по сущности категория услуг, 0 - нет  отправлять  |
|  service  | number  | 1 - отправлять события по сущности услуга, 0 - нет  отправлять  |
|  staff  | number  | 1 - отправлять события по сущности сотрудник, 0 - нет  отправлять  |
|  good  | number  | 1 - отправлять события по сущности товар, 0 - нет  отправлять  |
|  client  | number  | 1 - отправлять события по сущности клиент, 0 - нет  отправлять  |
|  record  | number  | 1 - отправлять события по сущности запись, 0 - нет  отправлять  |
|  goods_operations_sale  | number  | 1 - отправлять события по сущности продажа товара, 0 - нет  отправлять  |
|  goods_operations_receipt  | number  | 1 - отправлять события по сущности приход товара, 0 - нет  отправлять  |
|  goods_operations_consumable  | number  | 1 - отправлять события по сущности списание расходника, 0 - нет  отправлять  |
|  goods_operations_stolen  | number  | 1 - отправлять события по сущности списание товара, 0 - нет  отправлять  |
|  goods_operations_move  | number  | 1 - отправлять события по сущности перемещение товара, 0 - нет  отправлять  |
|  finances_operation  | number  | 1 - отправлять события по сущности финансовая операция, 0 - нет  отправлять  |


### Получить настройки уведомлений о событиях [GET]

+ Parameters

    + company_id (required, number) - ID компании


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
              "url": "http://dev.tools.test.com/test/Hooks",
              "active": 0,
              "salon": 1,
              "service_category": 0,
              "service": 1,
              "good": 1,
              "master": 1,
              "client": 1,
              "record": 1,
              "goods_operations_sale": 1,
              "goods_operations_receipt": 1,
              "goods_operations_consumable": 1,
              "goods_operations_stolen": 1,
              "goods_operations_move": 1,
              "finances_operation": 1
            }


### Изменить настройки уведомлений о событиях [POST]

+ Parameters

    + company_id (required, number) - ID компании


+ Request (application/json)

    + Attributes
        + url (required, string) - Адрес, на который отправлять уведомления
        + active (required, number) - 1 - уведомления активны, 0 - не активны
        + salon (optional, number) - 1 - отправлять события по сущности компания, 0 - нет  отправлять
        + service_category (optional, number) - 1 - отправлять события по сущности категория услуг, 0 - нет  отправлять
        + service (optional, number) - 1 - отправлять события по сущности услуга, 0 - нет  отправлять
        + good (optional, number) - 1 - отправлять события по сущности товар, 0 - нет  отправлять
        + staff (optional, number) - 1 - отправлять события по сущности сотрудник, 0 - нет  отправлять
        + client (optional, number) - 1 - отправлять события по сущности клиент, 0 - нет  отправлять
        + record (optional, number) - 1 - отправлять события по сущности запись, 0 - нет  отправлять
        + goods_operations_sale (optional, number) - 1 - отправлять события по сущности продажа товара, 0 - нет  отправлять
        + goods_operations_receipt (optional, number) - 1 - отправлять события по сущности приход товара, 0 - нет  отправлять
        + goods_operations_consumable (optional, number) - 1 - отправлять события по сущности списание расходника, 0 - нет  отправлять
        + goods_operations_stolen (optional, number) - 1 - отправлять события по сущности списание товара, 0 - нет  отправлять
        + goods_operations_move (optional, number) - 1 - отправлять события по сущности перемещение товара, 0 - нет  отправлять
        + finances_operation (optional, number) - 1 - отправлять события по сущности финансовая операция, 0 - нет  отправлять


    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
              "url": "http://dev.tools.test.com/test/Hooks",
              "active": 0,
              "salon": 1,
              "service_category": 0,
              "service": 1,
              "good": 1,
              "master": 1,
              "client": 1,
              "record": 1,
              "goods_operations_sale": 1,
              "goods_operations_receipt": 1,
              "goods_operations_consumable": 1,
              "goods_operations_stolen": 1,
              "goods_operations_move": 1,
              "finances_operation": 1
            }

+ Response 201 (application/json)

    + Body

            {
              "url": "http://dev.tools.test.com/test/Hooks",
              "active": 0,
              "salon": 1,
              "service_category": 0,
              "service": 1,
              "master": 1,
              "client": 1,
              "record": 1,
              "goods_operations_sale": 1,
              "goods_operations_receipt": 1,
              "goods_operations_consumable": 1,
              "goods_operations_stolen": 1,
              "goods_operations_move": 1,
              "finances_operation": 1
            }


# Group Категории
Объект категории имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID категории  |
|  salon_id  | number  | ID компании  |
|  title  | string  | Название категории  |
|  color  | string  | Цвет метки в формате #RRGGBB  |
|  icon  | string | Название иконки  |
|  entity  | number  | Объект категории (1 - категория для клиентов, 2 - категория для записей)|
|  deleted  | number  | Метка удаления  |
|  not_editable  | number  |  Разрешены ли изменения категории (1 - разрешены, 0 - не разрешены)  |


## Получение категорий компании [/labels/{company_id}/{entity}]
### Получить категории [GET]

+ Parameters

    + company_id (required, number) - ID компании
    + entity (required, number) - Объект категории (0 - общие метки, 1 - метки клиентов, 2 - метки записей)


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            [
              {
                "id": "4815162342",
                "salon_id": "123456",
                "title": "Label One",
                "color": "#ffaacc",
                "icon": "unlock",
                "entity": "2",
                "deleted": "0",
                "not_editable": "0"
              }
            ]


## Создание категории компании [/labels/{company_id}{?title,color,entity,icon}]
### Создать категорию [POST]

+ Parameters

    + company_id (required, number) - ID компании
    + title (required, string) - Название категории
    + color (required, string) - Цвет метки в формате #RRGGBB
    + entity (optional, number) - Объект категории (0 - общие метки, 1 - метки клиентов, 2 - метки записей)
    + icon (optional, string) - Название иконки


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

              {
                "ok": true
              }



## Обновление категории компании [/labels/{company_id}/{label_id}]
### Обновить категорию [PUT]

+ Parameters

    + company_id (required, number) - ID компании
    + label_id (required, number) - ID метки

+ Attributes

    + title (required, string) - Название категории
    + color (required, string) - Цвет метки в формате #RRGGBB
    + entity (optional, number) - Объект категории (0 - общие метки, 1 - метки клиентов, 2 - метки записей)
    + icon (optional, string) - Название иконки

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

              {
                "ok": true
              }


### Удалить категорию компании [DELETE]

+ Parameters

    + company_id (required, number) - ID компании
    + label_id (required, number) - ID метки


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

              {
                "ok": true
              }




# Group Товары

Объект товара имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  title  | string  | Наименование товара  |
|  value  | string  | Наименование товара  |
|  label  | string  | Наименование товара с артикулом (если имеется)  |
|  good_id  | number  | Тип платежа  |
|  cost  | float  | Цена продажи  |
|  unit_id  | number  | ID единицы измерения для продажи  |
|  unit_short_title  | string | Единица измерения для продажи  |
|  service_unit_id  | number  | ID единицы измерения для списания  |
|  service_unit_short_title  | string | Единица измерения для списания  |
|  actual_cost  | float  | Себестоимость |
|  unit_actual_cost  | float  | Себестоимость единицы  |
|  unit_actual_cost_format  | string  | Формат себестоимости единицы  |
|  unit_equals  | float  |  Отношение единицы измерения для продажик еденице за списание  |
|  barcode  | number  | Штрих-код  |
|  actual_amounts  | array  | Остатки на складах  |
|  is_barcode  | number  | Товар по штрих-коду  |

Объект из actual_amounts имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  storage_id  | number  | ID склада  |
|  amount  | number  | Количество  |


## Получение товаров [/goods/{company_id}/{good_id}{?term}]
### Получить товары [GET]
+ term: Наименование, артикул или штрих-код

+ Parameters

    + company_id (required, number) - ID компании
    + good_id (optional, number) - ID товара
    + term (optional, string) - наименование, артикул или штрих-код


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            [
              {
                "title": "Шампунь 1",
                "value": "Шампунь 1",
                "label": "Шампунь 1 (123)",
                "good_id": "123456",
                "cost": "100500",
                "unit_id": "4835",
                "unit_short_title": "шт",
                "service_unit_id": "3548",
                "service_unit_short_title": "гр",
                "actual_cost": "1050",
                "unit_actual_cost": "105",
                "unit_actual_cost_format": "105 р",
                "unit_equals": "10",
                "barcode": "123",
                "actual_amounts": [
                    {
                        "storage_id": "987",
                        "amount": "1000000"
                    }
                ]
              }
            ]


# Group Товарные транзакции

Объект товарной транзакции имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id | number  |  ID транзакции  |
|  document_id | number  |  ID документа |
|  type_id  | number  | ID типа транзакции  |
|  type  | string  | Тип транзакции  |
|  good  | good  | Товар  |
|  storage  | storage  | Склад  |
|  unit  | unit  | Единица измерения  |
|  operation_unit_type  | number  | Тип единицы измерения: 1 - для продажи, 2 - для списания  |
|  create_date  | string | Дата создания  |
|  cost_per_unit  | float  | Цена за единицу  |
|  cost  | float | Цена  |
|  discount  | float  | Скидка |
|  master  | master  | Сотрудник  |
|  supplier  | supplier  | Поставщик  |
|  service  | service  |  Услуга  |
|  client  | client  | Клиент  |

Объект good имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID товара  |
|  title  | string  | Наименование  |

Объект storage имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID  склада  |
|  title  | string  | Наименование  |

Объект unit имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID  склада  |
|  title  | string  | Единица измерения  |

Объект master имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID сотрудника  |
|  title  | string  | Имя сотрудника  |

Объект supplier имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID поставщика  |
|  title  | string  | Имя поставщика  |

Объект service имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID услуги  |
|  title  | string  | Название услуги  |

Объект client имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  | ID клиента  |
|  name  | string  | Имя клиента  |
|  phone  | string  | Телефон клиента  |


## Поиск товарных транзакций [/storages/transactions/{company_id}{?page,count,start_date,end_date,document_id}]
### Поиск товарных транзакций [GET]

+ Parameters

    + company_id (required, number) - ID компании
    + page:1 (optional, number) - номер страницы
    + count:20 (optional, number) - количество транзакций на странице
    + start_date:'' (optional, string) - дата начала периода
    + end_date:'' (optional, string) - дата окончания периода
    + document_id: ID документа


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            [
                {
                    "id": 123456789,
                    "document_id": 22256643,
                    "type_id": "987654321",
                    "type": "Нечто",
                    "good": {
                        id: "111222333",
                        title: "Something"
                    },
                    "storage": {
                        id: "333222111",
                        title: "Storage 1"
                    },
                    "unit": {
                        id: "333222111",
                        title: "миллилитр"
                    },
                    "operation_unit_type": 1,
                    "create_date": "2012-12-21T19:08:00+0400",
                    "cost_per_unit": "1.07",
                    "cost": "0.00",
                    "discount": "10.00",
                    "master": {
                        id: "112233445",
                        title: "Василий Иванов"
                    },
                    "supplier": {
                        id: "11112222",
                        title: "Best Supplier Ever"
                    },
                    "service": {
                        id: "1234321",
                        title: "Услуга 4"
                    },
                    "clients": {
                        id: "4321234",
                        name: "Джордж Смит",
                        phone: "+79876543210"
                    }
                }
            ]


## Создание товарной транзакции [/storage_operations/goods_transactions/{company_id}]
### Создать транзакцию [POST]

+ Parameters

    + company_id (required, number) - ID компании

+ Attributes

    + document_id (required, number)- ID документа
    + good_id (required, number) - ID товара
    + amount  (required, number)- количество
    + cost_per_unit (required, number) - стоимтость за единицу товара
    + discount (required, number) - скидка в %
    + cost (required, number) - итоговая сумма транзакции
    + operation_unit_type (required, number) - тип единицы измерения: 1 - для продажи, 2 - для списания
    + master_id (optional, number) - ID мастера продавшего товар
    + client_id (optional, number) - ID клиента купившего товар
    + supplier_id (optional, number) - ID поставщика
    + comment (optional, string) - коммент
    + paid (optional, boolean) - признак оплаты
    + account_id (optional, number) - касса в которую происходит оплата

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                "document_id": 22254960,
                "good_id": 232674,
                "amount": 1,
                "cost_per_unit": 100,
                "discount": 10,
                "cost": 90,
                "operation_unit_type": 1,
                "master_id": 26781,
                "client_id": 0,
                "supplier_id": 0,
                "comment": "Transaction comment"
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 3428010,
                    "document_id": 22254960,
                    "type_id": 1,
                    "type": {
                        "id": 1,
                        "title": "Продажа товара"
                    },
                    "company_id": 4564,
                    "good_id": 232674,
                    "amount": -1,
                    "cost_per_unit": 100,
                    "discount": 10,
                    "cost": 90,
                    "unit_id": 1,
                    "storage_id": 36539,
                    "supplier_id": 0,
                    "client_id": 0,
                    "master_id": 26781,
                    "create_date": "2017-04-25 21:50:01",
                    "comment": "Transaction comment",
                    "deleted": false,
                    "good": {
                        "id": 232674,
                        "title": "Edition De Luxe"
                    },
                    "storage": {
                        "id": 36539,
                        "title": "Товары"
                    },
                    "supplier": [],
                    "client": [],
                    "master": {
                        "id": "26781",
                        "name": "Анджелина Джоли"
                    },
                    "unit": {
                        "id": 1,
                        "title": "Штука"
                    }
                },
                "meta": []
            }

## Операции над товарной транзакцией [/storage_operations/goods_transactions/{company_id}/{transaction_id}]
### Получение транзакции [GET]

+ Parameters

    + company_id (required, number) - ID компании
    + transaction_id (required, number)- ID транзакции

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 3428010,
                    "document_id": 22254960,
                    "type_id": 1,
                    "type": {
                        "id": 1,
                        "title": "Продажа товара"
                    },
                    "company_id": 4564,
                    "good_id": 232674,
                    "amount": -1,
                    "cost_per_unit": 100,
                    "discount": 10,
                    "cost": 90,
                    "unit_id": 1,
                    "operation_unit_type": 1,
                    "storage_id": 36539,
                    "supplier_id": 0,
                    "client_id": 0,
                    "master_id": 26781,
                    "create_date": "2017-04-25 21:50:01",
                    "comment": "Transaction comment",
                    "deleted": false,
                    "good": {
                        "id": 232674,
                        "title": "Edition De Luxe"
                    },
                    "storage": {
                        "id": 36539,
                        "title": "Товары"
                    },
                    "supplier": [],
                    "client": [],
                    "master": {
                        "id": "26781",
                        "name": "Анджелина Джоли"
                    },
                    "unit": {
                        "id": 1,
                        "title": "Штука"
                    }
                },
                "meta": []
            }

### Обновление транзакции [PUT]

+ Parameters

    + transaction_id (required, number)- ID транзакции
    + company_id (required, number) - ID компании

+ Attributes
    + document_id (required, number) - ID документа
    + good_id (required, number) - ID товара
    + amount  (required, number) - количество
    + cost_per_unit (required, number) - стоимтость за единицу товара
    + discount (required, number) - скидка в %
    + cost (required, number) - итоговая сумма транзакции
    + operation_unit_type (required, number) - тип единицы измерения: 1 - для продажи, 2 - для списания
    + master_id (optional, number) - ID мастера продавшего товар
    + client_id (optional, number) - ID клиента купившего товар
    + supplier_id (optional, number) - ID поставщика
    + comment (optional, string) - коммент
    + paid (optional, boolean) - признак оплаты
    + account_id (optional, number) - касса в которую происходит оплата

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 3428010,
                    "document_id": 22254960,
                    "type_id": 1,
                    "type": {
                        "id": 1,
                        "title": "Продажа товара"
                    },
                    "company_id": 4564,
                    "good_id": 232674,
                    "amount": -1,
                    "cost_per_unit": 100,
                    "discount": 10,
                    "cost": 90,
                    "unit_id": 1,
                    "operation_unit_type": 1,
                    "storage_id": 36539,
                    "supplier_id": 0,
                    "client_id": 0,
                    "master_id": 26781,
                    "create_date": "2017-04-25 21:50:01",
                    "comment": "Updated transaction comment",
                    "deleted": false,
                    "good": {
                        "id": 232674,
                        "title": "Edition De Luxe"
                    },
                    "storage": {
                        "id": 36539,
                        "title": "Товары"
                    },
                    "supplier": [],
                    "client": [],
                    "master": {
                        "id": "26781",
                        "name": "Анджелина Джоли"
                    },
                    "unit": {
                        "id": 1,
                        "title": "Штука"
                    }
                },
                "meta": []
            }

### Удаление транзакции [DELETE]

+ Parameters

    + company_id (required, number) - ID компании
    + transaction_id (required, number)- ID транзакции

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 202

#Group Складские операции

## Складские операции [/storage_operations/operation/{company_id}]

Создание складской операции предполагает создание документа и нескольких товарных транзакций в рамках одного запроса  к API.
При указании признака оплаты создаются необходимые финансовые транзакции

### Создание складской операции [POST]

+ Parameters

    + company_id (required, number) - ID компании

+ Attributes

    + type_id (required, number) - тип документа (1 продажа, 3 приход, 7 списание)
    + storage_id (required, number) - ID склада
    + comment (optional, string) - комментарий
    + date_created (required, string) - дата создания документа
    + transactions (required, array) - массив обьектов содержащих параметры транзакций, аналогично запросу на создание товарной транзакции
    + paid (optional, boolean) - признак оплаты
    + account_id (optional, number) - ID кассы в случае оплаты

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                "type_id": 1,
                "comment": "test document comment",
                "create_date": "2017-04-25 14:00:00",
                "storage_id": 91271,
                "transactions": [
                    {
                        "good_id": 232674,
                        "operation_unit_type": 1,
                        "amount": 1,
                        "cost_per_unit": 100,
                        "discount": 10,
                        "cost": 90,
                        "master_id": 0,
                        "client_id": 0,
                        "supplier_id": 0,
                        "comment": "test transaction comment"
                    }
                ]
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "document": {
                        "id": 22255506,
                        "type_id": 1,
                        "type": {
                            "id": 1,
                            "title": "Продажа товара"
                        },
                        "storage_id": 91271,
                        "user_id": 999290,
                        "company_id": 4564,
                        "number": 1254,
                        "comment": "test document comment",
                        "create_date": "2017-04-25 14:00:00",
                        "storage": {
                            "id": 91271,
                            "title": "Секретное место"
                        },
                        "company": {
                        "id": 4564,
                        "title": "Бизнес образец",
                        "country_id": 1,
                        "city_id": 2,
                        "timezone": 3,
                        "address": "",
                        "coordinate_lat": "25.247901",
                        "coordinate_lon": "55.275397399999974",
                        "logo": "http://dev7.dev.salonpicker.ru/uploads/s_120d9410f1472a4e6bdbafefe7eeba42.png",
                        "zip": "",
                        "phones": [],
                        "site": ""
                        },
                        "user": {
                            "id": "999290",
                            "name": "User name",
                            "phone": "70000000001"
                        }
                    },
                    "transactions": [
                        {
                            "id": 3428012,
                            "document_id": 22255506,
                            "type_id": 1,
                            "type": {
                                "id": 1,
                                "title": "Продажа товара"
                            },
                            "company_id": 4564,
                            "good_id": 232674,
                            "amount": -1,
                            "cost_per_unit": 100,
                            "discount": 10,
                            "cost": 90,
                            "unit_id": 1,
                            "storage_id": 91271,
                            "supplier_id": 0,
                            "client_id": 0,
                            "master_id": 0,
                            "create_date": "2017-04-25 14:00:00",
                            "comment": "test transaction comment",
                            "deleted": false,
                            "good": {
                                "id": 232674,
                                "title": "Edition De Luxe"
                            },
                            "storage": {
                                "id": 91271,
                                "title": "Секретное место"
                            },
                            "supplier": [],
                            "client": [],
                            "master": [],
                            "unit": {
                                "id": 1,
                                "title": "Штука"
                            }
                        }
                    ]
                },
                "meta": []
            }


#Group Документы складских операций

## Документ операции [/storage_operations/documents/{company_id}]
Документ операции является обьединяющей сущностью для товарных и финансовых транзакций.

### Создать документ [POST]

+ Parameters
    + company_id (required, number) - ID компании

+ Attributes
    + type_id (required, number) - тип документа (1 продажа, 3 приход, 7 списание)
    + storage_id (required, number) - ID склада
    + comment (optional, string) - комментарий
    + create_date (required, string) - дата проведения складской операции

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                "type_id": 1,
                "comment": "Комментарий документа",
                "storage_id": 36539,
                "create_date": "2017-04-24 20:00:00"
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 22255503,
                    "type_id": 1,
                    "type": {
                        "id": 1,
                        "title": "Продажа товара"
                    },
                    "storage_id": 36539,
                    "user_id": 999290,
                    "company_id": 4564,
                    "number": 1251,
                    "comment": "Document comment",
                    "create_date": "2017-04-24 20:00:00",
                    "storage": {
                        "id": 36539,
                        "title": "Товары"
                    },
                    "company": {
                        "id": 4564,
                        "title": "Бизнес образец",
                        "country_id": 1,
                        "city_id": 2,
                        "timezone": 3,
                        "address": "",
                        "coordinate_lat": "25.247901",
                        "coordinate_lon": "55.275397399999974",
                        "logo": "http://dev7.dev.salonpicker.ru/uploads/s_120d9410f1472a4e6bdbafefe7eeba42.png",
                        "zip": "",
                        "phones": [],
                        "site": ""
                    },
                    "user": {
                        "id": "999290",
                        "name": "User name",
                        "phone": "70000000001"
                    }
                },
                "meta": []
            }

## Операции над документом [/storage_operations/documents/{company_id}/{document_id}]
### Получить документ [GET]

+ Parameters

    + company_id (required, number) - ID компании
    + document_id (required, number) - ID документа

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 22255503,
                    "type_id": 1,
                    "type": {
                        "id": 1,
                        "title": "Продажа товара"
                    },
                    "storage_id": 36539,
                    "user_id": 999290,
                    "company_id": 4564,
                    "number": 1251,
                    "comment": "Document comment",
                    "create_date": "2017-04-24 20:00:00",
                    "storage": {
                        "id": 36539,
                        "title": "Товары"
                    },
                    "company": {
                        "id": 4564,
                        "title": "Бизнес образец",
                        "country_id": 1,
                        "city_id": 2,
                        "timezone": 3,
                        "address": "",
                        "coordinate_lat": "25.247901",
                        "coordinate_lon": "55.275397399999974",
                        "logo": "http://dev7.dev.salonpicker.ru/uploads/s_120d9410f1472a4e6bdbafefe7eeba42.png",
                        "zip": "",
                        "phones": [],
                        "site": ""
                    },
                    "user": {
                        "id": "999290",
                        "name": "User name",
                        "phone": "70000000001"
                    }
                },
                "meta": []
            }

### Обновить документ [PUT /storage_operations/documents/{company_id}/{document_id}]

+ Parameters

    + company_id (required, number) - ID компании
    + document_id (required, number) - ID документа

+ Attributes

    + type_id (required, number) - тип документа (1 продажа, 3 приход, 7 списание)
    + storage_id (required, number) - ID склада
    + date_created (required, string) - дата создания документа

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "id": 22255503,
                    "type_id": 1,
                    "type": {
                        "id": 1,
                        "title": "Продажа товара"
                    },
                    "storage_id": 36539,
                    "user_id": 999290,
                    "company_id": 4564,
                    "number": 1251,
                    "comment": "Updated document comment",
                    "create_date": "2017-04-25 20:00:00",
                    "storage": {
                        "id": 36539,
                        "title": "Товары"
                    },
                    "company": {
                        "id": 4564,
                        "title": "Бизнес образец",
                        "country_id": 1,
                        "city_id": 2,
                        "timezone": 3,
                        "address": "",
                        "coordinate_lat": "25.247901",
                        "coordinate_lon": "55.275397399999974",
                        "logo": "http://dev7.dev.salonpicker.ru/uploads/s_120d9410f1472a4e6bdbafefe7eeba42.png",
                        "zip": "",
                        "phones": [],
                        "site": ""
                    },
                    "user": {
                        "id": "999290",
                        "name": "User name",
                        "phone": "70000000001"
                    }
                },
                "meta": []
            }

### Удалить документ [DELETE /storage_operations/documents/{company_id}/{document_id}]

+ Parameters

    + company_id (required, number) - ID компании
    + document_id (required, number) - ID документа

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 202 (application/json)

### Получить финансовые транзакции документа [GET /storage_operations/documents/finance_transactions/{document_id}]

+ Parameters

    + document_id (required, number) - ID документа

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": [
                        {
                        "id": 9053737,
                        "date": "2017-04-04 20:00:00",
                        "type_id": 2640,
                        "expense_id": 2640,
                        "account_id": 35501,
                        "amount": 434,
                        "client_id": 4240788,
                        "master_id": 0,
                        "supplier_id": 0,
                        "comment": "Transaction comment",
                        "item_id": 0,
                        "target_type_id": 0,
                        "record_id": 0,
                        "expense": {
                            "id": 2640,
                            "title": "Оказание корпоративных услуг"
                        },
                        "account": {
                            "id": 35501,
                            "title": "Касса",
                            "type_id": 0,
                            "type": 0,
                            "comment": "",
                            "company_id": 4564
                        },
                        "client": {
                            "id": "4240788",
                            "name": "Client",
                            "phone": "71000000001"
                        },
                        "master": [],
                        "supplier": []
                    },
                    {
                        "id": 9053738,
                        "date": "2017-04-04 20:00:00",
                        "type_id": 2640,
                        "expense_id": 2640,
                        "account_id": 35501,
                        "amount": 434,
                        "client_id": 4240788,
                        "master_id": 0,
                        "supplier_id": 0,
                        "comment": "Transaction comment",
                        "item_id": 0,
                        "target_type_id": 0,
                        "record_id": 0,
                        "expense": {
                            "id": 2640,
                            "title": "Оказание корпоративных услуг"
                        },
                        "account": {
                            "id": 35501,
                            "title": "Касса",
                            "type_id": 0,
                            "type": 0,
                            "comment": "",
                            "company_id": 4564
                        },
                        "client": {
                            "id": "4240788",
                            "name": "Client",
                            "phone": "71000000001"
                        },
                        "master": [],
                        "supplier": []
                    }
                ],
                "meta": []
            }

### Получить товарные транзакции документа [GET /storage_operations/documents/goods_transactions/{document_id}]

+ Parameters

    + document_id (required, number) - ID документа

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": [
                    {
                        "id": 3728232,
                        "document_id": 22256643,
                        "type_id": 1,
                        "company_id": 4564,
                        "good_id": 587018,
                        "amount": -10,
                        "cost_per_unit": 100,
                        "discount": 0,
                        "cost": 1000,
                        "unit_id": 88272,
                        "operation_unit_type": 1,
                        "storage_id": 36539,
                        "supplier_id": 0,
                        "client_id": 0,
                        "master_id": 49754,
                        "create_date": "2017-07-06 19:42:00",
                        "comment": "",
                        "service_id": 0,
                        "user_id": 3,
                        "deleted": false,
                        "pkg_amount": 0
                    },
                    {
                        "id": 3728233,
                        "document_id": 22256643,
                        "type_id": 1,
                        "company_id": 4564,
                        "good_id": 232674,
                        "amount": -10,
                        "cost_per_unit": 127.5,
                        "discount": 0,
                        "cost": 1275,
                        "unit_id": 1,
                        "operation_unit_type": 2,
                        "storage_id": 36539,
                        "supplier_id": 0,
                        "client_id": 0,
                        "master_id": 49754,
                        "create_date": "2017-07-06 19:42:00",
                        "comment": "",
                        "service_id": 0,
                        "user_id": 3,
                        "deleted": false,
                        "pkg_amount": 0
                    }
                ],
                "meta": {
                    "count": 2
                }
            }


# Group Страны

Объект страны имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  |  ID страны  |
|  title  | string  | Краткое название страны  |
|  full_title  | string  | Полное название страны  |
|  phone_code  | number  | Телефонный код  |
|  phone_template  | string  | Шаблон номера телефона страны  |
|  phone_example  | string  | Пример номера телефона страны  |
|  currency  | string | Валюта |
|  exchange  | float  | Ставка обмена валют по отношению к рублю  |


## Получение стран [/countries]
### Получить список стран [GET]

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

+ Response 200 (application/json)

    + Body

            [
              {
                "id": "1",
                "title": "Россия",
                "full_title": "Российская Федерация",
                "phone_code": "7",
                "phone_template": "+7 xxx xxx-xx-xx",
                "phone_example": "+7 981 123 45-67",
                "currency": "₽",
                "exchange": "1"
              },
              {
                "id": "2",
                "title": "Латвия",
                "full_title": "Латвийская Республика",
                "phone_code": "371",
                "phone_template": "+371 xx xxx xxx",
                "phone_example": "+371 21 654 987",
                "currency": "€",
                "exchange": "50"
              },
            ]

# Group Изображения

## Обработка изображений [/images/{entity}]

+ Parameters

    + entity: "master" (optional, string) - название сущности (master/service)

### Загрузка изображения [POST]

Объект ответа имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  image_binded  | boolean  |  Статус привязки изображений к сущности  |
|  image_group  | object  | Объект группа изображений |

+ Parameters

    + entity: "master" (required, string) - название сущности (master/service)


+ Request (form-data)

    + salon_id (optional, number) - Id салона для привязки изображения (для entity=service)
    + service_id (optional, number) - Id услуги для привязки изображения (для entity=service)
    + master_id (optional, number) - Id сотрудника для привязки изображения (для entity=master)
    + image (required, file) - передаваемое изображение (image/jpeg, image/png)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Attributes (ImageGroup)
        + image_group (required, ImageGroup)

    + Body

            {
              "image_binded": false,
              "image_group ": {
                "id": 72256,
                "entity": "",
                "entity_id": 0,
                "images": {
                  "basic": {
                    "id": 186826,
                    "path": "http://yclients.com/uploads/setting_service_image/c/cf/cf01a5585348731_20170328195919.jpeg",
                    "width": 373,
                    "height": 280,
                    "type": "jpeg",
                    "image_group_id": 72256,
                    "version": "basic"
                  }
                }
              }
            }

### Удаление изображений [DELETE]

Объект ответа имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  success  | boolean  |  Результат удаления  |

+ Request (form-data)

    + image_group_id (required, number) - Id группы изображения для удаления

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
              "success": true
            }


# Group Сети салонов

## Список сетей [/groups]

### Получение доступных пользователю сетей [GET]

Объект сети салонов имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  |  Id сети салонов  |
|  title  | string  | Название сети салонов |
|  companies  | array  | Список салонов сети |
|  access  | object  | Объект с правами доступа для управления сетью |

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Attributes (UsersGroupsAccess)

        + access (required, UsersGroupsAccess) - Объект с правами доступа для управления сетью

    + Body

            {
              "success": true,
              "data": [
                {
                  "id": 509,
                  "title": "Сеть салонов в Санкт-Петербурге",
                  "companies": [
                    {
                      "id": 38726,
                      "title": "Салон в Санкт-Петербурге (Лиговский пр. 73)"
                    },
                    {
                      "id": 39287,
                      "title": "Салон в Санкт-Петербурге (Невский пр. 38)"
                    }
                  ],
                  "access": {
                    "settings_access": "1",
                    "clients_access": "1",
                    "users_access": "1",
                    "loyalty_access": "1",
                    "loyalty_cards_manual_transactions_access": "1",
                    "network_services_access": "1"
                  }
                },
                {
                  "id": 508,
                  "title": "Сеть салонов в Москве",
                  "companies": [
                    {
                      "id": 38545,
                      "title": "Салон в Москве (Тверская 33)"
                    },
                    {
                      "id": 38704,
                      "title": "Салон в Москве (Гагарина пл. 27)"
                    }
                  ],
                  "access": {
                    "settings_access": "1",
                    "clients_access": "1",
                    "users_access": "1",
                    "loyalty_access": "1",
                    "loyalty_cards_manual_transactions_access": "1",
                    "network_services_access": "1"
                  }
                }
            }


# Group Z-Отчет

Объект Z-Отчета имеет следующие поля:

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  stats  |  stats  |  Общая статистика  |
|  paids  |  paids  |  Оплаты  |
|  z_data  |  z_data  |  Данные отчета  |
|  currency  |  string  |  Валюта  |

Объект stats имеет следующие поля:

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  clients  |  integer  |  Количество клиентов  |
|  clients_average  |  float  |  Среддняя оплата по клиентам  |
|  records  |  integer  | Количество записей  |
|  records_average  |  float  |  Среддняя оплата по записям  |
|  visit_records  |  integer  |  Количество записей с клиентами  |
|  visit_records_average  |  float  |  Среддняя оплата по записям с клиентами  |
|  non_visit_records  |  integer  |  Количество записей без клиентов  |
|  non_visit_records_average  |  float  |  Среддняя оплата по записям без клиентов  |
|  targets  |  integer  |  Количество услуг  |
|  targets_paid  |  float  |  Оплата по услугам  |
|  goods  |  integer  |  Количество товаров  |
|  goods_paid  |  float  |  Оплата по товарам  |
|  certificates  |  integer  |  Количество сертификатов  |
|  certificates_paid  |  float  |  Оплата по сертификатам  |
|  abonement  |  integer  |  Количество абонементов  |
|  abonement_paid  |  float  |  Оплата по абонементам  |

Объект paids имеет следующие поля:

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  accounts  |  array of paid  | Оплаты в кассы  |
|  discount  |  array of paid  | Оплата по скидке и лояльности  |
|  total  |  total_paid  |  Итог  |

Объект paid имеет следующие поля:

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  title  |  string  |  Название кассы или тип скидки/лояльности  |
|  amount  |  float  |  Сумма оплаты  |

Объект total_paid имеет следующие поля:

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  accounts  |  float  |  Общая сумма оплат в кассы  |
|  discount  |  float  |  Общая сумма скидок/лояльности  |

Объект z_data состоит из пар ключ-значение, где:
+ ключ - дата;
+ значение - объект client;

Объект client имеет следующие поля:

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  client_id  |  integer  |  ID клиента (0, если клиент не из базы)  |
|  client_name  |  string  |  Имя клиента  |
|  client_phone  |  string  |  Номер телефона клиента  |
|  client_email  |  string  |  Email клиента  |
|  masters  |  array of master  |  Сотрудники  |

Объект master имеет следующие поля:

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  master_id  |  integer  |  ID сотрудника  |
|  master_name  |  string  |  Имя сотрудника  |
|  service  |  array of operation  |  Услуги  |
|  good  |  array of operation  |  Товары  |
|  others  |  operation  |  Другие операции  |

Объект operation имеет следующие поля:

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  item_title  |  string  |  Название услуги/товара  |
|  first_cost  |  integer  |  Цена  |
|  discount  |  integer  |  Скидка  |
|  result_cost  |  integer  |  К оплате  |
|  transactions  |  array of transaction  |  Оплаты  |

Объект transaction имеет следующие поля:

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  accounts_amount  |  integer  |  Оплачено в кассу  |
|  loyalty_amount  |  integer  |  Оплачено по программе лояльности  |
|  payment_type  |  string  |  Тип оплаты  |

## Получение данных Z-Отчета [/reports/z_report/{company_id}{?start_date,master_id}]
### Получить данные Z-Отчета [GET]
+ start_date: Дата отчета
+ master_id: ID сотрудника

+ Parameters

    + company_id (required, integer) - ID компании
    + start_date:'' (optional, string) - дата начала периода
    + master_id:0 (optional, integer) - ID сотрудника


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
              "success": true,
              "data": {
                "stats": {
                  "clients": 7,
                  "clients_average": 123.45,
                  "records": 14,
                  "records_average": 4231.51,
                  "visit_records": 13,
                  "visit_records_average": 100500.01,
                  "non_visit_records": 1,
                  "non_visit_records_average": 200,
                  "targets": 14,
                  "targets_paid": 10255,
                  "goods": 4,
                  "goods_paid": 12452.18,
                  "certificates": 1,
                  "certificates_paid": 9876,
                  "abonement": 0,
                  "abonement_paid": 0
                },
                "paids": {
                  "accounts": [
                    {
                      "title": "Карты",
                      "amount": 6987
                    },
                    {
                      "title": "Наличные",
                      "amount": 54321.13
                    },
                    {
                      "title": "Касса",
                      "amount": 12531
                    }
                  ],
                  "discount": [
                    {
                      "title": "Предварительная скидка",
                      "amount": 1816.875
                    },
                    {
                      "title": "Списано бонусов",
                      "amount": 800
                    },
                    {
                      "title": "Скидка по акциям",
                      "amount": 123
                    }
                  ],
                  "total": {
                    "accounts": 2657.13,
                    "discount": 1241.875
                  }
                },
                "z_data": {
                  "2016-12-07 09:00:00": [
                    {
                      "client_id": "11223344",
                      "client_name": "John Smith",
                      "client_phone": "+7 999 888-77-66",
                      "client_email": "",
                      "masters": [
                        {
                          "master_id": "321123",
                          "master_name": "Robert Brown",
                          "service": [
                            {
                              "item_title": "Мелирование от 9 прядей",
                              "first_cost": 3500,
                              "discount": 0,
                              "result_cost": 3500,
                              "transactions": [
                                {
                                  "accounts_amount": 0,
                                  "loyalty_amount": 700,
                                  "payment_type": "Карта: Золотая карта"
                                },
                                {
                                  "accounts_amount": 0,
                                  "loyalty_amount": 100,
                                  "payment_type": "Карта: Золотая карта"
                                },
                                {
                                  "accounts_amount": 0,
                                  "loyalty_amount": 1,
                                  "payment_type": "Карта: Карта бонусная"
                                }
                              ]
                            }
                          ],
                          "good": [
                            {
                              "item_title": "Spray For Hair",
                              "first_cost": 15,
                              "discount": 2.25,
                              "result_cost": 12.75,
                              "transactions": [
                                {
                                  "accounts_amount": 12.75,
                                  "loyalty_amount": 0,
                                  "payment_type": "Наличные"
                                }
                              ]
                            }
                          ],
                          "others": {
                            "item_title": "Другие операции",
                            "first_cost": 347,
                            "discount": 0,
                            "result_cost": 347,
                            "transactions": [
                              {
                                "accounts_amount": 23,
                                "loyalty_amount": 0,
                                "payment_type": "Наличные"
                              },
                              {
                                "accounts_amount": 324,
                                "loyalty_amount": 0,
                                "payment_type": "Наличные"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                },
                "currency": "₽"
              },
              "meta": []
            }

# Group Дополнительные поля

## Описание функционала и объекты API

### Описание

Дополнительные поля позволяют добавлять к отдельным объектам системы свойства заданного типа, и впоследствии,
привязывать к этим полям значения соответствующие данному типу. На данный момент функционал реализован для Записей.

Для начала работы с функционалом нужно завести сами дополнительные поля записи.

Объекты Дополнительных полей:

Тип дополнительного поля (CustomFieldType)

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  code  |  string  |  Код типа |
|  title  |  string  |  Название типа  |

На данный момент api поддерживает следующие типы (поле code):
* text - строка длиной до 255 символов
* number - число
* list - список строк

Дополнительное поле записи (RecordCustomField)

|  Поле  |  Тип  |  Описание  |
| ------------- | ------------- | ------------- |
|  code  |  string  |  Код поля по которому устанавливаются значения для полей записи |
|  entity_type  |  string  |  Привязка к отдельным сущностям API (пока не реализовано, на будущее) |
|  id  |  integer  |  Уникальный идентификатор поля  |
|  type  |  CustomFieldType  |  Тип поля |
|  show_in_ui  |  boolean  |  Показывать ли поля в интерфейсе (пока не реализовано, на будущее) |
|  title  |  string  | Название поля |
|  user_can_edit  |  boolean  | Можно ли редактировать в интерфейсе (пока не реализовано, на будущее) |

##Работа с доп полями [/custom_fields/record/{company_id}]
### Получение коллекции полей для записей [GET]

+ Parameters
    + company_id (required, integer) - ID компании


+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": [
                    {
                        "id": 1,
                        "salon_id": 1,
                        "custom_field": {
                            "id": 1,
                            "code": "my_text_field",
                            "entity_type": null,
                            "show_in_ui": true,
                            "title": "поле для теста",
                            "user_can_edit": true,
                            "type": {
                              "code": "text",
                              "title": "Текст"
                            },
                            "values": null
                        }
                    }
                ],
                "meta": []
            }

### Добавление поля для записей [POST]

+ Parameters
    + company_id (required, integer) - ID компании

+ Attributes
    + type (required, string) - тип поля
    + code (required, string) - уникальный идентификатор поля
    + title (required, string) - название поля
    + user_can_edit (required, boolean) - может ли пользователь редактировать поле
    + show_in_ui (required, boolean) - показывать ли поля в интерфейсе

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                "type": "text",
                "code": "my_text_field",
                "title": "поле для теста",
                "user_can_edit": true,
                "show_in_ui": true
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data":
                 {
                    "id": 1,
                    "salon_id": 1,
                    "custom_field": {
                        "id": 1,
                        "code": "my_text_field",
                        "entity_type": null,
                        "show_in_ui": true,
                        "title": "поле для теста",
                        "user_can_edit": true,
                        "type": {
                          "code": "text",
                          "title": "Текст"
                        },
                        "values": null
                    }
                },
                "meta": []
            }

##Работа с отдельным полем [/custom_fields/record/{company_id}/{field_id}]
### Обновление поля для записей [PUT]

+ Parameters
    + company_id (required, integer) - ID компании
    + field_id (required, integer) - ID поля

+ Attributes
    + type (string) - тип поля
    + code (string) - уникальный идентификатор поля
    + title (string) - название поля
    + user_can_edit (boolean) - может ли пользователь редактировать поле
    + show_in_ui (boolean) - игнорировать ошибки (занятость мастера/ресурсов и тд)

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

    + Body

            {
                "type": "text",
                "code": "my_text_field",
                "title": "поле для теста",
                "user_can_edit": true,
                "show_in_ui": true
            }

+ Response 204

### Удаление поля для записей [DELETE]

+ Parameters
    + company_id (required, integer) - ID компании
    + field_id (required, integer) - ID поля

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 204

# Group Отправка СМС через операторов

## Описание функционала и объекты API
Для отправки SMS, оператору необходимо предоставить адрес (url_operator), на который будут уходить запросы описанные ниже.
Авторизация запросов к API производится в соответствии с [RFC 6749 "Resource Owner Password Credentials Grant"](http://tools.ietf.org/html/rfc6749#section-4.3).
При запросах к API в HTTP заголовок Authorization должен быть включен ключ доступа в следущем формате:
Ключ авторизации (partner_token) должен быть указан в настройках модуля уведомлений компании.

```
Authorization: Bearer <partner token>
```

## Отправка СМС [/]

В случае ошибки возвращается ее HTTP-код. В некоторых случаях также возвращается текстовое описание ошибки.
Все методы API могут возвращать следующие коды ошибок:

|  Error code  |  Http status code  |  Название  |  Описание  |
| ------------- | ------------- | ------------- | ------------- |
|  5  |  400  |  ENTITY_VALIDATION_ERROR  |  Тело запроса не прошло валидацию  |
|  10  |  400  |  FIELD_VALIDATION_ERROR  |  Параметр не прошел валидацию  |
|  15  |  403  |  ACCESS_FORBIDDEN  |  Действие недоступно, у приложения нет требуемых разрешений.  |
|  20  |  401  |  INVALID_PARTNER_TOKEN  |  partner_token отсутствует или невалиден  |
|  30  |  404  |  RESOURCE_NOT_FOUND  |  Ресурс по запрошенному пути не существует  |

### Отправка СМС [POST]

+ Attributes
    + destination_params (required, object) - обьект, содержащий параметры ИД отправки и номер телефона
    + from (required, string) - имя отправителя
    + text (required, string) - текст отправления
    + type (required, string) - тип отправления (sms, viber)
    + dispatch_type (required, string) - тип рассылки (service - сервисная, adds - рекламная)
    + delivery_callback_url (required, string) - url, на который приходят статусы сообщений

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

    + Body

            {
                "destination_params": [
                    {
                        "id": "232674",
                        "phone": "71000000002"
                    }
                ],
                "from": "yclients",
                "text": "поле для текста",
                "type": "sms",
                "dispatch_type": "service",
                "delivery_callback_url": "http://api.yclients.com/api/v1/delivery/status"
            }

+ Response 200 (application/json)

    + Body

            [
                {
                    "id": "232674",
                    "ext_id": "609aff0fca92466d6a1747dd83f05943a8c9600d"
                }
            ]

+ Response 400 (application/json)

    + Body

            {
                "error_code": 10,
                "errors": [
                    {
                        "field_name": "some string",
                        "field_value": "some string",
                        "error_message": "explicit error message"
                    },
                    {
                        "field_name": "some string",
                        "field_value": "some string",
                        "error_message": "explicit error message"
                    }

                ]
            }

+ Response 400 (application/json)

    + Body

            {
                "error_code": 5,
                "error_message": "explicit error message"
            }

+ Response 401 (application/json)

    + Body

            {
                "error_code": 20,
                "error_message": "explicit error message"
            }

+ Response 404 (application/json)

    + Body

            {
                "error_code": 30,
                "error_message": "explicit error message"
            }


## Получение статусов сообщений [/delivery/status]

|  Номер  |  Название  |
| ------------- | ------------- |
|  1  |  Доставлено  |
|  2  |  Не доставлено  |
|  4  |  Отправлено на телефон  |
|  8  |  Передано оператору  |
|  16  |  Отклонено оператором  |

В случае ошибки возвращается ее HTTP-код. В некоторых случаях также возвращается текстовое описание ошибки.
Все методы API могут возвращать следующие коды ошибок:

|  Error code  |  Http status code  |  Название  |  Описание  |
| ------------- | ------------- | ------------- | ------------- |
|  5  |  400  |  ENTITY_VALIDATION_ERROR  |  Тело запроса не прошло валидацию  |
|  10  |  400  |  FIELD_VALIDATION_ERROR  |  Параметр не прошел валидацию  |
|  15  |  403  |  ACCESS_FORBIDDEN  |  Действие недоступно, у приложения нет требуемых разрешений.  |
|  20  |  401  |  INVALID_PARTNER_TOKEN  |  partner_token отсутствует или невалиден  |
|  30  |  404  |  RESOURCE_NOT_FOUND  |  Ресурс по запрошенному пути не существует  |

## Получение статусов сообщений [POST]
При отправке смс в запросе передается атрибут delivery_callback_url - это url, на который должны приходить статусы сообщений.

Используйте его для отправки статусов сообщений.  Url, на который должны приходить статусы сообщений - https://www.yclients.com/smsprovider/status/callback/{partner_token}

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token

    + Body

            [
                {
                    "id": "232674",
                    "status": 1
                }
            ]

+ Response 200 (application/json)

    + Body

            {
                 "success": true
            }

+ Response 400 (application/json)

    + Body

            {
                "error_code": 10,
                "errors": [
                    {
                        "field_name": "some string",
                        "field_value": "some string",
                        "error_message": "explicit error message"
                    },
                    {
                        "field_name": "some string",
                        "field_value": "some string",
                        "error_message": "explicit error message"
                    }

                ]
            }

+ Response 400 (application/json)

    + Body

            {
                "error_code": 5,
                "error_message": "explicit error message"
            }

+ Response 401 (application/json)

    + Body

            {
                "error_code": 20,
                "error_message": "explicit error message"
            }

+ Response 404 (application/json)

    + Body

            {
                "error_code": 30,
                "error_message": "explicit error message"
            }

# Group Лицензии

При наличии лицензии у компании
объект лицензии имеет следующие поля:

| Поле  | Тип | Описание |
| ------------- | ------------- | ------------- |
|  id  | number  |  ID лицензии  |
|  salon_id  | number  | ID компании  |
|  staff_limit  | number  | Количество сотрудников (0 - не ограничено)  |
|  deactivation_date  | string  | Дата деактивации  |
|  start_date  | string  | Дата начала лицензии  |
|  name  | string  | Название тарифа лицензии  |
|  active  | boolean | Активность |
|  options  | array | Массив подключенных опций |

## Информация о лицензии [/license/{company_id}]

+ Параметры
    + company_id (required, number, `1`) - ID компании

### Получение информация о лицензии компании [GET]

+ Request (application/json)

    + Headers

            Authorization: Bearer partner_token, User user_token

+ Response 200 (application/json)


    + Attributes (LicenseOption)
        + id (required, number)
        + salon_id (required, number)
        + staff_limit (required, number)
        + deactivation_date (required, string)
        + start_date (required, string)
        + name (required, string)
        + active (required, number)
        + options (required, array[LicenseOption])

    + Body

          {
                "id": 1,
                "salon_id": 4523464,
                "staff_limit": 5,
                "deactivation_date": "08.11.2019",
                "start_date": "07.05.2018",
                "name": "Старт",
                "active": 1,
                "options": [
                    {
                        "id": 3,
                        "title": "Онлайн-оплата"
                    }
                ]
          }